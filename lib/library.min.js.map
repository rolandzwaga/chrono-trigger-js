{"version":3,"sources":["webpack://library/webpack/universalModuleDefinition","webpack://library/webpack/bootstrap","webpack://library/./src/timeline-event-names.js","webpack://library/./src/operation/helper/internalResolve.js","webpack://library/external {\"amd\":\"jquery\",\"global\":\"jQuery\",\"commonjs\":\"jquery\",\"commonjs2\":\"jquery\"}","webpack://library/./src/operation/helper/mergeOperationData.js","webpack://library/./src/operation/helper/deepcopy.js","webpack://library/./src/operation/helper/getElementData.js","webpack://library/./src/index.js","webpack://library/./src/action/index.js","webpack://library/./src/action/action.js","webpack://library/./src/action/endableaction.js","webpack://library/./src/configuration/configuration-resolver.js","webpack://library/./src/operation/helper/getNestedValue.js","webpack://library/./src/language-manager.js","webpack://library/./src/eventbus/eventbus.js","webpack://library/./src/operation/helper/extractOperationDataArgumentValues.js","webpack://library/./src/operation/helper/resolvePropertyValues.js","webpack://library/./src/action/timelineaction.js","webpack://library/./src/operation/helper/getNestedPropertyValue.js","webpack://library/./src/chrono-trigger-engine.js","webpack://library/./src/engine-factory.js","webpack://library/./src/eventbus/index.js","webpack://library/./src/eventbus/actionregistry-eventbus-listener.js","webpack://library/./src/eventbus/request-video-uri-interceptor.js","webpack://library/./node_modules/mousetrap/mousetrap.js","webpack://library/./src/importer/webpack-resource-importer.js","webpack://library/./src/controllers/index.js","webpack://library/./src/controllers/EventListenerController.js","webpack://library/./src/controllers/LabelController.js","webpack://library/./src/controllers/LottieController.js","webpack://library/external {\"amd\":\"lottie-web\",\"global\":\"lottie\",\"commonjs\":\"lottie-web\",\"commonjs2\":\"lottie-web\"}","webpack://library/./src/controllers/NavigationController.js","webpack://library/./src/controllers/ProgressbarController.js","webpack://library/./src/controllers/RoutingController.js","webpack://library/./src/controllers/SubtitlesController.js","webpack://library/./src/operation/index.js","webpack://library/./src/operation/addClass.js","webpack://library/./src/operation/addControllerToElement.js","webpack://library/./src/operation/helper/attachControllerToElement.js","webpack://library/./src/operation/addOptionList.js","webpack://library/./src/operation/animate.js","webpack://library/./src/operation/animateWithClass.js","webpack://library/./src/operation/broadcastEvent.js","webpack://library/./src/operation/helper/resolveEventArguments.js","webpack://library/./src/operation/helper/removeEventDataFromOperationData.js","webpack://library/./src/operation/clearElement.js","webpack://library/./src/operation/clearOperationData.js","webpack://library/./src/operation/customFunction.js","webpack://library/./src/operation/endAction.js","webpack://library/./src/operation/extendController.js","webpack://library/./src/operation/getControllerFromElement.js","webpack://library/./src/operation/getControllerInstance.js","webpack://library/./src/operation/getElementDimensions.js","webpack://library/./src/operation/helper/modifyDimensions.js","webpack://library/./src/operation/loadJSON.js","webpack://library/./src/operation/removeClass.js","webpack://library/./src/operation/removeControllerFromElement.js","webpack://library/./src/operation/removeElement.js","webpack://library/./src/operation/removePropertiesFromOperationData.js","webpack://library/./src/operation/reparentElement.js","webpack://library/./src/operation/requestAction.js","webpack://library/./src/operation/resizeAction.js","webpack://library/./src/operation/selectElement.js","webpack://library/./src/operation/setElementAttributes.js","webpack://library/./src/operation/setElementContent.js","webpack://library/./src/operation/setOperationData.js","webpack://library/./src/operation/setStyle.js","webpack://library/./src/operation/startAction.js","webpack://library/./src/operation/toggleClass.js","webpack://library/./src/operation/toggleElement.js","webpack://library/./src/operation/wait.js","webpack://library/./src/timelineproviders/index.js","webpack://library/./src/timelineproviders/jwplayer-timeline-provider.js","webpack://library/./src/timelineproviders/request-animation-frame-timeline-provider.js"],"names":["root","factory","exports","module","require","define","amd","undefined","window","__WEBPACK_EXTERNAL_MODULE__2__","__WEBPACK_EXTERNAL_MODULE__29__","installedModules","__webpack_require__","m","TimelineEventNames","PLAY_TOGGLE_REQUEST","PLAY_REQUEST","STOP_REQUEST","PAUSE_REQUEST","SEEK_REQUEST","RESIZE_REQUEST","CONTAINER_REQUEST","DURATION_REQUEST","PROVIDERID_REQUEST","DURATION","TIME","SEEKED","COMPLETE","PLAY","STOP","PAUSE","SEEK","RESIZE","POSITION_UPDATE","TIME_UPDATE","REQUEST_INSTANCE","REQUEST_ACTION","REQUEST_FUNCTION","REQUEST_TIMELINE_URI","BEFORE_REQUEST_TIMELINE_URI","REQUEST_ENGINE_ROOT","REQUEST_CURRENT_TIMELINE_POSITION","REQUEST_TIMELINE_CLEANUP","EXECUTE_TIMELINEACTION","RESIZE_TIMELINEACTION","REQUEST_LABEL_COLLECTION","REQUEST_LABEL_COLLECTIONS","REQUEST_CURRENT_LANGUAGE","LANGUAGE_CHANGE","_mergeOperationData","resolve","operationData","newOperationData","_extends","original","JSON","parse","stringify","getElementData","name","element","data","getElementControllers","bind","actions","_interopRequireWildcard","_configurationResolver","_interopRequireDefault","_chronoTriggerEngine","_engineFactory","_timelineEventNames","_languageManager","_webpackResourceImporter","_eventbus","_action","_endableaction","_timelineaction","_deepcopy","Action","actionData","eventBus","_classCallCheck","this","startOperations","eventbus","initOperationData","_this","Promise","reject","executeOperation","e","console","error","concat","operations","idx","previousOperationData","_this2","length","operationInfo","mergedOperationData","result","instance","then","resultOperationData","_this3","executeResizeOperation","_this4","resizeInstance","EndableAction","_possibleConstructorReturn","_getPrototypeOf","call","endOperations","_getNestedPropertyValue","ConfigurationResolver","importer","systemName","actionRegistryListener","configuration","actionsLookup","processConfiguration","resolveOperations","initializeTimelineActions","initializeInitActions","initializeActions","initializeEventActions","config","eventActions","forEach","eventAction","registerAction","eventName","eventTopic","action","initActions","map","initAction","timelines","initializeTimelineAction","timelineConfig","timelineActions","timelineAction","TimelineAction","_this5","timelineOperations","timelineInfo","push","apply","_toConsumableArray","_gatherOperations","holder","importSystemEntry","parentConfig","_this6","constructor","Array","i","ii","Object","keys","key","processConfigProperty","value","startsWith","configProperty","substr","templateKey","jsonKey","json","_typeof","properties","sourceObject","Error","currentInstance","suffix","prop","index","parts","split","LanguageManager","language","labels","_labelLookup","_currentLanguage","_eventbusListeners","_createLabelLookup","_addEventbusListeners","on","_handleRequestLabelCollection","_handleRequestLabelCollections","_handleRequestCurrentLanguage","_handleLanguageChange","resultCallback","labelId","labelIds","label","id","Eventbus","clear","eventHandlers","eventListeners","eventInterceptors","eventHandler","_getEventHandlers","off","eventHandlerDecorator","arguments","handlers","indexOf","splice","args","_callHandlers","eventbusListener","interceptor","_getEventInterceptors","intercept","listener","handleEvent","l","_getNestedValue","argumentValue","toLowerCase","propNames","shift","_extractOperationDataArgumentValues","copy","extract","extractOperationDataArgumentValues","propertyName","propertyValue","active","duration","start","end","_get","prototype","propertyChain","_jquery","ChronoTriggerEngine","timelineProvider","_configuration","_timelineProvider","_timeLineActionsLookup","_createLayoutTemplate","_addInitialisationListeners","_this$_configuration","_currentTimelineUri","uri","_createTimelineLookup","_initializeTimelineProvider","containerSelector","container","layoutTemplate","html","warning","timelineProviderSettings","selector","init","_executeActions","_onTimeHandler","Math","floor","_onSeekHandler","_cleanUpTimeline","_cleanUp","remover","destroy","_handleRequestEngineRoot","_handleRequestTimelineUri","_handleRequestTimelinePosition","_handleTimelineComplete","_handleExecuteTimelineAction","_resizeTimelineAction","_addTimelineAction","timeLineAction","timelineStartPositions","_initializeTimelinePosition","_initializeUriLookup","startMethod","isNaN","Infinity","isFinite","timelineEndPositions","endMethod","lookup","position","methodName","engineRootSelector","previousVideoPosition","stop","loop","once","FIRST_FRAME","pause","broadcastForTopic","playerid","getDuration","_executeStartActions","seek","offset","playlistItem","_executeRelevantActions","_getActiveActions","_getActionsForPosition","allActions","filter","sort","a","b","executionType","_getRelevantTimelineActions","currentActions","getPosition","_getTimelineActionsForUri","resize","some","event","pos","_lastPosition","_executeActionsForPosition","_executeSeekActions","play","executions","exec","newActions","promise","_mousetrap","EngineFactory","windowRef","_init","_resizeTimeout","_actionsLookup","_importer","_requestInstanceHandler","_requestActionHandler","_requestFunctionHandler","_resizeHandler","clearTimeout","setTimeout","broadcast","_importSystemEntry","_importSystemEntryWithEventbusDependency","resolver","engine","engineClass","ActionRegistryEventbusListener","registerEventlistener","registerInterceptor","RequestVideoUriInterceptor","process","Mousetrap","preventDefault","providerid","_actionregistryEventbusListener","_requestVideoUriInterceptor","actionRegistry","eventArgs","slice","__WEBPACK_AMD_DEFINE_RESULT__","document","_REVERSE_MAP","_MAP","8","9","13","16","17","18","20","27","32","33","34","35","36","37","38","39","40","45","46","91","93","224","_KEYCODE_MAP","106","107","109","110","111","186","187","188","189","190","191","192","219","220","221","222","_SHIFT_MAP","~","!","@","#","$","%","^","&","*","(",")","_","+",":","\"","<",">","?","|","_SPECIAL_ALIASES","option","command","return","escape","plus","mod","test","navigator","platform","toString","callback","_bindMultiple","unbind","trigger","_directMap","reset","_callbacks","stopCallback","className","_belongsTo","ancestor","parentNode","target","composedPath","initialEventTarget","tagName","isContentEditable","handleKey","_handleKey","addKeycodes","object","hasOwnProperty","documentMousetrap","method","charAt","_addEvent","type","addEventListener","attachEvent","_characterFromEvent","which","String","fromCharCode","character","shiftKey","_isModifier","_pickBestAction","modifiers","_getReverseMap","_getKeyInfo","combination","replace","_keysFromString","targetElement","self","_resetTimer","_sequenceLevels","_ignoreNextKeyup","_ignoreNextKeypress","_nextExpectedAction","_resetSequences","doNotReset","activeSequences","_getMatches","sequenceName","level","modifiers1","modifiers2","matches","seq","metaKey","ctrlKey","join","deleteCombo","combo","deleteSequence","_fireCallback","sequence","srcElement","returnValue","_preventDefault","stopPropagation","cancelBubble","_stopPropagation","_handleKeyEvent","keyCode","altKey","_eventModifiers","_bindSequence","_increaseSequence","nextAction","_callbackAndReset","wrappedCallback","_bindSingle","info","callbacks","maxLevel","processedSequenceCallback","max","ignoreThisKeypress","combinations","controllers","providers","main","_defineProperty","_EventListenerController","_LabelController","_LottieController","_NavigationController","_ProgressbarController","_RoutingController","_SubtitlesController","EventListenerController","actionInstanceInfos","selectedElement","actionOperationData","_this$operationData","actionName","_this$_isStartAction2","_slicedToArray","_isStartAction","isStart","actionInstance","_getElementTagName","_selectEventHandler","_eventHandler","toUpperCase","targetValue","_executeAction","actionInfo","options","opt","selected","LabelController","listeners","currentLanguage","labelData","labelCollection","createTextDataLookup","setLabel","handleLanguageChange","func","code","d","_lottieWeb","LottieController","anim","serializedData","serializedIEData","animationData","freezePosition","endPosition","renderer","autoplay","viewBox","url","parseFilename","iefallback","setting","values","resultHolder","labelCollections","createAnimation","onComplete","playSegments","serialized","isIE","animData","lottie","loadAnimation","timeCompleted","find","attr","infos","NavigationController","playerId","navigation","navLookup","navVidIdLookup","ctrlLookup","activeNavigationPoint","labelControllers","eventhandlers","buildNavigationData","handleNavigateVideoUrl","highlightMenu","handleRequestCurrentNavigation","handleVideoComplete","buildHtml","initHistory","navId","getQueryVariable","videoIndex","videoUrlIndex","variableIdx","href","location","hashIndex","query","substring","navigationData","title","handler","ctrl","detach","onpopstate","state","parentElm","ul","addNavElement","append","visible","li","addLabel","addClickHandler","children","mouseup","menuMouseupHandler","navdata","requestedVideoPosition","pushCurrentState","navElm","removeClass","addClass","log","navData","autoNext","next","attach","nav","previous","nextId","roots","ProgressbarController","textElement","detachers","providerId","positionUpdateHandler","clickHandler","detacher","_ref","perc","css","text","RoutingController","handleBeforeRequestVideoUrl","handlePushHistoryState","handlePopstate","history","pushState","navigationId","isHistoryRequest","item","currentPosition","currentState","replaceState","SubtitlesController","actionLookup","lastFunc","detachTime","onTimeHandler","detachLangChange","languageChangeHandler","internalDetach","detachMethods","f","newLanguage","titleLanguageLookup","controllerData","subtitleData","titles","subtitleTimeLookup","j","jj","subs","lang","setTitle","removeTitle","createActionLookup","_addClass","_addControllerToElement","_addOptionList","_animate","_animateWithClass","_broadcastEvent","_clearElement","_clearOperationData","_customFunction","_endAction","_extendController","_getControllerFromElement","_getControllerInstance","_getElementDimensions","_loadJSON","_removeClass","_removeControllerFromElement","_removeElement","_removePropertiesFromOperationData","_reparentElement","_requestAction","_resizeAction","_selectElement","_setElementAttributes","_setElementContent","_setOperationData","_setStyle","_startAction","_toggleClass","_toggleElement","_wait","_attachControllerToElement","_internalResolve","controllerInstance","_getElementData","controller","valueProperty","labelProperty","defaultIndex","defaultValue","optionData","createOption","optionElements","animationEasing","animationProperties","animationDuration","animate","one","_resolveEventArguments","_removeEventDataFromOperationData","eventArguments","empty","mergedData","controllerExtension","controllerName","warn","_modifyDimensions","dimensions","modifier","width","innerWidth","height","innerHeight","ratioModifier","_modifier$split2","prefix","_getModifierSuffix2","endIdx","isPercent","getModifierSuffix","parseInt","widthModifier","heightModifier","ratios","modifyDimensionsByRatio","jsonCache","cache","fetch","response","body","removeElement","remove","propertyNames","newParentSelector","appendTo","_operationData","findElementBySelector","useExistingAsRoot","attributes","attrName","template","_resolvePropertyValues","toggleClass","toggle","milliseconds","_jwplayerTimelineProvider","_requestAnimationFrameTimelineProvider","JwPlayerTimelineProvider","playerSettings","player","currentLoopHandler","_addEventListeners","timeline","urls","_extractUrls","jwp","jwplayer","p","w","h","setup","file","image","poster","controls","autostart","displaytitle","displaydescription","nextUpDisplay","abouttext","aboutlink","stretching","repeat","playlist","_handlePlayerReady","load","_loopHandler","_seekedHandler","_handlePlayerComplete","getPlaylistIndex","toggleplay","_container","getProvider","paused","getState","getMute","getVolume","setMute","volume","setVolume","RequestAnimationFrameTimelineProvider","requestID","last","current","_updateBound","_update","random","currentPlaylistItem","firstFrame","playing","_resize","requestDurationHandler","requestProviderIdHandler","now","FIRSTFRAME","_reset","requestAnimationFrame","_cancelAnimationFrame","callBack","cancelAnimationFrame","_extractPlaylist","_start","c","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","t","mode","__esModule","ns","create","n","property","s","moduleId","modules"],"mappings":"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","file":"library.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"jquery\"), require(\"lottie-web\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"library\", [\"jquery\", \"lottie-web\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"library\"] = factory(require(\"jquery\"), require(\"lottie-web\"));\n\telse\n\t\troot[\"library\"] = factory(root[undefined], root[undefined]);\n})(window, function(__WEBPACK_EXTERNAL_MODULE__2__, __WEBPACK_EXTERNAL_MODULE__29__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n","class TimelineEventNames {\r\n    // timeline requests\r\n    static PLAY_TOGGLE_REQUEST = 'timeline-play-toggle-request';\r\n    static PLAY_REQUEST = 'timeline-play-request';\r\n    static STOP_REQUEST = 'timeline-stop-request';\r\n    static PAUSE_REQUEST = 'timeline-pause-request';\r\n    static SEEK_REQUEST = 'timeline-seek-request';\r\n    static RESIZE_REQUEST = 'timeline-resize-request';\r\n    static CONTAINER_REQUEST = 'timeline-container-request';\r\n    static DURATION_REQUEST = 'timeline-duration-request';\r\n    static PROVIDERID_REQUEST = 'timeline-providerid-request';\r\n\r\n    // timeline announcements\r\n    static DURATION = 'timeline-duration';\r\n    static TIME = 'timeline-time';\r\n    static SEEKED = 'timeline-seeked';\r\n    static COMPLETE = 'timeline-complete';\r\n    static PLAY = 'timeline-play';\r\n    static STOP = 'timeline-stop';\r\n    static PAUSE = 'timeline-pause';\r\n    static SEEK = 'timeline-seek';\r\n    static RESIZE = 'timeline-resize';\r\n    static POSITION_UPDATE = 'timeline-position-update';\r\n    static TIME_UPDATE = 'timeline-time-update';\r\n\r\n    // factory and engine events\r\n    static REQUEST_INSTANCE = 'request-instance';\r\n    static REQUEST_ACTION = 'request-action';\r\n    static REQUEST_FUNCTION = 'request-function';\r\n    static REQUEST_TIMELINE_URI = 'request-timeline-uri';\r\n    static BEFORE_REQUEST_TIMELINE_URI = 'before-request-timeline-uri';\r\n    static REQUEST_ENGINE_ROOT = 'request-engine-root';\r\n    static REQUEST_CURRENT_TIMELINE_POSITION = 'request-current-timeline-position';\r\n    static REQUEST_TIMELINE_CLEANUP = 'request-timeline-cleanup';\r\n    static EXECUTE_TIMELINEACTION = 'execute-timelineaction';\r\n    static RESIZE_TIMELINEACTION = 'resize-timelineaction';\r\n\r\n    //language manager events\r\n    static REQUEST_LABEL_COLLECTION = 'request-label-collection';\r\n    static REQUEST_LABEL_COLLECTIONS = 'request-label-collections';\r\n    static REQUEST_CURRENT_LANGUAGE = 'request-current-language';\r\n    static LANGUAGE_CHANGE = 'language-change';\r\n}\r\n\r\nexport default TimelineEventNames;\r\n","import mergeOperationData from './mergeOperationData';\r\n\r\nfunction internalResolve(resolve, operationData, newOperationData) {\r\n    if (newOperationData) {\r\n        resolve(mergeOperationData(operationData, newOperationData));\r\n    } else {\r\n        resolve(operationData);\r\n    }\r\n}\r\n\r\nexport default internalResolve;\r\n","module.exports = __WEBPACK_EXTERNAL_MODULE__2__;","function mergeOperationData(operationData, newOperationData) {\r\n    return Object.assign(operationData, newOperationData);\r\n}\r\n\r\nexport default mergeOperationData;\r\n","function deepcopy(original) {\r\n    return JSON.parse(JSON.stringify(original));\r\n}\r\n\r\nexport default deepcopy;\r\n","function getElementData(name, element) {\r\n    return element.data(name);\r\n}\r\n\r\nconst getElementControllers = getElementData.bind(null, \"chronoEngineControllers\");\r\n\r\nexport {\r\n    getElementData,\r\n    getElementControllers\r\n}","import * as actions from './action';\r\nexport { default as ConfigurationResolver } from './configuration/configuration-resolver';\r\nexport { default as ChronoTriggerEngine } from './chrono-trigger-engine';\r\nexport { default as EngineFactory } from './engine-factory';\r\nexport { default as TimelineEventNames } from './timeline-event-names';\r\nexport { default as LanguageManager } from './language-manager';\r\nexport { default as WebpackResourceImporter } from './importer/webpack-resource-importer';\r\nexport { default as Eventbus } from './eventbus/eventbus';\r\nexport default actions;","export { default as Action } from './action';\r\nexport { default as EndableAction } from './endableaction';\r\nexport { default as TimelineAction } from './timelineaction';","import deepcopy from '../operation/helper/deepcopy';\r\n\r\nclass Action {\r\n\r\n\tconstructor(actionData, eventBus) {\r\n\t\tthis.name = actionData.name;\r\n\t\tthis.startOperations = actionData.startOperations;\r\n\t\tthis.eventbus = eventBus; \r\n\t}\r\n\r\n\tstart(initOperationData) {\r\n\t\tconst result = new Promise((resolve, reject) => {\r\n\t\t\tthis.executeOperation(this.startOperations, 0, resolve, reject, initOperationData);\r\n\t\t}).catch((e) => {\r\n\t\t\tconsole.error(`Error in action start '${this.name}'`);\r\n\t\t\tthrow e;\r\n\t\t});\r\n\t\treturn result;\r\n\t}\r\n\r\n\texecuteOperation(operations, idx, resolve, reject, previousOperationData) {\r\n\t\tpreviousOperationData = previousOperationData || {};\r\n\r\n\t\tif (idx < operations.length) {\r\n\t\t\tconst operationInfo = operations[idx];\r\n\t\t\tconst copy = (operationInfo.operationData) ? deepcopy(operationInfo.operationData) : {};\r\n\t\t\tconst mergedOperationData = Object.assign(previousOperationData, copy);\r\n\t\t\t\r\n\t\t\tconst result = operationInfo.instance(mergedOperationData, this.eventbus);\r\n\t\t\t\r\n            if (result.then) {\r\n\t\t\t\tresult.then((resultOperationData) => {\r\n\t\t\t\t\tthis.executeOperation(operations, ++idx, resolve, reject, resultOperationData);\r\n\t\t\t\t}).catch((error) => {\r\n\t\t\t\t\treject(error);\r\n\t\t\t\t});\r\n            } else {\r\n                this.executeOperation(operations, ++idx, resolve, reject, result);\r\n            }\r\n\t\t} else {\r\n\t\t\tresolve(previousOperationData);\r\n\t\t}\r\n\t}\r\n\r\n\tresize(operationData) {\r\n\t\tconst idx = 0;\r\n\t\tconst result = new Promise((resolve, reject) => {\r\n\t\t\tthis.executeResizeOperation(this.startOperations, idx, resolve, reject, operationData);\r\n\t\t});\r\n\t\treturn result;\r\n\t}\r\n\r\n\texecuteResizeOperation(operations, idx, resolve, reject, previousOperationData) {\r\n\t\tpreviousOperationData = previousOperationData || {};\r\n\t\t\r\n\t\tif (idx < operations.length) {\r\n\t\t\tconst operationInfo = operations[idx];\r\n\t\t\tif ((operationInfo.resizeInstance)) {\r\n\t\t\t\tconst copy = ((operationInfo.operationData)) ? deepcopy(operationInfo.operationData) : {};\r\n\t\t\t\tconst mergedOperationData = Object.assign(previousOperationData, copy);\r\n\r\n\t\t\t\tconst result = operationInfo.resizeInstance(mergedOperationData);\r\n\t\t\t\tif (result.then){\r\n\t\t\t\t\tresult.then((resultOperationData) => {\r\n\t\t\t\t\t\tthis.executeResizeOperation(operations, ++idx, resolve, reject, resultOperationData);\r\n\t\t\t\t\t}).catch((error) => {\r\n\t\t\t\t\t\treject(error);\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.executeResizeOperation(operations, ++idx, resolve, reject, result);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthis.executeResizeOperation(operations, ++idx, resolve, reject, previousOperationData);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tresolve(previousOperationData);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default Action;\r\n","import Action from './action';\r\n\r\nclass EndableAction extends Action {\r\n\r\n\tconstructor(actionData, eventBus) {\r\n\t\tsuper(actionData, eventBus);\r\n\t\tthis.endOperations = actionData.endOperations;\r\n\t}\r\n\r\n\tend(initOperationData) {\r\n\t\tif ((this.endOperations) && (this.endOperations.length)) {\r\n\t\t\tconst idx = 0;\r\n\t\t\tconst result = new Promise((resolve, reject) => {\r\n\t\t\t\tthis.executeOperation(this.endOperations, idx, resolve, reject, initOperationData);\r\n\t\t\t}).catch((e) => {\r\n\t\t\t\tconsole.error(`Error in action end'${this.name}'`);\r\n\t\t\t\tthrow e;\r\n\t\t\t});\r\n\t\t\treturn result;\r\n\t\t}\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\tresolve(initOperationData);\r\n\t\t});\r\n\t}\r\n\r\n}\r\n\r\nexport default EndableAction;\r\n","import { TimelineAction, EndableAction, Action } from '../action';\r\nimport getNestedPropertyValue from '../operation/helper/getNestedPropertyValue';\r\n\r\nclass ConfigurationResolver {\r\n\r\n    constructor(importer, eventbus) {\r\n        this.importer = importer;\r\n        this.eventbus = eventbus;\r\n    }\r\n\r\n    importSystemEntry(systemName) {\r\n        return this.importer.import(systemName)[systemName];\r\n    }\r\n\r\n    process(actionRegistryListener, configuration) {\r\n        const actionsLookup = {};\r\n        this.processConfiguration(configuration, configuration);\r\n        this.resolveOperations(configuration);\r\n        this.initializeTimelineActions(configuration);\r\n        this.initializeInitActions(configuration, actionsLookup);\r\n        this.initializeActions(configuration, actionsLookup);\r\n        this.initializeEventActions(actionRegistryListener, configuration);\r\n        return actionsLookup;\r\n    }\r\n\r\n    initializeEventActions(actionRegistryListener, config) {\r\n        if ((actionRegistryListener) && (config.eventActions)) {\r\n            config.eventActions.forEach((actionData) => {\r\n                const eventAction = new Action(actionData, this.eventbus);\r\n                actionRegistryListener.registerAction(eventAction, actionData.eventName, actionData.eventTopic);\r\n            });\r\n            delete config.eventActions;\r\n        }\r\n    }\r\n\r\n    initializeActions(config, actionsLookup) {\r\n        if (config.actions) {\r\n            config.actions.forEach((actionData) => {\r\n                const action = new EndableAction(actionData, this.eventbus);\r\n                actionsLookup[actionData.name] = action;\r\n            });\r\n            delete config.actions;\r\n        }\r\n    }\r\n\r\n    initializeInitActions(config, actionsLookup) {\r\n        if (!config.initActions) {\r\n            return;\r\n        }\r\n        config.initActions = config.initActions.map((actionData) => {\r\n            const initAction = new EndableAction(actionData, this.eventbus);\r\n            actionsLookup[actionData.name] = initAction;\r\n            return initAction;\r\n        });\r\n    }\r\n\r\n    initializeTimelineActions(config) {\r\n        if (config.timelines) {\r\n            config.timelines.forEach(this.initializeTimelineAction.bind(this));\r\n        }\r\n    }\r\n\r\n    initializeTimelineAction(timelineConfig) {\r\n        if (!timelineConfig.timelineActions) {\r\n            return;\r\n        }\r\n        timelineConfig.timelineActions = timelineConfig.timelineActions.map((actionData) => {\r\n            const timelineAction = new TimelineAction(actionData, this.eventbus);\r\n            if (!timelineAction.endOperations) {\r\n                timelineAction.endOperations = [];\r\n            }\r\n            return timelineAction;\r\n        });\r\n    }\r\n\r\n    resolveOperations(config) {\r\n        const timelineOperations = [];\r\n        if (config.timelines) {\r\n            config.timelines.forEach((timelineInfo) => {\r\n                timelineOperations.push(...this._gatherOperations(timelineInfo.timelineActions));\r\n            });\r\n        }\r\n\r\n        const systemNameHolders = this._gatherOperations(config.initActions)\r\n                                    .concat(timelineOperations)\r\n                                    .concat(this._gatherOperations(config.actions))\r\n                                    .concat(this._gatherOperations(config.eventActions));\r\n\r\n        systemNameHolders.forEach((holder)=> {\r\n            holder.instance = this.importSystemEntry(holder.systemName);\r\n        });\r\n    }\r\n\r\n    processConfiguration(config, parentConfig) {\r\n        if (config == null) {\r\n            return;\r\n        }\r\n        if (config.constructor === Array) {\r\n            for (let i = 0, ii = config.length; i < ii; i++) {\r\n                this.processConfiguration(config[i], parentConfig);\r\n            }\r\n        } else {\r\n            Object.keys(config).forEach((key) => {\r\n                this.processConfigProperty(key, config, parentConfig);\r\n            });\r\n        }\r\n    }\r\n\r\n    processConfigProperty(key, config, parentConfig) {\r\n        const value = config[key];\r\n        if (typeof value === 'string') {           \r\n            if ((value.startsWith('config:'))) {\r\n                const configProperty = value.substr(7, value.length);\r\n                config[key] = getNestedPropertyValue(configProperty, parentConfig);\r\n            }\r\n            else if ((value.startsWith('template:'))) {\r\n                const templateKey = value.substr(9, value.length);\r\n                config[key] = this.importSystemEntry(templateKey);\r\n            }\r\n            else if ((value.startsWith('json:'))) {\r\n                const jsonKey = value.substr(5, value.length);\r\n                const json = this.importSystemEntry(jsonKey);\r\n                config[key] = json;\r\n            }\r\n        } else if (typeof value === 'object') {\r\n            this.processConfiguration(config[key], parentConfig);\r\n        }\r\n    }\r\n\r\n    _gatherOperations(actions) {\r\n        let result = [];\r\n        if (!actions) {\r\n            return result;\r\n        }\r\n        actions.forEach((action) => {\r\n            if (action.endOperations) {\r\n                result = result.concat(action.startOperations.concat(action.endOperations));\r\n            } else {\r\n                result = result.concat(action.startOperations);\r\n            }\r\n        });\r\n        return result;\r\n    }\r\n\r\n}\r\n\r\nexport default ConfigurationResolver;\r\n","function getNestedValue(properties, sourceObject) {\r\n    if (!properties) {\r\n        throw Error('properties arg cannot be null');\r\n    }\r\n    if (!sourceObject) {\r\n        throw Error('sourceObject arg cannot be null');\r\n    }\r\n    let currentInstance = sourceObject;\r\n    let suffix = null;\r\n    properties.forEach((prop, index) => {\r\n        if (index === properties.length-1) {\r\n            const parts = prop.split('+');\r\n            if (parts.length > 1) {\r\n                prop = parts[0];\r\n                suffix = parts[1];\r\n            }\r\n        }\r\n        currentInstance = currentInstance[prop];\r\n    });\r\n\r\n    return (suffix) ? currentInstance + suffix : currentInstance;\r\n}\r\n\r\nexport default getNestedValue;\r\n","import TimelineEventNames from \"./timeline-event-names\";\r\n\r\nclass LanguageManager {\r\n\r\n    constructor(language, labels, eventbus) {\r\n        if (!language || !language.length) {\r\n            throw new Error('language ctor arg cannot be null or have zero length');\r\n        }\r\n        if (!labels) {\r\n            throw new Error('labels ctor arg cannot be null');\r\n        }\r\n        if (!eventbus) {\r\n            throw new Error('eventbus ctor arg cannot be null');\r\n        }\r\n        this._labelLookup = {};\r\n        this._currentLanguage = language;\r\n        this._eventbusListeners = [];\r\n        this._createLabelLookup(labels);\r\n        this._addEventbusListeners(eventbus);\r\n    }\r\n\r\n    _addEventbusListeners(eventbus) {\r\n        this._eventbusListeners.push(eventbus.on(TimelineEventNames.REQUEST_LABEL_COLLECTION, this._handleRequestLabelCollection.bind(this)));\r\n        this._eventbusListeners.push(eventbus.on(TimelineEventNames.REQUEST_LABEL_COLLECTIONS, this._handleRequestLabelCollections.bind(this)));\r\n        this._eventbusListeners.push(eventbus.on(TimelineEventNames.REQUEST_CURRENT_LANGUAGE, this._handleRequestCurrentLanguage.bind(this)));\r\n        this._eventbusListeners.push(eventbus.on(TimelineEventNames.LANGUAGE_CHANGE, this._handleLanguageChange.bind(this)));\r\n    }\r\n\r\n    _handleRequestCurrentLanguage(resultCallback) {\r\n        resultCallback(this._currentLanguage);\r\n    }\r\n\r\n    _handleRequestLabelCollection(labelId, resultCallback) {\r\n        resultCallback(this._labelLookup[labelId]);\r\n    }\r\n\r\n    _handleRequestLabelCollections(labelIds, resultCallback) {\r\n        const labelCollections = labelIds.map((labelId) => {\r\n            return this._labelLookup[labelId];\r\n        });\r\n        resultCallback(labelCollections);\r\n    }\r\n\r\n    _handleLanguageChange(language) {\r\n        if (language && language.length) {\r\n            this._currentLanguage = language;\r\n        } else {\r\n            console.error('Language cannot be changed to null or empty string');\r\n        }\r\n    }\r\n\r\n    _createLabelLookup(labels) {\r\n        labels.forEach((label) => {\r\n            this._labelLookup[label.id] = label.labels;\r\n        });\r\n    }\r\n}\r\n\r\nexport default LanguageManager;\r\n","class Eventbus {\r\n\r\n\tconstructor() {\r\n\t\tthis.clear();\r\n\t}\r\n\r\n\tclear() {\r\n\t\tthis.eventHandlers = {};\r\n\t\tthis.eventListeners = [];\r\n\t\tthis.eventInterceptors = {};\r\n\t}\r\n\r\n\t_getEventInterceptors(eventName, eventTopic) {\r\n\t\tif ((eventTopic) && (eventTopic.length)) {\r\n\t\t\teventName = `${eventName}:${eventTopic}`;\r\n\t\t}\r\n\t\tif (!this.eventInterceptors[eventName]) {\r\n\t\t\tthis.eventInterceptors[eventName] = [];\r\n\t\t}\r\n\t\treturn this.eventInterceptors[eventName];\r\n\t}\r\n\r\n\t_getEventHandlers(eventName, eventTopic) {\r\n\t\tif ((eventTopic) && (eventTopic.length)) {\r\n\t\t\teventName = `${eventName}:${eventTopic}`;\r\n\t\t}\r\n\t\tif (!this.eventHandlers[eventName]) {\r\n\t\t\tthis.eventHandlers[eventName] = [];\r\n\t\t}\r\n\t\treturn this.eventHandlers[eventName];\r\n\t}\r\n\r\n\ton(eventName, eventHandler, eventTopic) {\r\n\t\tthis._getEventHandlers(eventName, eventTopic).push(eventHandler);\r\n\t\treturn () => {\r\n\t\t\tthis.off(eventName, eventHandler, eventTopic);\r\n\t\t}\r\n\t}\r\n\r\n\tonce(eventName, eventHandler, eventTopic) {\r\n\t\tconst _this = this;\r\n\t\tconst eventHandlerDecorator = function() {\r\n\t\t\teventHandler(...arguments)\r\n\t\t\t_this.off(eventName, eventHandlerDecorator, eventTopic);\r\n\t\t};\r\n\t\tthis.on(eventName, eventHandlerDecorator, eventTopic);\r\n\t}\r\n\r\n\toff(eventName, eventHandler, eventTopic) {\r\n\t\tconst handlers = this._getEventHandlers(eventName, eventTopic);\r\n\t\tif (handlers) {\r\n\t\t\tconst idx = handlers.indexOf(eventHandler);\r\n\t\t\tif (idx > -1) {\r\n\t\t\t\thandlers.splice(idx, 1);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tbroadcast(eventName, args) {\r\n\t\tthis._callHandlers(eventName, null, args);\r\n\t}\r\n\r\n\tbroadcastForTopic(eventName, eventTopic, args) {\r\n\t\tthis._callHandlers(eventName, eventTopic, args);\r\n\t}\r\n\r\n\tregisterEventlistener(eventbusListener) {\r\n\t\tthis.eventListeners.push(eventbusListener);\r\n\t}\r\n\r\n\tregisterInterceptor(eventName, interceptor, eventTopic) {\r\n\t\tconst interceptors = this._getEventInterceptors(eventName, eventTopic);\r\n\t\tinterceptors.push(interceptor);\r\n\t}\r\n\r\n\t_callHandlers(eventName, eventTopic, args=[]) {\r\n\t\tconst interceptors = this._getEventInterceptors(eventName, eventTopic);\r\n\t\tinterceptors.forEach((interceptor) => {\r\n\t\t\targs = interceptor.intercept(args);\r\n\t\t});\r\n\t\tthis.eventListeners.forEach((listener) => {\r\n\t\t\tlistener.handleEvent(eventName, eventTopic, args);\r\n\t\t});\r\n\t\tconst handlers = this._getEventHandlers(eventName, eventTopic);\r\n\t\tif (handlers) {\r\n\t\t\tfor (let i = 0, l = handlers.length; i < l; i++) {\r\n\t\t\t\tif (args.length) {\r\n\t\t\t\t\thandlers[i](...args);\r\n\t\t\t\t} else {\r\n\t\t\t\t\thandlers[i]();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\nexport default Eventbus;\r\n","import getNestedValue from './getNestedValue';\r\n\r\nfunction extractOperationDataArgumentValues(sourceObject, argumentValue) {\r\n    if ((argumentValue) && (argumentValue.toLowerCase) && (argumentValue.toLowerCase().startsWith('operationdata.'))) {\r\n        let propNames = argumentValue.split('.');\r\n        propNames.shift();\r\n        return getNestedValue(propNames, sourceObject);\r\n    }\r\n    return argumentValue;\r\n}\r\n\r\nexport default extractOperationDataArgumentValues;\r\n","import extractOperationDataArgumentValues from './extractOperationDataArgumentValues';\r\nimport deepcopy from './deepcopy';\r\n\r\nfunction resolvePropertyValues(operationData, properties) {\r\n    const copy = deepcopy(properties);\r\n    const extract = extractOperationDataArgumentValues.bind(null, operationData);\r\n    for(let propertyName in properties) {\r\n        const propertyValue = properties[propertyName];\r\n        copy[propertyName] = extract(propertyValue);\r\n    }\r\n    return copy;\r\n}\r\n\r\nexport default resolvePropertyValues\r\n","import EndableAction from './endableaction';\r\n\r\nclass TimelineAction extends EndableAction {\r\n\r\n\tconstructor(actionData, eventBus) {\r\n\t\tsuper(actionData, eventBus);\r\n\t\tthis.active = false;\r\n\t\tthis.duration = actionData.duration;\r\n\t\tthis.duration.start = +this.duration.start;\r\n\t\tthis.duration.end = +this.duration.end;\r\n\t}\r\n\r\n\tstart() {\r\n\t\tif ((!this.active) || (this.duration.end < 0)) {\r\n\t\t\tthis.active = (this.duration.end > -1);\r\n\t\t\treturn super.start();\r\n\t\t}\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\tresolve();\r\n\t\t});\r\n\t}\r\n\r\n\tend(initOperationData) {\r\n\t\tthis.active = false;\r\n\t\treturn super.end(initOperationData);\r\n\t}\r\n\r\n\tresize(operationData) {\r\n\t\tif ((this.active) || (this.duration.end < 0)) {\r\n\t\t\treturn super.resize(operationData);\r\n\t\t}\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\tresolve();\r\n\t\t});\r\n\t}\r\n\r\n}\r\n\r\nexport default TimelineAction;\r\n","import getNestedValue from \"./getNestedValue\";\r\n\r\nfunction getNestedPropertyValue(propertyChain, sourceObject) {\r\n    const properties = propertyChain.split('.');\r\n    return getNestedValue(properties, sourceObject);\r\n}\r\n\r\nexport default getNestedPropertyValue;\r\n","import LanguageManager from './language-manager';\r\nimport $ from 'jquery';\r\nimport TimelineEventNames from './timeline-event-names';\r\n\r\nclass ChronoTriggerEngine {\r\n\r\n    constructor(configuration, eventbus, timelineProvider) {\r\n        this._configuration = configuration;\r\n        this._eventbus = eventbus;\r\n        this._timelineProvider = timelineProvider;\r\n        this._timeLineActionsLookup = {};\r\n        this._eventbusListeners = [];\r\n    }\r\n\r\n    init() {\r\n        this._createLayoutTemplate();\r\n\r\n        this._addInitialisationListeners();\r\n\r\n        const { language, labels, timelines} = this._configuration;\r\n        const { _eventbus } = this;\r\n\r\n        this._languageManager = new LanguageManager(language, labels, _eventbus);\r\n\r\n        this._currentTimelineUri = (timelines && timelines.length) ? timelines[0].uri : null;\r\n\r\n        this._createTimelineLookup();\r\n\r\n        return this._initializeTimelineProvider();\r\n    }\r\n\r\n    _createLayoutTemplate() {\r\n        const { containerSelector } = this._configuration;\r\n        const container = $(containerSelector);\r\n        if (!container || !container.length) {\r\n            throw new Error(`Container selector not found: ${containerSelector}`);\r\n        }\r\n        const { layoutTemplate } = this._configuration;\r\n        if (layoutTemplate && layoutTemplate.length) {\r\n            container.html(layoutTemplate);\r\n        } else {\r\n            console.warning('layoutTemplate is empty, unable to create layout');\r\n        }\r\n    }\r\n\r\n    _initializeTimelineProvider() {\r\n        const { timelineProviderSettings } = this._configuration;\r\n        if (!timelineProviderSettings) {\r\n            return;\r\n        }\r\n\r\n        const playerContainer = $(`#${timelineProviderSettings.selector}`);\r\n\r\n        if (playerContainer.length) {\r\n            return new Promise((resolve) => {\r\n                this._timelineProvider.init().then(() => {\r\n                    this._executeActions((this._configuration.initActions), \"start\").then(() => {\r\n                        this._timelineProvider.on(TimelineEventNames.TIME, this._onTimeHandler.bind(this, Math.floor));\r\n                        this._timelineProvider.on(TimelineEventNames.SEEK, this._onSeekHandler.bind(this, Math.floor));\r\n                        resolve(this._timelineProvider);\r\n                    });\r\n                });\r\n            });\r\n        }\r\n\r\n        return new Promise((resolve)=> {\r\n            resolve();\r\n        });\r\n    }\r\n\r\n    async _cleanUp() {\r\n        await this._cleanUpTimeline();\r\n        await this._executeActions((this._configuration.initActions), 'end');\r\n    }\r\n\r\n    async destroy() {\r\n        await this._cleanUp();\r\n        this._configuration = null;\r\n        this._eventbus = null;\r\n        this._timelineProvider = null;\r\n        this._timeLineActionsLookup = null;\r\n        this._eventbusListeners.forEach(remover => remover());\r\n        if (this._timelineProvider) {\r\n            this._timelineProvider.destroy();\r\n        }\r\n    }\r\n\r\n    _addInitialisationListeners() {\r\n        this._eventbusListeners.push(this._eventbus.on(TimelineEventNames.REQUEST_ENGINE_ROOT, this._handleRequestEngineRoot.bind(this, this._configuration.containerSelector)));\r\n        this._eventbusListeners.push(this._eventbus.on(TimelineEventNames.REQUEST_TIMELINE_URI, this._handleRequestTimelineUri.bind(this)));\r\n        this._eventbusListeners.push(this._eventbus.on(TimelineEventNames.REQUEST_CURRENT_TIMELINE_POSITION, this._handleRequestTimelinePosition.bind(this)));\r\n        this._eventbusListeners.push(this._eventbus.on(TimelineEventNames.REQUEST_TIMELINE_CLEANUP, this._handleTimelineComplete.bind(this)));\r\n        this._eventbusListeners.push(this._eventbus.on(TimelineEventNames.EXECUTE_TIMELINEACTION, this._handleExecuteTimelineAction.bind(this)));\r\n        this._eventbusListeners.push(this._eventbus.on(TimelineEventNames.RESIZE_TIMELINEACTION, this._resizeTimelineAction.bind(this)));\r\n    }\r\n\r\n    _createTimelineLookup() {\r\n        if (!this._configuration.timelines) {\r\n            return;\r\n        }\r\n        this._configuration.timelines.forEach((timelineInfo) => {\r\n            timelineInfo.timelineActions.forEach(this._addTimelineAction.bind(this, timelineInfo.uri));\r\n        });\r\n    }\r\n\r\n    _addTimelineAction(uri, timeLineAction) {\r\n        const start = timeLineAction.duration.start;\r\n        const timelineStartPositions = this._initializeTimelinePosition(this._initializeUriLookup(this._timeLineActionsLookup, uri), start);\r\n        const startMethod = timeLineAction.start.bind(timeLineAction);\r\n        timelineStartPositions.push(startMethod);\r\n\r\n        let end = timeLineAction.duration.end;\r\n        if ((!end) || (isNaN(end))) {\r\n            end = timeLineAction.duration.end = Infinity;\r\n        }\r\n        if (isFinite(end)) {\r\n            const timelineEndPositions = this._initializeTimelinePosition(this._timeLineActionsLookup[uri], end);\r\n            const endMethod = timeLineAction.end.bind(timeLineAction);\r\n            timelineEndPositions.push(endMethod);\r\n        }\r\n    }\r\n\r\n    _initializeUriLookup(lookup, uri) {\r\n        if (!lookup[uri]) {\r\n            lookup[uri] = {};\r\n        }\r\n        return lookup[uri];\r\n    }\r\n\r\n    _initializeTimelinePosition(lookup, position) {\r\n        if (!lookup[position]) {\r\n            lookup[position] = [];\r\n        }\r\n        return lookup[position];\r\n    }\r\n\r\n    _executeActions(actions, methodName, idx=0) {\r\n        if (idx < actions.length) {\r\n            const action = actions[idx];\r\n\r\n            const promise = action[methodName]();\r\n            return promise.then(() => {\r\n                return this._executeActions(actions, methodName, ++idx);\r\n            });\r\n        }\r\n        return new Promise((resolve) => {\r\n            resolve();\r\n        });\r\n    }\r\n\r\n    _handleRequestEngineRoot(engineRootSelector, resultCallback) {\r\n        resultCallback($(engineRootSelector));\r\n    }\r\n\r\n    _handleRequestTimelineUri(index, position, previousVideoPosition) {\r\n        position = position || 0;\r\n        previousVideoPosition = previousVideoPosition || 0;\r\n        this._timelineProvider.stop();\r\n        this._cleanUpTimeline().then(() => {\r\n            const timelineConfig = this._configuration.timelines[index];\r\n            this._currentTimelineUri = timelineConfig.uri;\r\n            this._timelineProvider.loop = timelineConfig.loop;\r\n            if ((!this._timelineProvider.loop) && (position > 0)) {\r\n                this._timelineProvider.once(TimelineEventNames.FIRST_FRAME, () => {\r\n                    this._timelineProvider.pause();\r\n                    this._eventbus.broadcastForTopic(TimelineEventNames.DURATION, this._timelineProvider.playerid, [this.getDuration()]);\r\n                    this._executeStartActions().then(() => {\r\n                        this._timelineProvider.seek(position);\r\n                        this._onSeekHandler(Math.floor, { offset: position });\r\n                    });\r\n                });\r\n            }\r\n            this._timelineProvider.playlistItem(index);\r\n        });\r\n    }\r\n\r\n    _cleanUpTimeline() {\r\n        return this._executeRelevantActions(this._getActiveActions, \"end\");\r\n    }\r\n\r\n    _executeStartActions() {\r\n        return this._executeRelevantActions(this._getActionsForPosition.bind(this, 0), \"start\");\r\n    }\r\n\r\n    _getActionsForPosition(position, allActions) {\r\n        return allActions.filter((action) => {\r\n            return (!action.active) && ((action.duration.start <= position) && (action.duration.end >= position));\r\n        });\r\n    }\r\n\r\n    _getActiveActions(allActions) {\r\n        const actions = allActions.filter((action) => {\r\n            return action.active;\r\n        });\r\n        return actions.sort((a, b) => {\r\n            if (b.duration.start < a.duration.start) {\r\n                return -1;\r\n            } else if (b.duration.start > a.duration.start) {\r\n                return 1;\r\n            } else {\r\n                return 0;\r\n            }\r\n        });\r\n    }\r\n\r\n    _executeRelevantActions(filter, executionType) {\r\n        const timelineActions = this._getRelevantTimelineActions();\r\n        const currentActions = filter.apply(this, [timelineActions]);\r\n        return this._executeActions(currentActions, executionType, 0);\r\n    }\r\n\r\n    _handleRequestTimelinePosition(resultCallback) {\r\n        resultCallback(Math.floor(this._timelineProvider.getPosition()));\r\n    }\r\n\r\n    _handleTimelineComplete() {\r\n        this._cleanUpTimeline();\r\n    }\r\n\r\n    _handleExecuteTimelineAction(uri, index, start) {\r\n        const actions = this._getTimelineActionsForUri(uri);\r\n        const action = (actions) ? actions[index] : null;\r\n        if (action) {\r\n            if (start) {\r\n                action.start();\r\n            } else {\r\n                action.end();\r\n            }\r\n        }\r\n    }\r\n\r\n    _resizeTimelineAction(uri, index) {\r\n        const actions = this._getTimelineActionsForUri(uri);\r\n        const action = (actions) ? actions[index] : null;\r\n        if (action) {\r\n            action.resize();\r\n        }\r\n    }\r\n\r\n    _getRelevantTimelineActions() {\r\n        return this._getTimelineActionsForUri(this._currentTimelineUri);\r\n    }\r\n\r\n    _getTimelineActionsForUri(uri) {\r\n        let timelineActions;\r\n        this._configuration.timelines.some((timelineInfo) => {\r\n            if (timelineInfo.uri === uri) {\r\n                timelineActions = timelineInfo.timelineActions;\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n        return timelineActions;\r\n    }\r\n\r\n    _onTimeHandler(floor, event) {\r\n        if (!isNaN(event.position)) {\r\n            const pos = floor(event.position);\r\n            if (this._lastPosition !== pos) {\r\n                this._executeActionsForPosition(pos);\r\n                this._eventbus.broadcastForTopic(TimelineEventNames.POSITION_UPDATE, this._timelineProvider.playerid, [pos, this._timelineProvider.getDuration()]);\r\n            }\r\n            this._eventbus.broadcastForTopic(TimelineEventNames.TIME_UPDATE, this._timelineProvider.playerid, [event.position, this._timelineProvider.getDuration()]);\r\n        }\r\n    }\r\n\r\n    _onSeekHandler(floor, event) {\r\n        const pos = floor(event.offset);\r\n        if (isNaN(pos)) {\r\n            return;\r\n        }\r\n        this._executeSeekActions(pos).then(() => {\r\n            this._timelineProvider.play();\r\n        });\r\n    }\r\n\r\n    _executeActionsForPosition(position) {\r\n        this._lastPosition = position;\r\n        const actions = this._timeLineActionsLookup[this._currentTimelineUri];\r\n        if (actions) {\r\n            const executions = actions[position];\r\n            if (executions) {\r\n                executions.forEach((exec) => {\r\n                    exec();\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    _executeSeekActions(pos) {\r\n        const timelineActions = this._getRelevantTimelineActions();\r\n        const currentActions = this._getActiveActions(timelineActions);\r\n        const newActions = this._getActionsForPosition(pos, timelineActions);\r\n\r\n        const promise = this._executeActions(currentActions, \"end\", 0);\r\n\r\n        return new Promise((resolve) => {\r\n            promise.then(() => {\r\n                this._executeActions(newActions, \"start\", 0).then(() => {\r\n                    resolve();\r\n                });\r\n            });\r\n        });\r\n    }\r\n}\r\n\r\nexport default ChronoTriggerEngine;\r\n","import {\r\n    Eventbus,\r\n    ActionRegistryEventbusListener,\r\n    RequestVideoUriInterceptor\r\n} from './eventbus';\r\nimport $ from 'jquery';\r\nimport TimelineEventNames from './timeline-event-names';\r\nimport ConfigurationResolver from './configuration/configuration-resolver';\r\nimport Mousetrap from 'mousetrap';\r\n\r\nclass EngineFactory {\r\n\r\n    constructor(importer, windowRef, eventbus) {\r\n        this._init(importer, windowRef, eventbus);\r\n    }\r\n\r\n    _init(importer, windowRef, eventbus) {\r\n        this._resizeTimeout = -1;\r\n        this._actionsLookup = null;\r\n\r\n        this._importer = importer;\r\n\r\n        this._eventbus = eventbus || new Eventbus();\r\n        this._eventbus.on(TimelineEventNames.REQUEST_INSTANCE, this._requestInstanceHandler.bind(this));\r\n        this._eventbus.on(TimelineEventNames.REQUEST_ACTION, this._requestActionHandler.bind(this));\r\n        this._eventbus.on(TimelineEventNames.REQUEST_FUNCTION, this._requestFunctionHandler.bind(this));\r\n\r\n        $(windowRef).resize(this._resizeHandler.bind(this));\r\n    }\r\n\r\n    destroy() {\r\n        this._eventbus.clear();\r\n        this._eventbus = null;\r\n    }\r\n\r\n    _resizeHandler() {\r\n        if (this._resizeTimeout > -1) {\r\n            clearTimeout(this._resizeTimeout);\r\n        }\r\n        this._resizeTimeout = setTimeout(() => {\r\n            this._eventbus.broadcast(TimelineEventNames.RESIZE);\r\n        }, 200);\r\n    }\r\n\r\n    _importSystemEntryWithEventbusDependency(systemName) {\r\n        const ctor = this._importSystemEntry(systemName);\r\n        return new ctor(this._eventbus);\r\n    }\r\n\r\n    _importSystemEntry(systemName) {\r\n        return this._importer.import(systemName)[systemName];\r\n    }\r\n\r\n    _requestInstanceHandler(systemName, resultCallback) {\r\n        resultCallback(this._importSystemEntryWithEventbusDependency(systemName));\r\n    }\r\n\r\n    _requestFunctionHandler(systemName, resultCallback) {\r\n        resultCallback(this._importSystemEntry(systemName));\r\n    }\r\n\r\n    _requestActionHandler(systemName, resultCallback) {\r\n        const action = this._actionsLookup[systemName];\r\n        if (action) {\r\n            resultCallback(action);\r\n        } else {\r\n            console.error(`Unknown action: ${systemName}`);\r\n            resultCallback(null);\r\n        }\r\n    }\r\n\r\n    createEngine(configuration, resolver) {\r\n        const {\r\n            systemName\r\n        } = configuration.engine;\r\n        const engineClass = this._importSystemEntry(systemName);\r\n\r\n        let actionRegistryListener = null;\r\n        if ((configuration.eventActions) && (configuration.eventActions.length)) {\r\n            actionRegistryListener = new ActionRegistryEventbusListener();\r\n            this._eventbus.registerEventlistener(actionRegistryListener);\r\n        }\r\n\r\n        this._eventbus.registerInterceptor(TimelineEventNames.REQUEST_TIMELINE_URI, new RequestVideoUriInterceptor(this._eventbus));\r\n\r\n        resolver = resolver || new ConfigurationResolver(this._importer, this._eventbus);\r\n        this._actionsLookup = resolver.process(actionRegistryListener, configuration);\r\n\r\n        const timelineProviderClass = this._importSystemEntry(configuration.timelineProviderSettings.systemName);\r\n        const timelineProvider = new timelineProviderClass(this._eventbus, configuration);\r\n\r\n        Mousetrap.bind('space', event => {\r\n            event.preventDefault();\r\n            this._eventbus.broadcastForTopic(TimelineEventNames.PLAY_TOGGLE_REQUEST, timelineProvider.providerid);\r\n            return false;\r\n        });\r\n\r\n        const chronoTriggerEngine = new engineClass(configuration, this._eventbus, timelineProvider);\r\n        return chronoTriggerEngine;\r\n    }\r\n\r\n}\r\n\r\nexport default EngineFactory;","export { default as Eventbus } from './eventbus';\r\nexport { default as ActionRegistryEventbusListener } from './actionregistry-eventbus-listener';\r\nexport { default as RequestVideoUriInterceptor } from './request-video-uri-interceptor';","class ActionRegistryEventbusListener {\r\n\r\n\tconstructor() {\r\n\t\tthis.actionRegistry = {};\r\n\t}\r\n\r\n\tregisterAction(action, eventName, eventTopic) {\r\n\t\tif ((eventTopic) && (eventTopic.length)) {\r\n\t\t\teventName = `${eventName}:${eventTopic}`;\r\n\t\t}\r\n\t\tif (!this.actionRegistry[eventName]) {\r\n\t\t\tthis.actionRegistry[eventName] = [];\r\n\t\t}\r\n\t\tthis.actionRegistry[eventName].push(action);\r\n\t}\r\n\r\n\thandleEvent(eventName, eventTopic, args) {\r\n\t\tif ((eventTopic) && (eventTopic.length)) {\r\n\t\t\teventName = `${eventName}:${eventTopic}`;\r\n\t\t}\r\n\t\tconst actions = this.actionRegistry[eventName];\r\n\t\tif (actions) {\r\n\t\t\tconst operationData = {\r\n\t\t\t\teventArgs: args\r\n\t\t\t};\r\n\t\t\tactions.forEach((action) => {\r\n\t\t\t\taction.start(operationData);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default ActionRegistryEventbusListener;\r\n","import TimelineEventNames from \"../timeline-event-names\";\r\n\r\nclass RequestVideoUriInterceptor {\r\n\r\n\tconstructor(eventbus) {\r\n\t\tthis.eventbus = eventbus;\r\n\t}\r\n\r\n\tintercept(args) {\r\n\t\tthis.eventbus.broadcast(TimelineEventNames.BEFORE_REQUEST_TIMELINE_URI, args.slice());\r\n\t\treturn args;\r\n\t}\r\n\r\n}\r\n\r\nexport default RequestVideoUriInterceptor;\r\n","/*global define:false */\n/**\n * Copyright 2012-2017 Craig Campbell\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n * Mousetrap is a simple keyboard shortcut library for Javascript with\n * no external dependencies\n *\n * @version 1.6.3\n * @url craig.is/killing/mice\n */\n(function(window, document, undefined) {\n\n    // Check if mousetrap is used inside browser, if not, return\n    if (!window) {\n        return;\n    }\n\n    /**\n     * mapping of special keycodes to their corresponding keys\n     *\n     * everything in this dictionary cannot use keypress events\n     * so it has to be here to map to the correct keycodes for\n     * keyup/keydown events\n     *\n     * @type {Object}\n     */\n    var _MAP = {\n        8: 'backspace',\n        9: 'tab',\n        13: 'enter',\n        16: 'shift',\n        17: 'ctrl',\n        18: 'alt',\n        20: 'capslock',\n        27: 'esc',\n        32: 'space',\n        33: 'pageup',\n        34: 'pagedown',\n        35: 'end',\n        36: 'home',\n        37: 'left',\n        38: 'up',\n        39: 'right',\n        40: 'down',\n        45: 'ins',\n        46: 'del',\n        91: 'meta',\n        93: 'meta',\n        224: 'meta'\n    };\n\n    /**\n     * mapping for special characters so they can support\n     *\n     * this dictionary is only used incase you want to bind a\n     * keyup or keydown event to one of these keys\n     *\n     * @type {Object}\n     */\n    var _KEYCODE_MAP = {\n        106: '*',\n        107: '+',\n        109: '-',\n        110: '.',\n        111 : '/',\n        186: ';',\n        187: '=',\n        188: ',',\n        189: '-',\n        190: '.',\n        191: '/',\n        192: '`',\n        219: '[',\n        220: '\\\\',\n        221: ']',\n        222: '\\''\n    };\n\n    /**\n     * this is a mapping of keys that require shift on a US keypad\n     * back to the non shift equivelents\n     *\n     * this is so you can use keyup events with these keys\n     *\n     * note that this will only work reliably on US keyboards\n     *\n     * @type {Object}\n     */\n    var _SHIFT_MAP = {\n        '~': '`',\n        '!': '1',\n        '@': '2',\n        '#': '3',\n        '$': '4',\n        '%': '5',\n        '^': '6',\n        '&': '7',\n        '*': '8',\n        '(': '9',\n        ')': '0',\n        '_': '-',\n        '+': '=',\n        ':': ';',\n        '\\\"': '\\'',\n        '<': ',',\n        '>': '.',\n        '?': '/',\n        '|': '\\\\'\n    };\n\n    /**\n     * this is a list of special strings you can use to map\n     * to modifier keys when you specify your keyboard shortcuts\n     *\n     * @type {Object}\n     */\n    var _SPECIAL_ALIASES = {\n        'option': 'alt',\n        'command': 'meta',\n        'return': 'enter',\n        'escape': 'esc',\n        'plus': '+',\n        'mod': /Mac|iPod|iPhone|iPad/.test(navigator.platform) ? 'meta' : 'ctrl'\n    };\n\n    /**\n     * variable to store the flipped version of _MAP from above\n     * needed to check if we should use keypress or not when no action\n     * is specified\n     *\n     * @type {Object|undefined}\n     */\n    var _REVERSE_MAP;\n\n    /**\n     * loop through the f keys, f1 to f19 and add them to the map\n     * programatically\n     */\n    for (var i = 1; i < 20; ++i) {\n        _MAP[111 + i] = 'f' + i;\n    }\n\n    /**\n     * loop through to map numbers on the numeric keypad\n     */\n    for (i = 0; i <= 9; ++i) {\n\n        // This needs to use a string cause otherwise since 0 is falsey\n        // mousetrap will never fire for numpad 0 pressed as part of a keydown\n        // event.\n        //\n        // @see https://github.com/ccampbell/mousetrap/pull/258\n        _MAP[i + 96] = i.toString();\n    }\n\n    /**\n     * cross browser add event method\n     *\n     * @param {Element|HTMLDocument} object\n     * @param {string} type\n     * @param {Function} callback\n     * @returns void\n     */\n    function _addEvent(object, type, callback) {\n        if (object.addEventListener) {\n            object.addEventListener(type, callback, false);\n            return;\n        }\n\n        object.attachEvent('on' + type, callback);\n    }\n\n    /**\n     * takes the event and returns the key character\n     *\n     * @param {Event} e\n     * @return {string}\n     */\n    function _characterFromEvent(e) {\n\n        // for keypress events we should return the character as is\n        if (e.type == 'keypress') {\n            var character = String.fromCharCode(e.which);\n\n            // if the shift key is not pressed then it is safe to assume\n            // that we want the character to be lowercase.  this means if\n            // you accidentally have caps lock on then your key bindings\n            // will continue to work\n            //\n            // the only side effect that might not be desired is if you\n            // bind something like 'A' cause you want to trigger an\n            // event when capital A is pressed caps lock will no longer\n            // trigger the event.  shift+a will though.\n            if (!e.shiftKey) {\n                character = character.toLowerCase();\n            }\n\n            return character;\n        }\n\n        // for non keypress events the special maps are needed\n        if (_MAP[e.which]) {\n            return _MAP[e.which];\n        }\n\n        if (_KEYCODE_MAP[e.which]) {\n            return _KEYCODE_MAP[e.which];\n        }\n\n        // if it is not in the special map\n\n        // with keydown and keyup events the character seems to always\n        // come in as an uppercase character whether you are pressing shift\n        // or not.  we should make sure it is always lowercase for comparisons\n        return String.fromCharCode(e.which).toLowerCase();\n    }\n\n    /**\n     * checks if two arrays are equal\n     *\n     * @param {Array} modifiers1\n     * @param {Array} modifiers2\n     * @returns {boolean}\n     */\n    function _modifiersMatch(modifiers1, modifiers2) {\n        return modifiers1.sort().join(',') === modifiers2.sort().join(',');\n    }\n\n    /**\n     * takes a key event and figures out what the modifiers are\n     *\n     * @param {Event} e\n     * @returns {Array}\n     */\n    function _eventModifiers(e) {\n        var modifiers = [];\n\n        if (e.shiftKey) {\n            modifiers.push('shift');\n        }\n\n        if (e.altKey) {\n            modifiers.push('alt');\n        }\n\n        if (e.ctrlKey) {\n            modifiers.push('ctrl');\n        }\n\n        if (e.metaKey) {\n            modifiers.push('meta');\n        }\n\n        return modifiers;\n    }\n\n    /**\n     * prevents default for this event\n     *\n     * @param {Event} e\n     * @returns void\n     */\n    function _preventDefault(e) {\n        if (e.preventDefault) {\n            e.preventDefault();\n            return;\n        }\n\n        e.returnValue = false;\n    }\n\n    /**\n     * stops propogation for this event\n     *\n     * @param {Event} e\n     * @returns void\n     */\n    function _stopPropagation(e) {\n        if (e.stopPropagation) {\n            e.stopPropagation();\n            return;\n        }\n\n        e.cancelBubble = true;\n    }\n\n    /**\n     * determines if the keycode specified is a modifier key or not\n     *\n     * @param {string} key\n     * @returns {boolean}\n     */\n    function _isModifier(key) {\n        return key == 'shift' || key == 'ctrl' || key == 'alt' || key == 'meta';\n    }\n\n    /**\n     * reverses the map lookup so that we can look for specific keys\n     * to see what can and can't use keypress\n     *\n     * @return {Object}\n     */\n    function _getReverseMap() {\n        if (!_REVERSE_MAP) {\n            _REVERSE_MAP = {};\n            for (var key in _MAP) {\n\n                // pull out the numeric keypad from here cause keypress should\n                // be able to detect the keys from the character\n                if (key > 95 && key < 112) {\n                    continue;\n                }\n\n                if (_MAP.hasOwnProperty(key)) {\n                    _REVERSE_MAP[_MAP[key]] = key;\n                }\n            }\n        }\n        return _REVERSE_MAP;\n    }\n\n    /**\n     * picks the best action based on the key combination\n     *\n     * @param {string} key - character for key\n     * @param {Array} modifiers\n     * @param {string=} action passed in\n     */\n    function _pickBestAction(key, modifiers, action) {\n\n        // if no action was picked in we should try to pick the one\n        // that we think would work best for this key\n        if (!action) {\n            action = _getReverseMap()[key] ? 'keydown' : 'keypress';\n        }\n\n        // modifier keys don't work as expected with keypress,\n        // switch to keydown\n        if (action == 'keypress' && modifiers.length) {\n            action = 'keydown';\n        }\n\n        return action;\n    }\n\n    /**\n     * Converts from a string key combination to an array\n     *\n     * @param  {string} combination like \"command+shift+l\"\n     * @return {Array}\n     */\n    function _keysFromString(combination) {\n        if (combination === '+') {\n            return ['+'];\n        }\n\n        combination = combination.replace(/\\+{2}/g, '+plus');\n        return combination.split('+');\n    }\n\n    /**\n     * Gets info for a specific key combination\n     *\n     * @param  {string} combination key combination (\"command+s\" or \"a\" or \"*\")\n     * @param  {string=} action\n     * @returns {Object}\n     */\n    function _getKeyInfo(combination, action) {\n        var keys;\n        var key;\n        var i;\n        var modifiers = [];\n\n        // take the keys from this pattern and figure out what the actual\n        // pattern is all about\n        keys = _keysFromString(combination);\n\n        for (i = 0; i < keys.length; ++i) {\n            key = keys[i];\n\n            // normalize key names\n            if (_SPECIAL_ALIASES[key]) {\n                key = _SPECIAL_ALIASES[key];\n            }\n\n            // if this is not a keypress event then we should\n            // be smart about using shift keys\n            // this will only work for US keyboards however\n            if (action && action != 'keypress' && _SHIFT_MAP[key]) {\n                key = _SHIFT_MAP[key];\n                modifiers.push('shift');\n            }\n\n            // if this key is a modifier then add it to the list of modifiers\n            if (_isModifier(key)) {\n                modifiers.push(key);\n            }\n        }\n\n        // depending on what the key combination is\n        // we will try to pick the best event for it\n        action = _pickBestAction(key, modifiers, action);\n\n        return {\n            key: key,\n            modifiers: modifiers,\n            action: action\n        };\n    }\n\n    function _belongsTo(element, ancestor) {\n        if (element === null || element === document) {\n            return false;\n        }\n\n        if (element === ancestor) {\n            return true;\n        }\n\n        return _belongsTo(element.parentNode, ancestor);\n    }\n\n    function Mousetrap(targetElement) {\n        var self = this;\n\n        targetElement = targetElement || document;\n\n        if (!(self instanceof Mousetrap)) {\n            return new Mousetrap(targetElement);\n        }\n\n        /**\n         * element to attach key events to\n         *\n         * @type {Element}\n         */\n        self.target = targetElement;\n\n        /**\n         * a list of all the callbacks setup via Mousetrap.bind()\n         *\n         * @type {Object}\n         */\n        self._callbacks = {};\n\n        /**\n         * direct map of string combinations to callbacks used for trigger()\n         *\n         * @type {Object}\n         */\n        self._directMap = {};\n\n        /**\n         * keeps track of what level each sequence is at since multiple\n         * sequences can start out with the same sequence\n         *\n         * @type {Object}\n         */\n        var _sequenceLevels = {};\n\n        /**\n         * variable to store the setTimeout call\n         *\n         * @type {null|number}\n         */\n        var _resetTimer;\n\n        /**\n         * temporary state where we will ignore the next keyup\n         *\n         * @type {boolean|string}\n         */\n        var _ignoreNextKeyup = false;\n\n        /**\n         * temporary state where we will ignore the next keypress\n         *\n         * @type {boolean}\n         */\n        var _ignoreNextKeypress = false;\n\n        /**\n         * are we currently inside of a sequence?\n         * type of action (\"keyup\" or \"keydown\" or \"keypress\") or false\n         *\n         * @type {boolean|string}\n         */\n        var _nextExpectedAction = false;\n\n        /**\n         * resets all sequence counters except for the ones passed in\n         *\n         * @param {Object} doNotReset\n         * @returns void\n         */\n        function _resetSequences(doNotReset) {\n            doNotReset = doNotReset || {};\n\n            var activeSequences = false,\n                key;\n\n            for (key in _sequenceLevels) {\n                if (doNotReset[key]) {\n                    activeSequences = true;\n                    continue;\n                }\n                _sequenceLevels[key] = 0;\n            }\n\n            if (!activeSequences) {\n                _nextExpectedAction = false;\n            }\n        }\n\n        /**\n         * finds all callbacks that match based on the keycode, modifiers,\n         * and action\n         *\n         * @param {string} character\n         * @param {Array} modifiers\n         * @param {Event|Object} e\n         * @param {string=} sequenceName - name of the sequence we are looking for\n         * @param {string=} combination\n         * @param {number=} level\n         * @returns {Array}\n         */\n        function _getMatches(character, modifiers, e, sequenceName, combination, level) {\n            var i;\n            var callback;\n            var matches = [];\n            var action = e.type;\n\n            // if there are no events related to this keycode\n            if (!self._callbacks[character]) {\n                return [];\n            }\n\n            // if a modifier key is coming up on its own we should allow it\n            if (action == 'keyup' && _isModifier(character)) {\n                modifiers = [character];\n            }\n\n            // loop through all callbacks for the key that was pressed\n            // and see if any of them match\n            for (i = 0; i < self._callbacks[character].length; ++i) {\n                callback = self._callbacks[character][i];\n\n                // if a sequence name is not specified, but this is a sequence at\n                // the wrong level then move onto the next match\n                if (!sequenceName && callback.seq && _sequenceLevels[callback.seq] != callback.level) {\n                    continue;\n                }\n\n                // if the action we are looking for doesn't match the action we got\n                // then we should keep going\n                if (action != callback.action) {\n                    continue;\n                }\n\n                // if this is a keypress event and the meta key and control key\n                // are not pressed that means that we need to only look at the\n                // character, otherwise check the modifiers as well\n                //\n                // chrome will not fire a keypress if meta or control is down\n                // safari will fire a keypress if meta or meta+shift is down\n                // firefox will fire a keypress if meta or control is down\n                if ((action == 'keypress' && !e.metaKey && !e.ctrlKey) || _modifiersMatch(modifiers, callback.modifiers)) {\n\n                    // when you bind a combination or sequence a second time it\n                    // should overwrite the first one.  if a sequenceName or\n                    // combination is specified in this call it does just that\n                    //\n                    // @todo make deleting its own method?\n                    var deleteCombo = !sequenceName && callback.combo == combination;\n                    var deleteSequence = sequenceName && callback.seq == sequenceName && callback.level == level;\n                    if (deleteCombo || deleteSequence) {\n                        self._callbacks[character].splice(i, 1);\n                    }\n\n                    matches.push(callback);\n                }\n            }\n\n            return matches;\n        }\n\n        /**\n         * actually calls the callback function\n         *\n         * if your callback function returns false this will use the jquery\n         * convention - prevent default and stop propogation on the event\n         *\n         * @param {Function} callback\n         * @param {Event} e\n         * @returns void\n         */\n        function _fireCallback(callback, e, combo, sequence) {\n\n            // if this event should not happen stop here\n            if (self.stopCallback(e, e.target || e.srcElement, combo, sequence)) {\n                return;\n            }\n\n            if (callback(e, combo) === false) {\n                _preventDefault(e);\n                _stopPropagation(e);\n            }\n        }\n\n        /**\n         * handles a character key event\n         *\n         * @param {string} character\n         * @param {Array} modifiers\n         * @param {Event} e\n         * @returns void\n         */\n        self._handleKey = function(character, modifiers, e) {\n            var callbacks = _getMatches(character, modifiers, e);\n            var i;\n            var doNotReset = {};\n            var maxLevel = 0;\n            var processedSequenceCallback = false;\n\n            // Calculate the maxLevel for sequences so we can only execute the longest callback sequence\n            for (i = 0; i < callbacks.length; ++i) {\n                if (callbacks[i].seq) {\n                    maxLevel = Math.max(maxLevel, callbacks[i].level);\n                }\n            }\n\n            // loop through matching callbacks for this key event\n            for (i = 0; i < callbacks.length; ++i) {\n\n                // fire for all sequence callbacks\n                // this is because if for example you have multiple sequences\n                // bound such as \"g i\" and \"g t\" they both need to fire the\n                // callback for matching g cause otherwise you can only ever\n                // match the first one\n                if (callbacks[i].seq) {\n\n                    // only fire callbacks for the maxLevel to prevent\n                    // subsequences from also firing\n                    //\n                    // for example 'a option b' should not cause 'option b' to fire\n                    // even though 'option b' is part of the other sequence\n                    //\n                    // any sequences that do not match here will be discarded\n                    // below by the _resetSequences call\n                    if (callbacks[i].level != maxLevel) {\n                        continue;\n                    }\n\n                    processedSequenceCallback = true;\n\n                    // keep a list of which sequences were matches for later\n                    doNotReset[callbacks[i].seq] = 1;\n                    _fireCallback(callbacks[i].callback, e, callbacks[i].combo, callbacks[i].seq);\n                    continue;\n                }\n\n                // if there were no sequence matches but we are still here\n                // that means this is a regular match so we should fire that\n                if (!processedSequenceCallback) {\n                    _fireCallback(callbacks[i].callback, e, callbacks[i].combo);\n                }\n            }\n\n            // if the key you pressed matches the type of sequence without\n            // being a modifier (ie \"keyup\" or \"keypress\") then we should\n            // reset all sequences that were not matched by this event\n            //\n            // this is so, for example, if you have the sequence \"h a t\" and you\n            // type \"h e a r t\" it does not match.  in this case the \"e\" will\n            // cause the sequence to reset\n            //\n            // modifier keys are ignored because you can have a sequence\n            // that contains modifiers such as \"enter ctrl+space\" and in most\n            // cases the modifier key will be pressed before the next key\n            //\n            // also if you have a sequence such as \"ctrl+b a\" then pressing the\n            // \"b\" key will trigger a \"keypress\" and a \"keydown\"\n            //\n            // the \"keydown\" is expected when there is a modifier, but the\n            // \"keypress\" ends up matching the _nextExpectedAction since it occurs\n            // after and that causes the sequence to reset\n            //\n            // we ignore keypresses in a sequence that directly follow a keydown\n            // for the same character\n            var ignoreThisKeypress = e.type == 'keypress' && _ignoreNextKeypress;\n            if (e.type == _nextExpectedAction && !_isModifier(character) && !ignoreThisKeypress) {\n                _resetSequences(doNotReset);\n            }\n\n            _ignoreNextKeypress = processedSequenceCallback && e.type == 'keydown';\n        };\n\n        /**\n         * handles a keydown event\n         *\n         * @param {Event} e\n         * @returns void\n         */\n        function _handleKeyEvent(e) {\n\n            // normalize e.which for key events\n            // @see http://stackoverflow.com/questions/4285627/javascript-keycode-vs-charcode-utter-confusion\n            if (typeof e.which !== 'number') {\n                e.which = e.keyCode;\n            }\n\n            var character = _characterFromEvent(e);\n\n            // no character found then stop\n            if (!character) {\n                return;\n            }\n\n            // need to use === for the character check because the character can be 0\n            if (e.type == 'keyup' && _ignoreNextKeyup === character) {\n                _ignoreNextKeyup = false;\n                return;\n            }\n\n            self.handleKey(character, _eventModifiers(e), e);\n        }\n\n        /**\n         * called to set a 1 second timeout on the specified sequence\n         *\n         * this is so after each key press in the sequence you have 1 second\n         * to press the next key before you have to start over\n         *\n         * @returns void\n         */\n        function _resetSequenceTimer() {\n            clearTimeout(_resetTimer);\n            _resetTimer = setTimeout(_resetSequences, 1000);\n        }\n\n        /**\n         * binds a key sequence to an event\n         *\n         * @param {string} combo - combo specified in bind call\n         * @param {Array} keys\n         * @param {Function} callback\n         * @param {string=} action\n         * @returns void\n         */\n        function _bindSequence(combo, keys, callback, action) {\n\n            // start off by adding a sequence level record for this combination\n            // and setting the level to 0\n            _sequenceLevels[combo] = 0;\n\n            /**\n             * callback to increase the sequence level for this sequence and reset\n             * all other sequences that were active\n             *\n             * @param {string} nextAction\n             * @returns {Function}\n             */\n            function _increaseSequence(nextAction) {\n                return function() {\n                    _nextExpectedAction = nextAction;\n                    ++_sequenceLevels[combo];\n                    _resetSequenceTimer();\n                };\n            }\n\n            /**\n             * wraps the specified callback inside of another function in order\n             * to reset all sequence counters as soon as this sequence is done\n             *\n             * @param {Event} e\n             * @returns void\n             */\n            function _callbackAndReset(e) {\n                _fireCallback(callback, e, combo);\n\n                // we should ignore the next key up if the action is key down\n                // or keypress.  this is so if you finish a sequence and\n                // release the key the final key will not trigger a keyup\n                if (action !== 'keyup') {\n                    _ignoreNextKeyup = _characterFromEvent(e);\n                }\n\n                // weird race condition if a sequence ends with the key\n                // another sequence begins with\n                setTimeout(_resetSequences, 10);\n            }\n\n            // loop through keys one at a time and bind the appropriate callback\n            // function.  for any key leading up to the final one it should\n            // increase the sequence. after the final, it should reset all sequences\n            //\n            // if an action is specified in the original bind call then that will\n            // be used throughout.  otherwise we will pass the action that the\n            // next key in the sequence should match.  this allows a sequence\n            // to mix and match keypress and keydown events depending on which\n            // ones are better suited to the key provided\n            for (var i = 0; i < keys.length; ++i) {\n                var isFinal = i + 1 === keys.length;\n                var wrappedCallback = isFinal ? _callbackAndReset : _increaseSequence(action || _getKeyInfo(keys[i + 1]).action);\n                _bindSingle(keys[i], wrappedCallback, action, combo, i);\n            }\n        }\n\n        /**\n         * binds a single keyboard combination\n         *\n         * @param {string} combination\n         * @param {Function} callback\n         * @param {string=} action\n         * @param {string=} sequenceName - name of sequence if part of sequence\n         * @param {number=} level - what part of the sequence the command is\n         * @returns void\n         */\n        function _bindSingle(combination, callback, action, sequenceName, level) {\n\n            // store a direct mapped reference for use with Mousetrap.trigger\n            self._directMap[combination + ':' + action] = callback;\n\n            // make sure multiple spaces in a row become a single space\n            combination = combination.replace(/\\s+/g, ' ');\n\n            var sequence = combination.split(' ');\n            var info;\n\n            // if this pattern is a sequence of keys then run through this method\n            // to reprocess each pattern one key at a time\n            if (sequence.length > 1) {\n                _bindSequence(combination, sequence, callback, action);\n                return;\n            }\n\n            info = _getKeyInfo(combination, action);\n\n            // make sure to initialize array if this is the first time\n            // a callback is added for this key\n            self._callbacks[info.key] = self._callbacks[info.key] || [];\n\n            // remove an existing match if there is one\n            _getMatches(info.key, info.modifiers, {type: info.action}, sequenceName, combination, level);\n\n            // add this call back to the array\n            // if it is a sequence put it at the beginning\n            // if not put it at the end\n            //\n            // this is important because the way these are processed expects\n            // the sequence ones to come first\n            self._callbacks[info.key][sequenceName ? 'unshift' : 'push']({\n                callback: callback,\n                modifiers: info.modifiers,\n                action: info.action,\n                seq: sequenceName,\n                level: level,\n                combo: combination\n            });\n        }\n\n        /**\n         * binds multiple combinations to the same callback\n         *\n         * @param {Array} combinations\n         * @param {Function} callback\n         * @param {string|undefined} action\n         * @returns void\n         */\n        self._bindMultiple = function(combinations, callback, action) {\n            for (var i = 0; i < combinations.length; ++i) {\n                _bindSingle(combinations[i], callback, action);\n            }\n        };\n\n        // start!\n        _addEvent(targetElement, 'keypress', _handleKeyEvent);\n        _addEvent(targetElement, 'keydown', _handleKeyEvent);\n        _addEvent(targetElement, 'keyup', _handleKeyEvent);\n    }\n\n    /**\n     * binds an event to mousetrap\n     *\n     * can be a single key, a combination of keys separated with +,\n     * an array of keys, or a sequence of keys separated by spaces\n     *\n     * be sure to list the modifier keys first to make sure that the\n     * correct key ends up getting bound (the last key in the pattern)\n     *\n     * @param {string|Array} keys\n     * @param {Function} callback\n     * @param {string=} action - 'keypress', 'keydown', or 'keyup'\n     * @returns void\n     */\n    Mousetrap.prototype.bind = function(keys, callback, action) {\n        var self = this;\n        keys = keys instanceof Array ? keys : [keys];\n        self._bindMultiple.call(self, keys, callback, action);\n        return self;\n    };\n\n    /**\n     * unbinds an event to mousetrap\n     *\n     * the unbinding sets the callback function of the specified key combo\n     * to an empty function and deletes the corresponding key in the\n     * _directMap dict.\n     *\n     * TODO: actually remove this from the _callbacks dictionary instead\n     * of binding an empty function\n     *\n     * the keycombo+action has to be exactly the same as\n     * it was defined in the bind method\n     *\n     * @param {string|Array} keys\n     * @param {string} action\n     * @returns void\n     */\n    Mousetrap.prototype.unbind = function(keys, action) {\n        var self = this;\n        return self.bind.call(self, keys, function() {}, action);\n    };\n\n    /**\n     * triggers an event that has already been bound\n     *\n     * @param {string} keys\n     * @param {string=} action\n     * @returns void\n     */\n    Mousetrap.prototype.trigger = function(keys, action) {\n        var self = this;\n        if (self._directMap[keys + ':' + action]) {\n            self._directMap[keys + ':' + action]({}, keys);\n        }\n        return self;\n    };\n\n    /**\n     * resets the library back to its initial state.  this is useful\n     * if you want to clear out the current keyboard shortcuts and bind\n     * new ones - for example if you switch to another page\n     *\n     * @returns void\n     */\n    Mousetrap.prototype.reset = function() {\n        var self = this;\n        self._callbacks = {};\n        self._directMap = {};\n        return self;\n    };\n\n    /**\n     * should we stop this event before firing off callbacks\n     *\n     * @param {Event} e\n     * @param {Element} element\n     * @return {boolean}\n     */\n    Mousetrap.prototype.stopCallback = function(e, element) {\n        var self = this;\n\n        // if the element has the class \"mousetrap\" then no need to stop\n        if ((' ' + element.className + ' ').indexOf(' mousetrap ') > -1) {\n            return false;\n        }\n\n        if (_belongsTo(element, self.target)) {\n            return false;\n        }\n\n        // Events originating from a shadow DOM are re-targetted and `e.target` is the shadow host,\n        // not the initial event target in the shadow tree. Note that not all events cross the\n        // shadow boundary.\n        // For shadow trees with `mode: 'open'`, the initial event target is the first element in\n        // the event’s composed path. For shadow trees with `mode: 'closed'`, the initial event\n        // target cannot be obtained.\n        if ('composedPath' in e && typeof e.composedPath === 'function') {\n            // For open shadow trees, update `element` so that the following check works.\n            var initialEventTarget = e.composedPath()[0];\n            if (initialEventTarget !== e.target) {\n                element = initialEventTarget;\n            }\n        }\n\n        // stop for input, select, and textarea\n        return element.tagName == 'INPUT' || element.tagName == 'SELECT' || element.tagName == 'TEXTAREA' || element.isContentEditable;\n    };\n\n    /**\n     * exposes _handleKey publicly so it can be overwritten by extensions\n     */\n    Mousetrap.prototype.handleKey = function() {\n        var self = this;\n        return self._handleKey.apply(self, arguments);\n    };\n\n    /**\n     * allow custom key mappings\n     */\n    Mousetrap.addKeycodes = function(object) {\n        for (var key in object) {\n            if (object.hasOwnProperty(key)) {\n                _MAP[key] = object[key];\n            }\n        }\n        _REVERSE_MAP = null;\n    };\n\n    /**\n     * Init the global mousetrap functions\n     *\n     * This method is needed to allow the global mousetrap functions to work\n     * now that mousetrap is a constructor function.\n     */\n    Mousetrap.init = function() {\n        var documentMousetrap = Mousetrap(document);\n        for (var method in documentMousetrap) {\n            if (method.charAt(0) !== '_') {\n                Mousetrap[method] = (function(method) {\n                    return function() {\n                        return documentMousetrap[method].apply(documentMousetrap, arguments);\n                    };\n                } (method));\n            }\n        }\n    };\n\n    Mousetrap.init();\n\n    // expose mousetrap to the global object\n    window.Mousetrap = Mousetrap;\n\n    // expose as a common js module\n    if (typeof module !== 'undefined' && module.exports) {\n        module.exports = Mousetrap;\n    }\n\n    // expose mousetrap as an AMD module\n    if (typeof define === 'function' && define.amd) {\n        define(function() {\n            return Mousetrap;\n        });\n    }\n}) (typeof window !== 'undefined' ? window : null, typeof  window !== 'undefined' ? document : null);\n","import * as controllers from '../controllers';\r\nimport * as operations from '../operation';\r\nimport * as providers from '../timelineproviders';\r\nimport * as main from '../';\r\n\r\nclass WebpackResourceImporter {\r\n\r\n    getOperationNames() {\r\n        return Object.keys(operations);\r\n    }\r\n\r\n    getControllerNames() {\r\n        return Object.keys(controllers);\r\n    }\r\n\r\n    getProviderNames() {\r\n        return Object.keys(providers);\r\n    }\r\n\r\n    import(name) {\r\n        if (operations[name]) {\r\n            return {\r\n                [name]: operations[name]\r\n            };\r\n        } else if (controllers[name]) {\r\n            return {\r\n                [name]: controllers[name]\r\n            };\r\n        } else if (providers[name]) {\r\n            return {\r\n                [name]: providers[name]\r\n            };\r\n        } else if (main[name]) {\r\n            return {\r\n                [name]: main[name]\r\n            };\r\n        }\r\n        return null;\r\n    }\r\n\r\n}\r\n\r\nexport default WebpackResourceImporter;\r\n","export { default as EventListenerController } from './EventListenerController';\r\nexport { default as LabelController } from './LabelController';\r\nexport { default as LottieController } from './LottieController';\r\nexport { default as NavigationController } from './NavigationController';\r\nexport { default as ProgressbarController } from './ProgressbarController';\r\nexport { default as RoutingController } from './RoutingController';\r\nexport { default as SubtitlesController } from './SubtitlesController';\r\n","import $ from 'jquery';\r\nimport TimelineEventNames from \"../timeline-event-names\";\r\nimport deepcopy from '../operation/helper/deepcopy';\r\n\r\nclass EventListenerController {\r\n\r\n\tconstructor() {\r\n\t\tthis.operationData = null;\r\n\t\tthis.actionInstanceInfos = null;\r\n\t\tthis.name = \"EventListenerController\";\r\n\t}\r\n\r\n\tinit(operationData) {\r\n\t\tthis.operationData = {\r\n\t\t\tselectedElement: operationData.selectedElement,\r\n\t\t\teventName: operationData.eventName,\r\n\t\t\tactions: operationData.actions.slice(),\r\n\t\t\tactionOperationData: operationData.actionOperationData ? deepcopy(operationData.actionOperationData) : undefined\r\n\t\t}\r\n\t}\r\n\r\n\tattach(eventbus) {\r\n\t\tconst { selectedElement, actions, eventName } = this.operationData;\r\n\t\tif (!this.actionInstanceInfos) {\r\n\t\t\tthis.actionInstanceInfos = [];\r\n\t\t\tactions.forEach((actionName) => {\r\n\t\t\t\tconst [isStart, name] = this._isStartAction(actionName);\r\n\t\t\t\tconst resultCallback = (actionInstance) => {\r\n\t\t\t\t\tthis.actionInstanceInfos.push({ start: isStart, action: actionInstance });\r\n\t\t\t\t};\r\n\r\n\t\t\t\teventbus.broadcast(TimelineEventNames.REQUEST_ACTION, [name, resultCallback]);\r\n\t\t\t});\r\n\t\t\tif (this._getElementTagName(selectedElement) === \"SELECT\") {\r\n\t\t\t\tselectedElement.on(eventName, this._selectEventHandler.bind(this));\r\n\t\t\t} else {\r\n\t\t\t\tselectedElement.on(eventName, this._eventHandler.bind(this));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t_getElementTagName(element) {\r\n\t\tconst tagName = (element.length) ? element[0].tagName : element.tagName;\r\n\t\treturn tagName.toUpperCase();\r\n\t}\r\n\r\n\t_isStartAction(actionName) {\r\n\t\tconst prefix = actionName.substr(0, \"end:\".length);\r\n\t\tif (prefix === \"end:\") {\r\n\t\t\treturn [false, actionName.substr(\"end:\".length)];\r\n\t\t} else {\r\n\t\t\treturn [true, actionName];\r\n\t\t}\r\n\t}\r\n\r\n\t_eventHandler(event) {\r\n\t\tconst copy = (this.operationData.actionOperationData) ? deepcopy(this.operationData.actionOperationData) : {};\r\n\t\tif (event.target) {\r\n\t\t\tcopy.targetValue = event.target.value;\r\n\t\t}\r\n\t\tthis._executeAction(this.actionInstanceInfos, copy, 0);\r\n\t}\r\n\r\n\t_executeAction(actions, operationData, idx) {\r\n\t\tif (idx < actions.length) {\r\n\t\t\tconst actionInfo = actions[idx];\r\n\t\t\tconst { action } = actionInfo;\r\n\t\t\tconst method = (actionInfo.start) ? action.start.bind(action) : action.end.bind(action);\r\n\t\t\tmethod(operationData)\r\n\t\t\t\t.then((resultOperationData) => {\r\n\t\t\t\t\treturn this._executeAction(actions, Object.assign(operationData, resultOperationData), ++idx);\r\n\t\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t_selectEventHandler(event) {\r\n\t\tconst options = event.target;\r\n\t\tfor (let i = 0, l = options.length; i < l; i++) {\r\n\t\t\tconst opt = options[i];\r\n\t\t\tif (opt.selected) {\r\n\t\t\t\tconst copy = (this.operationData.actionOperationData) ? deepcopy(this.operationData.actionOperationData) : {};\r\n\t\t\t\tthis._executeAction(this.actionInstanceInfos, Object.assign({ eventArgs: [opt.value] }, copy), 0);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tdetach(eventbus) {\r\n\t\tthis.operationData.selectedElement.off(this.operationData.eventName);\r\n\t}\r\n\r\n}\r\n\r\nexport default EventListenerController;\r\n","import TimelineEventNames from \"../timeline-event-names\";\r\n\r\nclass LabelController {\r\n\r\n\tconstructor() {\r\n\t\tthis.listeners = [];\r\n\t\tthis.currentLanguage = null;\r\n\t\tthis.operationData = null;\r\n\t\tthis.labelData = {};\r\n\t\tthis.name = \"LabelController\";\r\n\t}\r\n\r\n\tinit(operationData) {\r\n\t\tthis.operationData = Object.assign({},operationData);\r\n\t}\r\n\r\n\tattach(eventbus) {\r\n\t\teventbus.broadcast(TimelineEventNames.REQUEST_CURRENT_LANGUAGE, [(language)=> {\r\n\t\t\tthis.currentLanguage = language;\r\n\t\t}]);\r\n\t\teventbus.broadcast(TimelineEventNames.REQUEST_LABEL_COLLECTION, [this.operationData.labelId, (labelCollection)=> {\r\n\t\t\tthis.createTextDataLookup(labelCollection);\r\n\t\t}]);\r\n\t\tthis.setLabel();\r\n\t\tthis.listeners.push(eventbus.on(TimelineEventNames.LANGUAGE_CHANGE, this.handleLanguageChange.bind(this)));\r\n\t}\r\n\r\n\tsetLabel() {\r\n\t\tthis.operationData.selectedElement.html(this.labelData[this.currentLanguage]);\r\n\t}\r\n\r\n\tdetach(eventbus) {\r\n\t\tthis.listeners.forEach((func) => {\r\n\t\t\tfunc();\r\n\t\t});\r\n\t}\r\n\r\n\thandleLanguageChange(code) {\r\n\t\tthis.currentLanguage = code;\r\n\t\tthis.setLabel();\r\n\t}\r\n\r\n\tcreateTextDataLookup(data) {\r\n\t\tdata.forEach((d) => {\r\n\t\t\tthis.labelData[d.code] = d.label;\r\n\t\t});\r\n\t}\r\n}\r\n\r\nexport default LabelController;\r\n","import lottie from 'lottie-web';\r\nimport TimelineEventNames from '../timeline-event-names';\r\n\r\nclass LottieController {\r\n\r\n\tconstructor() {\r\n\t\tthis.name = \"LottieController\";\r\n\t\tthis.currentLanguage = null;\r\n\t\tthis.labelData = {};\r\n\t\tthis.listeners = [];\r\n\t\tthis.anim = null;\r\n\t\tthis.operationData = null;\r\n\t\tthis.serializedData = null;\r\n\t\tthis.serializedIEData = null;\r\n\t\tthis.animationData = null;\r\n\t\tthis.freezePosition = -1;\r\n\t\tthis.endPosition = -1;\r\n\t}\r\n\r\n\tinit(operationData) {\r\n\t\tthis.operationData = {\r\n\t\t\tselectedElement: operationData.selectedElement,\r\n\t\t\trenderer: operationData.renderer,\r\n\t\t\tloop: operationData.loop,\r\n\t\t\tautoplay: operationData.autoplay,\r\n\t\t\tanimationData: operationData.animationData,\r\n\t\t\tjson: operationData.json,\r\n\t\t\tlabelIds: operationData.labelIds,\r\n\t\t\tviewBox: operationData.viewBox\r\n\t\t};\r\n\t\tif (operationData.url.indexOf(\"[\") > -1) {\r\n\t\t\tthis.parseFilename(operationData.url);\r\n\t\t}\r\n\t\tthis.serializedData = this.operationData.json\r\n\t\t\t? JSON.stringify(this.operationData.json)\r\n\t\t\t: JSON.stringify(this.operationData.animationData);\r\n\t\tif (this.operationData.iefallback) {\r\n\t\t\tthis.serializedIEData = JSON.stringify(this.operationData.iefallback);\r\n\t\t}\r\n\t}\r\n\r\n\tparseFilename(name) {\r\n\t\tconst params = name.substr(name.indexOf(\"[\") + 1, name.indexOf(\"]\") - name.indexOf(\"[\") - 1);\r\n\t\tconst settings = params.split(\",\");\r\n\t\tsettings.forEach((setting) => {\r\n\t\t\tconst values = setting.split(\"=\");\r\n\t\t\tif (values[0] === \"freeze\") {\r\n\t\t\t\tthis.freezePosition = +values[1];\r\n\t\t\t} else if (values[0] === \"end\") {\r\n\t\t\t\tthis.endPosition = +values[1];\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tattach(eventbus) {\r\n\t\tconst { labelIds } = this.operationData; \r\n\t\tif ((labelIds) && (labelIds.length)) {\r\n\t\t\tconst resultHolder = {};\r\n\t\t\t\r\n\t\t\teventbus.broadcast(TimelineEventNames.REQUEST_CURRENT_LANGUAGE, [resultHolder]);\r\n\t\t\tthis.currentLanguage = resultHolder.language;\r\n\t\t\tthis.listeners.push(eventbus.on(TimelineEventNames.LANGUAGE_CHANGE, this.handleLanguageChange.bind(this)));\r\n\t\t\teventbus.broadcast(TimelineEventNames.REQUEST_LABEL_COLLECTIONS, [this.operationData.labelIds, resultHolder]);\r\n\t\t\tthis.createTextDataLookup(resultHolder.labelCollections);\r\n\t\t}\r\n\t\tthis.createAnimation();\r\n\t}\r\n\r\n\tdetach(eventbus) {\r\n\t\tthis.listeners.forEach((func) => {\r\n\t\t\tfunc();\r\n\t\t});\r\n\t\tif (this.anim) {\r\n\t\t\tif (this.endPosition > -1) {\r\n\t\t\t\tthis.anim.onComplete = this.destroy.bind(this);\r\n\t\t\t\tthis.anim.playSegments([this.freezePosition, this.endPosition], true);\r\n\t\t\t} else {\r\n\t\t\t\tthis.anim.destroy();\r\n\t\t\t}\r\n\t\t}\r\n  }\r\n    \r\n\tdestroy() {\r\n\t\tif (this.anim) {\r\n\t\t\tthis.anim.destroy();\r\n\t\t\tthis.anim = null;\r\n\t\t}\r\n\t}\r\n\r\n\tcreateAnimation() {\r\n\t\tif (this.anim) {\r\n\t\t\tthis.anim.destroy();\r\n\t\t}\r\n\t\tlet serialized = (this.isIE()) ? this.serializedIEData : this.serializedData;\r\n\r\n\t\tconst { labelIds } = this.operationData;\r\n\t\tif (labelIds && labelIds.length) {\r\n\t\t\tlabelIds.forEach((id) => {\r\n\t\t\t\tserialized = serialized.split(`!!${id}!!`).join(this.labelData[id][this.currentLanguage]);\r\n\t\t\t});\r\n\t\t}\r\n\t\tconst animData = JSON.parse(serialized);\r\n\r\n\t\tconst animationData = {\r\n\t\t\tautoplay: this.operationData.autoplay,\r\n\t\t\tcontainer: this.operationData.selectedElement[0],\r\n\t\t\tloop: this.operationData.loop,\r\n\t\t\trenderer: this.operationData.renderer,\r\n\t\t\tanimationData:animData\r\n\t\t}\r\n\r\n\t\tthis.anim = lottie.loadAnimation(animationData);\r\n\t\tif (this.endPosition < 0) {\r\n\t\t\tthis.endPosition = this.anim.timeCompleted;\r\n\t\t}\r\n\r\n\t\tif (this.freezePosition > -1) {\r\n\t\t\tthis.anim.playSegments([0, this.freezePosition], true);\r\n\t\t}\r\n\t\tif (this.operationData.viewBox) {\r\n\t\t\tthis.operationData.selectedElement.find(\"svg\").attr('viewBox', this.operationData.viewBox);\r\n\t\t}\r\n\t}\r\n\r\n\tcreateTextDataLookup(data) {\r\n\t\tdata.forEach((infos, index) => {\r\n\t\t\tinfos.forEach((d) => {\r\n\t\t\t\tthis.labelData[this.operationData.labelIds[index]][d.code] = d.label;\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\thandleLanguageChange(code) {\r\n\t\tthis.currentLanguage = code;\r\n\t\tthis.createAnimation();\r\n\t}\r\n\r\n\tisIE() {\r\n\t\tconst isIE = false || !!document['documentMode'];\r\n\r\n\t\t// Edge 20+\r\n\t\tconst isEdge = !isIE && !!window['StyleMedia'];\r\n\r\n\t\treturn isEdge || isIE;\r\n\t}\r\n\r\n}\r\n\r\nexport default LottieController;\r\n","module.exports = __WEBPACK_EXTERNAL_MODULE__29__;","import $ from 'jquery';\r\n\r\nclass NavigationController {\r\n\r\n\tconstructor() {\r\n\t\tthis.name = 'NavigationController';\r\n\t\tthis.playerId = null;\r\n\t\tthis.navigation = null;\r\n\t\tthis.navLookup = {};\r\n\t\tthis.navVidIdLookup = {};\r\n\t\tthis.ctrlLookup = {};\r\n\t\tthis.activeNavigationPoint = null;\r\n\t\tthis.labelControllers = null;\r\n\t\tthis.eventhandlers = null;\r\n\t\tthis.eventbus = null;\r\n\t\tthis.container = null;\r\n\t}\r\n\r\n\tinit(operationData) {\r\n\t\tthis.container = operationData.selectedElement;\r\n\t\tthis.playerId = operationData.playerId;\r\n\t\tthis.navigation = this.buildNavigationData(operationData.json);\r\n\t}\r\n\r\n\tattach(eventbus) {\r\n\t\tthis.eventhandlers = [];\r\n\t\tthis.labelControllers = [];\r\n\t\tthis.eventhandlers.push(eventbus.on('navigate-to-video-url', this.handleNavigateVideoUrl.bind(this)));\r\n\t\tthis.eventhandlers.push(eventbus.on('highlight-navigation', this.highlightMenu.bind(this)));\r\n\t\tthis.eventhandlers.push(eventbus.on('request-current-navigation', this.handleRequestCurrentNavigation.bind(this)));\r\n\t\tthis.eventhandlers.push(eventbus.on('video-complete', this.handleVideoComplete.bind(this), this.playerId));\r\n\t\tthis.eventbus = eventbus;\r\n\r\n        this.buildHtml(this.container, this.navigation);\r\n        this.initHistory.bind(this);\r\n\t}\r\n\r\n\tinitHistory() {\r\n\t\tthis.activeNavigationPoint = this.navVidIdLookup[0];\r\n\t\tconst navId = this.getQueryVariable(0);\r\n\t\tlet videoIndex = 0;\r\n\t\tif (navId) {\r\n\t\t\tconst nav = this.navLookup[navId];\r\n\t\t\tvideoIndex = nav.videoUrlIndex;\r\n\t\t}\r\n\t\tthis.highlightMenu(videoIndex);\r\n\t}\r\n\r\n\tgetQueryVariable(variableIdx) {\r\n\t\tconst href = window.location.href;\r\n\t\tconst hashIndex = href.indexOf('#');\r\n\t\tif (hashIndex > -1) {\r\n\t\t\tconst query = href.substring(hashIndex + 2);\r\n\t\t\tif (query) {\r\n\t\t\t\tconst vars = query.split('/');\r\n\t\t\t\treturn vars[variableIdx];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\thandleRequestCurrentNavigation(resultCallback) {\r\n\t\tresultCallback({\r\n\t\t\tnavigationData: this.activeNavigationPoint,\r\n\t\t\ttitle: this.ctrlLookup[this.activeNavigationPoint.labelId].labelData[this.ctrlLookup[this.activeNavigationPoint.labelId].currentLanguage]\r\n\t\t});\r\n\t}\r\n\r\n\t detach(eventbus) {\r\n\t\tif (this.eventhandlers) {\r\n\t\t\tthis.eventhandlers.forEach((handler) => {\r\n\t\t\t\thandler();\r\n\t\t\t});\r\n\t\t}\r\n\t\tthis.labelControllers.forEach((ctrl) => {\r\n\t\t\tctrl.detach(eventbus);\r\n\t\t});\r\n\t\tthis.labelControllers.length = 0;\r\n\t\tthis.eventbus = null;\r\n\t\tthis.container = null;\r\n\t\twindow.onpopstate = null;\r\n\t}\r\n\r\n\tpushCurrentState(position = -1) {\r\n\t\tconst state = {\r\n\t\t\tnavigationData: this.activeNavigationPoint,\r\n\t\t\ttitle: this.ctrlLookup[this.activeNavigationPoint.labelId].labelData[this.ctrlLookup[this.activeNavigationPoint\r\n\t\t\t\t.labelId].currentLanguage]\r\n\t\t};\r\n\t\tif (position > -1) {\r\n\t\t\tstate.position = position;\r\n\t\t}\r\n\t\tthis.eventbus.broadcast('push-history-state',[state]);\r\n\t}\r\n\r\n\tbuildHtml(parentElm, data) {\r\n\t\tconst ul = $('<ul/>');\r\n\t\tdata.forEach(this.addNavElement.bind(this, ul));\r\n\t\tparentElm.append(ul);\r\n\t}\r\n\r\n\taddNavElement(parentElm, data) {\r\n\t\tif (data.visible) {\r\n\t\t\tconst li = $('<li/>');\r\n\t\t\tconst a = $(`<a href='javascript:;' id='nav_${data.videoUrlIndex}'/>`);\r\n\t\t\tli.append(a);\r\n\t\t\tthis.addLabel(a, data.labelId);\r\n\t\t\tthis.addClickHandler(a, data.videoUrlIndex);\r\n\t\t\tif (data.children) {\r\n\t\t\t\tconst ul = $('<ul/>');\r\n\t\t\t\tdata.children.forEach(this.addNavElement.bind(this, ul));\r\n\t\t\t\tli.append(ul);\r\n\t\t\t}\r\n\t\t\tparentElm.append(li);\r\n\t\t}\r\n\t}\r\n\r\n\taddClickHandler(parentElm, videoIndex) {\r\n\t\tparentElm.mouseup(this.menuMouseupHandler.bind(this, videoIndex));\r\n\t}\r\n\r\n\tmenuMouseupHandler(videoIndex) {\r\n\t\tconst navdata = this.navVidIdLookup[videoIndex];\r\n\t\tif (navdata) {\r\n\t\t\tthis.eventbus.broadcast('request-video-url', [navdata.videoUrlIndex]);\r\n\t\t\tthis.handleNavigateVideoUrl(navdata.videoUrlIndex);\r\n\t\t}\r\n\t}\r\n\r\n\thandleNavigateVideoUrl(index, requestedVideoPosition) {\r\n        requestedVideoPosition = (requestedVideoPosition) ? requestedVideoPosition : 0;\r\n\t\tthis.highlightMenu(index);\r\n\t\tthis.eventbus.broadcast('request-video-url', [index, requestedVideoPosition]);\r\n\t\tthis.activeNavigationPoint = this.navVidIdLookup[index];\r\n\t\tthis.pushCurrentState(requestedVideoPosition);\r\n\t}\r\n\r\n\thighlightMenu(index) {\r\n\t\tconst navElm = $(`#nav_${index}`);\r\n\t\tif (navElm.length) {\r\n\t\t\t$('.current-menu-item').removeClass('current-menu-item');\r\n\t\t\tnavElm.addClass('current-menu-item');\r\n\t\t}\r\n\t}\r\n\r\n\thandleVideoComplete(index) {\r\n\t\tconsole.log('Navigation controller received video complete');\r\n\t\tconst navData = this.navVidIdLookup[index];\r\n\t\tif (navData.autoNext) {\r\n\t\t\tconsole.log('NavigationController.handleVideoComplete - request-video-url: ' + navData.next.videoUrlIndex);\r\n\t\t\tthis.eventbus.broadcast('request-video-url', [navData.next.videoUrlIndex]);\r\n\t\t} else {\r\n\t\t\tconsole.log('handleVideoComplete - request-video-cleanup');\r\n\t\t\tthis.eventbus.broadcast('request-video-cleanup');\r\n\t\t}\r\n\t}\r\n\r\n\taddLabel(parentElm, labelId) {\r\n\t\tconst data = {\r\n\t\t\t\tselectedElement: parentElm,\r\n\t\t\t\tlabelId: labelId\r\n\t\t\t};\r\n\t\tconst resultCallback = (instance)=> {\r\n            instance.init(data);\r\n            instance.attach(this.eventbus);\r\n            this.labelControllers.push(instance);\r\n            this.ctrlLookup[labelId] = instance;\r\n\t\t};\r\n\t\tthis.eventbus.broadcast('request-instance', ['LabelController', resultCallback]);\r\n\t}\r\n\r\n\tbuildNavigationData(data) {\r\n\t\tconst result = [];\r\n\t\tdata.navigationData.forEach((nav, index) => {\r\n\t\t\tthis.navLookup[nav.id] = nav;\r\n\t\t\tthis.navVidIdLookup[nav.videoUrlIndex] = nav;\r\n\t\t\tnav.previous = data.navigationData[index - 1];\r\n\t\t});\r\n\r\n\t\tdata.navigationData.forEach((nav, index) => {\r\n\t\t\tif (nav.nextId) {\r\n\t\t\t\tnav.next = this.navLookup[nav.nextId];\r\n\t\t\t\tdelete nav.nextId;\r\n\t\t\t} else {\r\n\t\t\t\tnav.next = data.navigationData[index + 1];\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tdata.roots.forEach((id) => {\r\n\t\t\tconst nav = this.navLookup[id];\r\n\t\t\tif (nav.children) {\r\n\t\t\t\tnav.children = nav.children.map((id) => {\r\n\t\t\t\t\treturn this.navLookup[id];\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tresult.push(nav);\r\n\t\t});\r\n\t\treturn result;\r\n\t}\r\n}\r\n\r\nexport default NavigationController;\r\n","import TimelineEventNames from \"../timeline-event-names\";\r\n\r\nclass ProgressbarController {\r\n\r\n\tconstructor() {\r\n\t\tthis.selectedElement = null;\r\n\t\tthis.textElement = null;\r\n\t\tthis.detachers = [];\r\n\t\tthis.name = \"ProgressbarController\";\r\n\t}\r\n\r\n\tinit(operationData) {\r\n\t\tthis.selectedElement = operationData.selectedElement;\r\n\t\tthis.textElement = operationData.textElement;\r\n\t}\r\n\r\n\tattach(eventbus) {\r\n\t\tconst callBack = (providerId) => {\r\n\t\t\tthis.detachers.push(eventbus.on(TimelineEventNames.POSITION_UPDATE, this.positionUpdateHandler.bind(this), providerId));\r\n\t\t}\r\n\t\teventbus.broadcast(TimelineEventNames.PROVIDERID_REQUEST, [callBack]);\r\n\r\n\t\tconst clickHandler = this.clickHandler.bind(this);\r\n\t\tthis.selectedElement.on(\"click\", clickHandler);\r\n\t\tthis.detachers.push(()=> this.selectedElement.off(\"click\"), clickHandler);\r\n\t}\r\n\r\n\tdetach(eventbus) {\r\n\t\tthis.detacher.forEach((func)=> {\r\n\t\t\tfunc();\r\n\t\t});\r\n\t}\r\n\r\n\tpositionUpdateHandler({position, duration}) {\r\n\t\tlet perc = (100 / duration) * position;\r\n\t\tif (this.selectedElement) {\r\n\t\t\tthis.selectedElement.css(\"width\", `${perc}%`);\r\n\t\t}\r\n\t\tperc = Math.floor(perc);\r\n\t\tif (this.textElement) {\r\n\t\t\tthis.textElement.text(`${perc}%`);\r\n\t\t}\r\n\t}\r\n\r\n\tclickHandler() {\r\n\r\n\t}\r\n}\r\n\r\nexport default ProgressbarController;\r\n","class RoutingController {\r\n\r\n\tconstructor() {\r\n\t\tthis.navLookup = {};\r\n\t\tthis.navVidIdLookup = {};\r\n\t\tthis.playerId = null;\r\n\t\tthis.navigation = null;\r\n\t\tthis.eventhandlers = [];\r\n\t\tthis.eventbus = null;\r\n\t\tthis.name = \"RoutingController\";\r\n\t}\r\n\r\n\tinit(operationData) {\r\n\t\tthis.navigation = this.buildNavigationData(operationData.json);\r\n\t\tthis.playerId = operationData.playerId;\r\n\t}\r\n\r\n\tattach(eventbus) {\r\n\t\tthis.eventhandlers.push(eventbus.on(\"before-request-video-url\", this.handleBeforeRequestVideoUrl.bind(this)));\r\n\t\tthis.eventhandlers.push(eventbus.on(\"push-history-state\", this.handlePushHistoryState.bind(this)));\r\n\t\tthis.eventbus = eventbus;\r\n\t\twindow.onpopstate = this.handlePopstate.bind(this);\r\n\r\n\t\tconst navId = this.getQueryVariable(0);\r\n\t\tif (navId) {\r\n\t\t\tconst nav = this.navLookup[navId];\r\n\t\t\tlet pos = this.getQueryVariable(1);\r\n\t\t\tpos = (pos) ? +pos : 0;\r\n\t\t\tthis.eventbus.broadcast(\"request-video-url\", [nav.videoUrlIndex, pos, true]);\r\n\t\t} else {\r\n\t\t\twindow.history.pushState({ navigationId: this.navigation[0].id },\r\n\t\t\t\t\"\",\r\n\t\t\t\t`#/${this.navigation[0].id}`);\r\n\t\t}\r\n\t}\r\n\r\n\thandlePopstate(event) {\r\n\t\tconst navigationId = (event.state) ? event.state.navigationId : this.navigation[0].id;\r\n\t\tconst position = (event.state) ? event.state.position : 0;\r\n\t\tconst nav = this.navLookup[navigationId];\r\n\t\tthis.eventbus.broadcast(\"highlight-navigation\", [nav.videoUrlIndex]);\r\n\t\tthis.eventbus.broadcast(\"request-video-url\", [nav.videoUrlIndex, position, true]);\r\n\t}\r\n\r\n\tdetach(eventbus) {\r\n\t\tif (this.eventhandlers) {\r\n\t\t\tthis.eventhandlers.forEach((handler) => {\r\n\t\t\t\thandler();\r\n\t\t\t});\r\n\t\t}\r\n\t\tthis.eventbus = null;\r\n\t}\r\n\r\n\thandleBeforeRequestVideoUrl(index, requestedVideoPosition, isHistoryRequest) {\r\n        requestedVideoPosition = (requestedVideoPosition) ? requestedVideoPosition : 0;\r\n        isHistoryRequest = (isHistoryRequest !== undefined) ? isHistoryRequest : false;\r\n\t\tif (!isHistoryRequest) {\r\n            const resultCallback = (item)=> {\r\n                this.pushState(item);\r\n            };\r\n\t\t\tthis.eventbus.broadcast(\"request-current-navigation\", [resultCallback]);\r\n\t\t}\r\n\t}\r\n\r\n\tgetQueryVariable(variableIdx) {\r\n\t\tconst href = window.location.href;\r\n\t\tconst hashIndex = href.indexOf(\"#\");\r\n\t\tif (hashIndex > -1) {\r\n\t\t\tconst query = href.substring(hashIndex + 2);\r\n\t\t\tif (query) {\r\n\t\t\t\tconst vars = query.split(\"/\");\r\n\t\t\t\treturn vars[variableIdx];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\thandlePushHistoryState(state) {\r\n\t\tthis.pushState(state);\r\n\t}\r\n\r\n\tpushState(state) {\r\n\t\tif ((state) && (state.navigationData) && (state.navigationData.visible)) {\r\n\t\t\tlet currentPosition = (state.position !== undefined) ? state.position : -1;\r\n\t\t\tif (currentPosition < 0) {\r\n\t\t\t\tconst resultCallback = (position)=> {\r\n                    currentPosition = (position > 3) ? (position - 3) : 0;\r\n                };\r\n\t\t\t\tthis.eventbus.broadcast(\"request-current-video-position\", [resultCallback]);\r\n\t\t\t}\r\n\r\n\t\t\tconst currentState = window.history.state;\r\n\t\t\tif ((currentState) && (currentState.navigationId !== state.navigationData.id)) {\r\n\t\t\t\twindow.history.pushState({ navigationId: state.navigationData.id, position: currentPosition },\r\n\t\t\t\t\tstate.title,\r\n\t\t\t\t\t`#/${state.navigationData.id}/${currentPosition}`);\r\n\t\t\t} else if ((currentState) && (currentState.navigationId === state.navigationData.id)) {\r\n\t\t\t\twindow.history.replaceState({ navigationId: currentState.navigationId, position: currentPosition },\r\n\t\t\t\t\tstate.title,\r\n\t\t\t\t\t`#/${currentState.navigationId}/${currentPosition}`);\r\n\t\t\t} else {\r\n\t\t\t\twindow.history.pushState({ navigationId: state.navigationData.id, position: currentPosition },\r\n\t\t\t\t\tstate.title,\r\n\t\t\t\t\t`#/${state.navigationData.id}/${currentPosition}`);\r\n\t\t\t}\r\n\t\t\twindow.document.title = state.title;\r\n\t\t}\r\n\t}\r\n\r\n\tbuildNavigationData(data) {\r\n\t\tconst result = [];\r\n\t\tdata.navigationData.forEach((nav, index) => {\r\n\t\t\tthis.navLookup[nav.id] = nav;\r\n\t\t\tthis.navVidIdLookup[nav.videoUrlIndex] = nav;\r\n\t\t\tnav.previous = data.navigationData[index - 1];\r\n\t\t});\r\n\r\n\t\tdata.navigationData.forEach((nav, index) => {\r\n\t\t\tif (nav.nextId) {\r\n\t\t\t\tnav.next = this.navLookup[nav.nextId];\r\n\t\t\t\tdelete nav.nextId;\r\n\t\t\t} else {\r\n\t\t\t\tnav.next = data.navigationData[index + 1];\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tdata.roots.forEach((id) => {\r\n\t\t\tconst nav = this.navLookup[id];\r\n\t\t\tif (nav.children) {\r\n\t\t\t\tnav.children = nav.children.map((id) => {\r\n\t\t\t\t\treturn this.navLookup[id];\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tresult.push(nav);\r\n\t\t});\r\n\t\treturn result;\r\n\t}\r\n\r\n}\r\n\r\nexport default RoutingController;\r\n","import TimelineEventNames from '../timeline-event-names';\r\n\r\nclass SubtitlesController {\r\n\r\n\tconstructor() {\r\n\t\tthis.actionLookup = null;\r\n\t\tthis.currentLanguage = null;\r\n\t\tthis.lastFunc = null;\r\n\t\tthis.name = \"SubtitlesController\";\r\n\t}\r\n\r\n\tattach(eventbus) {\r\n\t\tconst callBack = (providerId) => {\r\n\t\t\tconst detachTime = eventbus.on(TimelineEventNames.TIME, this.onTimeHandler.bind(this), providerId);\r\n\t\t\tconst detachLangChange = eventbus.on(TimelineEventNames.LANGUAGE_CHANGE, this.languageChangeHandler.bind(this));\r\n\t\t\tthis.internalDetach = this.internalDetach.bind(this, [detachTime, detachLangChange]);\r\n\t\t}\r\n\t\teventbus.broadcast(TimelineEventNames.PROVIDERID_REQUEST, [callBack]);\r\n\t}\r\n\r\n\tdetach(eventbus) {\r\n\t\tthis.internalDetach();\r\n\t}\r\n\r\n\tinternalDetach(detachMethods) {\r\n\t\tif (detachMethods) {\r\n\t\t\tdetachMethods.forEach((f) => {\r\n\t\t\t\tf();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tlanguageChangeHandler(newLanguage) {\r\n\t\tthis.currentLanguage = newLanguage;\r\n\t\tif (this.lastFunc) {\r\n\t\t\tthis.lastFunc();\r\n\t\t}\r\n\t}\r\n\r\n\tremoveTitle(container) {\r\n\t\tcontainer.text(\"\");\r\n\t\tthis.lastFunc = null;\r\n\t}\r\n\r\n\tonTimeHandler({ position }) {\r\n\t\tconst func = this.actionLookup[position];\r\n\t\tif (func) {\r\n\t\t\tfunc();\r\n\t\t\tthis.lastFunc = func;\r\n\t\t}\r\n\t}\r\n\r\n\tsetTitle(container, titleLanguageLookup) {\r\n\t\tcontainer.text(titleLanguageLookup[this.currentLanguage]);\r\n\t}\r\n\r\n\tcreateActionLookup(controllerData, container) {\r\n\t\tconst subtitleData = controllerData.subtitleData;\r\n\t\tconst titles = subtitleData[0].titles;\r\n\t\tconst subtitleTimeLookup = {};\r\n\t\tfor (let i = 0, ii = titles.length; i < ii; i++) {\r\n\t\t\tconst titleLanguageLookup = {};\r\n\t\t\tfor (let j = 0, jj = subtitleData.length; j < jj; j++) {\r\n\t\t\t\tconst subs = subtitleData[j];\r\n\t\t\t\ttitleLanguageLookup[subs.lang] = subs.titles[i].text;\r\n\t\t\t}\r\n\t\t\tsubtitleTimeLookup[titles[i].duration.start] = this.setTitle.bind(this, container, titleLanguageLookup);\r\n\t\t\tsubtitleTimeLookup[titles[i].duration.end] = this.removeTitle;\r\n\t\t}\r\n\t\treturn subtitleTimeLookup;\r\n\t}\r\n\r\n\tinit(controllerData) {\r\n\t\tconst container = controllerData.selectedElement;\r\n\t\tthis.removeTitle = this.removeTitle.bind(this, container);\r\n\t\tthis.currentLanguage = controllerData.language;\r\n\t\tthis.actionLookup = this.createActionLookup(controllerData, container);\r\n\t}\r\n}\r\n\r\nexport default SubtitlesController;\r\n","export { default as addClass } from './addClass';\r\nexport { default as addControllerToElement } from './addControllerToElement';\r\nexport { default as addOptionList } from './addOptionList';\r\nexport { default as animate } from './animate';\r\nexport { default as animateWithClass } from './animateWithClass';\r\nexport { default as broadcastEvent } from './broadcastEvent';\r\nexport { default as clearElement } from './clearElement';\r\nexport { default as clearOperationData } from './clearOperationData';\r\nexport { default as customFunction } from './customFunction';\r\nexport { default as endAction } from './endAction';\r\nexport { default as extendController } from './extendController';\r\nexport { default as getControllerFromElement } from './getControllerFromElement';\r\nexport { default as getControllerInstance } from './getControllerInstance';\r\nexport { default as getElementDimensions } from './getElementDimensions';\r\nexport { default as loadJSON } from './loadJSON';\r\nexport { default as removeClass } from './removeClass';\r\nexport { default as removeControllerFromElement } from './removeControllerFromElement';\r\nexport { default as removeElement } from './removeElement';\r\nexport { default as removePropertiesFromOperationData } from './removePropertiesFromOperationData';\r\nexport { default as reparentElement } from './reparentElement';\r\nexport { default as requestAction } from './requestAction';\r\nexport { default as resizeAction } from './resizeAction';\r\nexport { default as selectElement } from './selectElement';\r\nexport { default as setElementAttributes } from './setElementAttributes';\r\nexport { default as setElementContent } from './setElementContent';\r\nexport { default as setOperationData } from './setOperationData';\r\nexport { default as setStyle } from './setStyle';\r\nexport { default as startAction } from './startAction';\r\nexport { default as toggleClass } from './toggleClass';\r\nexport { default as toggleElement } from './toggleElement';\r\nexport { default as wait } from './wait';\r\n","function addClass(operationData, eventBus) {\r\n    const {selectedElement, className} = operationData;\r\n    selectedElement.addClass(className);\r\n    return operationData;\r\n}\r\n\r\nexport default addClass;\r\n","import attachControllerToElement from './helper/attachControllerToElement';\r\nimport internalResolve from './helper/internalResolve';\r\n\r\nfunction addControllerToElement(operationData, eventBus) {\r\n    const {selectedElement, controllerInstance} = operationData;\r\n    \r\n    attachControllerToElement(selectedElement, controllerInstance);\r\n    \r\n    controllerInstance.init(operationData);\r\n\r\n    const promise = controllerInstance.attach(eventBus);\r\n\r\n    if (promise) {\r\n        return new Promise((resolve, reject)=> {\r\n            promise.then((newOperationData) => {\r\n                internalResolve(resolve, operationData, newOperationData);\r\n            }, reject);\r\n        })\r\n    } else {\r\n        return operationData;\r\n    }\r\n}\r\n\r\nexport default addControllerToElement;\r\n","import { getElementControllers } from './getElementData';\r\n\r\nfunction attachControllerToElement(element, controller) {\r\n    if (!element.data('chronoEngineControllers')) {\r\n        element.data('chronoEngineControllers', []);\r\n    }\r\n    const controllers = getElementControllers(element);\r\n    controllers.push(controller);\r\n}\r\n\r\nexport default attachControllerToElement;\r\n","function createOptionElementText(valueProperty, labelProperty, defaultIndex, defaultValue, data, index) {\r\n    let selected = '';\r\n    if (defaultValue) {\r\n        selected = (data[valueProperty] === defaultValue) ? ' selected' : '';\r\n    } else if (defaultIndex) {\r\n        selected = (index === defaultIndex) ? ' selected' : '';\r\n    }\r\n    return `<option value='${data[valueProperty]}'${selected}>${data[labelProperty]}</option>`;\r\n}\r\n\r\nfunction addOptionList(operationData, eventBus) {\r\n    const { valueProperty, labelProperty, defaultIndex, defaultValue, optionData, selectedElement } = operationData;\r\n\r\n    const createOption = createOptionElementText.bind(null, valueProperty, labelProperty, defaultIndex, defaultValue);\r\n\r\n    const optionElements = optionData.map(createOption);\r\n\r\n    selectedElement.html(optionElements);\r\n\r\n    return operationData;\r\n}\r\n\r\nexport default addOptionList;\r\n","import internalResolve from './helper/internalResolve';\r\n\r\nfunction animate(operationData, eventBus) {\r\n    const {animationEasing, selectedElement, animationProperties, animationDuration} = operationData;\r\n    const promise = new Promise((resolve, reject)=> {\r\n        try{\r\n            if (animationEasing) {\r\n                selectedElement.animate(animationProperties,\r\n                    animationDuration,\r\n                    animationEasing,\r\n                    () => {\r\n                        internalResolve(resolve, {}, operationData);\r\n                    });\r\n            } else {\r\n                selectedElement.animate(animationProperties,\r\n                    animationDuration,\r\n                    () => {\r\n                        internalResolve(resolve, {}, operationData);\r\n                    });\r\n            }\r\n        } catch(e){\r\n            reject(e);\r\n        }\r\n    });\r\n    return promise;\r\n}\r\n\r\nexport default animate;\r\n","import internalResolve from './helper/internalResolve';\r\n\r\nfunction animateWithClass(operationData, eventBus) {\r\n    let {selectedElement, className, removeClass } = operationData;\r\n    removeClass = (removeClass !== undefined) ? removeClass : true;\r\n\r\n    const promise = new Promise((resolve, reject)=> {\r\n        try{\r\n            selectedElement.one(\"webkitAnimationEnd oanimationend oAnimationEnd msAnimationEnd animationEnd\",\r\n            () => {\r\n                if (removeClass) {\r\n                    selectedElement.removeClass(className);\r\n                }\r\n                internalResolve(resolve, {}, operationData);\r\n            });\r\n        } catch(e){\r\n            reject(e);\r\n        }\r\n    });\r\n\r\n    selectedElement.addClass(className);\r\n\r\n    return promise;\r\n}\r\n\r\nexport default animateWithClass;\r\n","import resolveEventArguments from './helper/resolveEventArguments';\r\nimport removeEventDataFromOperationData from './helper/removeEventDataFromOperationData';\r\n\r\nfunction broadcastEvent(operationData, eventBus) {\r\n    const {eventArgs, eventTopic, eventName} = operationData;\r\n\r\n    const eventArguments = resolveEventArguments(operationData, eventArgs);\r\n    \r\n    if (eventTopic) {\r\n        eventBus.broadcastForTopic(eventName, eventTopic, eventArguments);\r\n    } else {\r\n        eventBus.broadcast(eventName, eventArguments);\r\n    }\r\n\r\n    removeEventDataFromOperationData(operationData);\r\n}\r\n\r\nexport default broadcastEvent;\r\n","import extractOperationDataArgumentValues from './extractOperationDataArgumentValues';\r\n\r\nfunction resolveEventArguments(operationData, eventArgs) {\r\n    if (!eventArgs) {\r\n        return;\r\n    }\r\n    const extract = extractOperationDataArgumentValues.bind(null, operationData);\r\n    return eventArgs.map(extract);\r\n}\r\n\r\nexport default resolveEventArguments;\r\n","function removeEventDataFromOperationData(operationData) {\r\n    delete operationData.eventName;\r\n    delete operationData.eventTopic;\r\n    delete operationData.eventArgs;\r\n}\r\n\r\nexport default removeEventDataFromOperationData;\r\n","function clearElement(operationData, eventBus) {\r\n    const {selectedElement} = operationData;\r\n    selectedElement.empty();\r\n    return operationData;\r\n}\r\n\r\nexport default clearElement;\r\n","function clearOperationData(operationData, eventBus) {\r\n    return {};\r\n}\r\n\r\nexport default clearOperationData;\r\n","import internalResolve from './helper/internalResolve';\r\nimport TimelineEventNames from '../timeline-event-names';\r\n\r\nfunction customFunction(operationData, eventBus) {\r\n    const {systemName} = operationData;\r\n    return new Promise((resolve, reject) => {\r\n        const resultCallback = (func)=> {\r\n            const promise = func(operationData, eventBus);\r\n            if (promise) {\r\n                promise.then(() => {\r\n                    internalResolve(resolve, {}, operationData);\r\n                }, reject);\r\n            } else {\r\n                internalResolve(resolve, {}, operationData);\r\n            }\r\n        };\r\n        eventBus.broadcast(TimelineEventNames.REQUEST_FUNCTION, [systemName, resultCallback]);\r\n    });\r\n}\r\n\r\nexport default customFunction;\r\n","import mergeOperationData from './helper/mergeOperationData';\r\nimport internalResolve from './helper/internalResolve';\r\n\r\nfunction endAction(operationData, eventBus) {\r\n    const {actionInstance, actionOperationData} = operationData;\r\n    delete operationData.actionOperationData;\r\n    return new Promise((resolve, reject)=> {\r\n        const mergedData = mergeOperationData(operationData, actionOperationData);\r\n        actionInstance.end(mergedData).then(() => {\r\n            internalResolve(resolve, operationData);\r\n        }, reject);\r\n    });\r\n}\r\n\r\nexport default endAction;\r\n","function extendController(operationData, eventBus) {\r\n    const { controllerInstance, controllerExtension } = operationData;\r\n    \r\n    operationData.controllerInstance = Object.assign(controllerInstance, controllerExtension);\r\n    \r\n    return operationData;\r\n}\r\n\r\nexport default extendController;\r\n","import { getElementControllers } from './helper/getElementData';\r\n\r\nfunction getControllerFromElement(operationData, eventBus) {\r\n    const {selectedElement, controllerName} = operationData;\r\n    const controllers = getElementControllers(selectedElement);\r\n    let controller = null;\r\n    controllers.some((ctrl) => {\r\n        if (ctrl.name === controllerName) {\r\n            controller = ctrl;\r\n            return true;\r\n        }\r\n        return false;\r\n    });\r\n    if (!controller) {\r\n        console.warn(`controller for name '${controllerName}' was not found on the given element`);\r\n    }\r\n    operationData.controllerInstance = controller;\r\n    return operationData;\r\n}\r\n\r\nexport default getControllerFromElement;\r\n","import TimelineEventNames from '../timeline-event-names';\r\n\r\nfunction getControllerInstance(operationData, eventBus) {\r\n    const {systemName} = operationData;\r\n    let {propertyName} = operationData;\r\n    \r\n    propertyName = propertyName || \"controllerInstance\";\r\n    const resultCallback = (instance)=> {\r\n        operationData[propertyName] = instance;\r\n    }\r\n    eventBus.broadcast(TimelineEventNames.REQUEST_INSTANCE, [systemName, resultCallback]);\r\n    return operationData;\r\n}\r\n\r\nexport default getControllerInstance;\r\n","import modifyDimensions from './helper/modifyDimensions';\r\n\r\nfunction getElementDimensions(operationData, eventBus) {\r\n    let {selectedElement, dimensions, modifier} = operationData;\r\n    dimensions = dimensions || {};\r\n    dimensions.width = selectedElement.innerWidth();\r\n    dimensions.height = selectedElement.innerHeight();\r\n    if (dimensions.height === 0) {\r\n        dimensions.height = dimensions.width;\r\n    }\r\n    if (modifier) {\r\n        modifyDimensions(dimensions, modifier);\r\n    }\r\n    operationData.dimensions = dimensions;\r\n    return operationData;\r\n}\r\n\r\nexport default getElementDimensions;\r\n","function modifyDimensionsByRatio(ratioModifier, dimensions) {\r\n    //h[ar=8-1]\r\n    let prefix = ratioModifier.substr(0, 1);\r\n    let ratio = ratioModifier.substr(ratioModifier.indexOf('[') + 1, ratioModifier.indexOf(']') - ratioModifier.indexOf('[') - 1);\r\n    let ratios = ratio.split('=')[1].split('-');\r\n    if (prefix === 'h') {\r\n        dimensions.height = (dimensions.width / +ratios[0]) * +ratios[1];\r\n    } else if (prefix === 'w') {\r\n        dimensions.width = (dimensions.height / +ratios[1]) * +ratios[0];\r\n    }\r\n}\r\n\r\nfunction getModifierSuffix(modifier) {\r\n    let endIdx = 1;\r\n    let suffix = modifier.substr(modifier.length - 1, 1);\r\n    if ((suffix !== 'h') && (suffix !== 'w') && (suffix !== '%')) {\r\n        suffix = null;\r\n    }\r\n    const isPercent = (suffix === '%');\r\n    if (isPercent) {\r\n        endIdx = 2;\r\n        suffix = modifier.substr(modifier.length - endIdx, 1);\r\n        if ((suffix !== 'h') && (suffix !== 'w')) {\r\n            suffix = null;\r\n            endIdx = 1;\r\n        }\r\n    }\r\n    return [suffix, endIdx, isPercent];\r\n}\r\n\r\nfunction _modifyDimensions(dimensions, prefix, suffix, widthModifier, heightModifier) {\r\n    switch (prefix) {\r\n        case '+':\r\n            switch (suffix) {\r\n                case 'h':\r\n                    dimensions.height += heightModifier;\r\n                    break;\r\n                case 'w':\r\n                    dimensions.width += widthModifier;\r\n                    break;\r\n                default:\r\n                    dimensions.height += heightModifier;\r\n                    dimensions.width += widthModifier;\r\n            }\r\n            break;\r\n        case '-':\r\n            switch (suffix) {\r\n                case 'h':\r\n                    dimensions.height -= heightModifier;\r\n                    break;\r\n                case 'w':\r\n                    dimensions.width -= widthModifier;\r\n                    break;\r\n                default:\r\n                    dimensions.height -= heightModifier;\r\n                    dimensions.width -= widthModifier;\r\n            }\r\n            break;\r\n        case '/':\r\n            switch (suffix) {\r\n                case 'h':\r\n                    dimensions.height /= heightModifier;\r\n                    break;\r\n                case 'w':\r\n                    dimensions.width /= widthModifier;\r\n                    break;\r\n                default:\r\n                    dimensions.height /= heightModifier;\r\n                    dimensions.width /= widthModifier;\r\n            }\r\n            break;\r\n        case '*':\r\n            switch (suffix) {\r\n                case 'h':\r\n                    dimensions.height *= heightModifier;\r\n                    break;\r\n                case 'w':\r\n                    dimensions.width *= widthModifier;\r\n                    break;\r\n                default:\r\n                    dimensions.height *= heightModifier;\r\n                    dimensions.width *= widthModifier;\r\n            }\r\n            break;\r\n        default:\r\n            console.error(`Unknown operator found: ${prefix}`);\r\n    }\r\n    return dimensions;\r\n}\r\n\r\nfunction modifyDimensions(dimensions, modifier) {\r\n    let ratioModifier = null;\r\n    if (modifier.indexOf('|') > -1) {\r\n        [modifier, ratioModifier] = modifier.split('|');\r\n    }\r\n\r\n    const prefix = modifier.substr(0, 1);\r\n    let [suffix, endIdx, isPercent] = getModifierSuffix(modifier);\r\n\r\n    const value = parseInt((suffix !== null) ? modifier.substr(1, modifier.length - endIdx - 1) : modifier.substr(1, modifier.length), 10);\r\n\r\n    let widthModifier = value;\r\n    let heightModifier = value;\r\n    if (isPercent) {\r\n        widthModifier = (dimensions.width / 100) * value;\r\n        heightModifier = (dimensions.height / 100) * value;\r\n    }\r\n\r\n    dimensions = _modifyDimensions(dimensions, prefix, suffix, widthModifier, heightModifier);\r\n\r\n    if (ratioModifier) {\r\n        modifyDimensionsByRatio(ratioModifier, dimensions)\r\n    }\r\n}\r\n\r\nexport default modifyDimensions;","function loadJSON(jsonCache, operationData, eventBus) {\r\n    const {url, cache} = operationData;\r\n\r\n    let { propertyName } = operationData;\r\n    propertyName = propertyName || \"json\";\r\n\r\n    if (cache && jsonCache[url]) {\r\n        operationData[propertyName] = jsonCache[url];\r\n        return operationData;\r\n    }\r\n\r\n\r\n    return new Promise((resolve, reject)=> {\r\n        fetch(url)\r\n        .then((response)=> {\r\n            jsonCache[url] = operationData[propertyName] = response.body;\r\n            resolve(operationData);\r\n        })\r\n        .catch(reject);\r\n    });\r\n}\r\n\r\nexport default loadJSON.bind(null, {});\r\n","function removeClass(operationData, eventBus) {\r\n    const {selectedElement, className} = operationData;\r\n    selectedElement.removeClass(className);\r\n    return operationData;\r\n}\r\n\r\nexport default removeClass;\r\n","import {getElementControllers} from './helper/getElementData';\r\n\r\nfunction removeControllerFromElement(operationData, eventBus) {\r\n    const {selectedElement, controllerName} = operationData;\r\n\r\n    const controllers = getElementControllers(selectedElement);\r\n    if (controllers) {\r\n        let controller = null;\r\n        controllers.some((ctrl) => {\r\n            if (ctrl.name === controllerName) {\r\n                controller = ctrl;\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n        if (controller) {\r\n            const idx = controllers.indexOf(controller);\r\n            if (idx > -1) {\r\n                controllers.splice(idx, 1);\r\n            }\r\n            controller.detach(eventBus);\r\n        }\r\n    }\r\n    return operationData;\r\n}\r\n\r\nexport default removeControllerFromElement;\r\n","export function removeElement(operationData, eventBus) {\r\n    operationData.selectedElement.remove();\r\n    return operationData;\r\n}\r\n\r\nexport default removeElement;\r\n","function removePropertiesFromOperationData(operationData, eventBus) {\r\n    const {\r\n        propertyNames\r\n    } = operationData;\r\n\r\n    propertyNames.forEach(name => {\r\n        delete operationData[name];\r\n    });\r\n    delete operationData.propertyNames;\r\n    return operationData;\r\n}\r\n\r\nexport default removePropertiesFromOperationData;","function reparentElement(operationData, eventBus) {\r\n    const {selectedElement, newParentSelector} = operationData;\r\n    selectedElement.remove().appendTo(newParentSelector);\r\n}\r\n\r\nexport default reparentElement;\r\n","import TimelineEventNames from '../timeline-event-names';\r\n\r\nfunction requestAction(operationData, eventBus) {\r\n        const { actionName } = operationData;\r\n\r\n        const resultCallback = (action) => {\r\n            operationData.actionInstance = action;\r\n        };\r\n        eventBus.broadcast(TimelineEventNames.REQUEST_ACTION, [actionName, resultCallback]);\r\n        return operationData;\r\n}\r\n\r\nexport default requestAction;\r\n","import mergeOperationData from './helper/mergeOperationData';\r\n\r\nfunction resizeAction(operationData, eventBus) {\r\n    const {actionInstance, actionOperationData} = operationData;\r\n    operationData = mergeOperationData(operationData, actionOperationData);\r\n    if (actionInstance.resize) {\r\n        return actionInstance.resize(operationData);\r\n    }\r\n    return operationData;\r\n}\r\n\r\nexport default resizeAction;\r\n","import TimelineEventNames from '../timeline-event-names';\r\n\r\nfunction findElementBySelector(root, selector, operationData, propertyName) {\r\n    const element = root.find(selector);\r\n    if (!element.length) {\r\n        console.warn(`selector '${selector}' wasn't found!`);\r\n    }\r\n    operationData[propertyName] = element;\r\n    if (operationData.hasOwnProperty(\"propertyName\")) {\r\n        delete operationData.propertyName;\r\n    }\r\n}\r\n\r\nfunction selectElement(operationData, eventBus) {\r\n    let {selector, propertyName, useExistingAsRoot} = operationData;\r\n\r\n    if (!selector) {\r\n        throw new Error(\"selector is undefined!\");\r\n    }\r\n    propertyName = (propertyName) ? propertyName : \"selectedElement\";\r\n\r\n    if (useExistingAsRoot && operationData[propertyName]) {\r\n        const currentRoot = operationData[propertyName];\r\n        findElementBySelector(currentRoot, selector, operationData, propertyName);\r\n        return operationData;\r\n    }\r\n\r\n    const rootCallback = (root)=> {\r\n        findElementBySelector(root, selector, operationData, propertyName);\r\n    };\r\n    eventBus.broadcast(TimelineEventNames.REQUEST_ENGINE_ROOT, [rootCallback]);\r\n    return operationData;\r\n}\r\n\r\nexport default selectElement;\r\n","function setElementAttributes(operationData, eventBus) {\r\n    const {attributes, selectedElement} = operationData;\r\n    for (let attrName in attributes) {\r\n        if (attributes.hasOwnProperty(attrName)) {\r\n            selectedElement.attr(attrName, attributes[attrName]);\r\n        }\r\n    }\r\n    return operationData;\r\n}\r\n\r\nexport default setElementAttributes;\r\n","function setElementContent(operationData, eventBus) {\r\n    const {append, selectedElement, template} = operationData;\r\n    if (!append) {\r\n        selectedElement.html(template);\r\n    } else {\r\n        selectedElement.append(template);\r\n    }\r\n    return operationData;\r\n}\r\n\r\nexport default setElementContent;\r\n","import resolvePropertyValues from './helper/resolvePropertyValues';\r\n\r\nfunction setOperationData(operationData, eventBus) {\r\n    const properties = resolvePropertyValues(operationData, operationData.properties);\r\n    operationData = Object.assign(operationData, properties);\r\n    delete operationData.properties;\r\n    return operationData;\r\n}\r\n\r\nexport default setOperationData;\r\n","import resolvePropertyValues from './helper/resolvePropertyValues';\r\n\r\nfunction setStyle(operationData, eventBus) {\r\n    const properties = resolvePropertyValues(operationData, operationData.properties);\r\n    operationData.selectedElement.css(properties);\r\n    return operationData;\r\n}\r\n\r\nexport default setStyle;\r\n","import mergeOperationData from './helper/mergeOperationData';\r\nimport internalResolve from './helper/internalResolve';\r\n\r\nfunction startAction(operationData, eventBus) {\r\n    const {actionInstance, actionOperationData} = operationData;\r\n    return new Promise((resolve, reject)=> {\r\n        operationData = mergeOperationData(operationData, actionOperationData);\r\n        actionInstance.start(operationData).then(() => {\r\n            internalResolve(resolve, operationData);\r\n        }, reject);\r\n    });\r\n}\r\n\r\nexport default startAction;\r\n","function toggleClass(operationData, eventBus) {\r\n    const {selectedElement, className} = operationData;\r\n    selectedElement.toggleClass(className);\r\n    return operationData;\r\n}\r\n\r\nexport default toggleClass;\r\n","function toggleElement(operationData, eventBus) {\r\n    operationData.selectedElement.toggle();\r\n    return operationData;\r\n}\r\n\r\nexport default toggleElement;\r\n","import internalResolve from './helper/internalResolve';\r\n\r\nfunction wait(operationData, eventBus) {\r\n    const { milliseconds } = operationData;\r\n    return new Promise((resolve) => {\r\n        setTimeout(() => {\r\n            internalResolve(resolve, operationData);\r\n        }, milliseconds);\r\n    });\r\n}\r\n\r\nexport default wait;\r\n","export { default as JwPlayerTimelineProvider } from './jwplayer-timeline-provider';\r\n// export { default as MediaElementTimelineProvider} from './mediaelement-timeline-provider';\r\nexport { default as RequestAnimationFrameTimelineProvider } from './request-animation-frame-timeline-provider';\r\n","import $ from 'jquery';\r\nimport TimelineEventNames from '../timeline-event-names';\r\n\r\nclass JwPlayerTimelineProvider {\r\n\r\n   constructor(eventbus, config) {\r\n        this.eventbus = eventbus;\r\n        this.config = config;\r\n        this.providerid = config.playerSettings.selector;\r\n        this.loop = false;\r\n        this.player = null;\r\n        this.currentLoopHandler = null;\r\n        this._eventbusListeners = [];\r\n        this._addEventListeners();\r\n    }\r\n\r\n    _extractUrls(configuration) {\r\n        const urls = configuration.timelines.filter(timeline => timeline.type === \"video\").map(timeline => {\r\n            return timeline.uri;\r\n        });\r\n        return urls;\r\n    }\r\n\r\n    init(selector) {\r\n        const urls = this._extractUrls(this.config);\r\n        const jwp = window.jwplayer;\r\n        const p = $(`#${selector}`);\r\n        if (!p.length) {\r\n            throw new Error(`videoplayer selector '${selector}' not found`);\r\n        }\r\n        let w = p.innerWidth();\r\n        let h = p.innerHeight();\r\n        if (w === 0) {\r\n            w = 100;\r\n        }\r\n        if (h === 0) {\r\n            h = 300;\r\n        }\r\n\r\n        this.player = jwp(this.config.playerSettings.selector);\r\n        this.player.setup({\r\n            file: urls[0],\r\n            image: this.config.playerSettings.poster,\r\n            height: h,\r\n            width: w,\r\n            controls: true,\r\n            autostart: false,\r\n            displaytitle: false,\r\n            displaydescription: false,\r\n            nextUpDisplay: false,\r\n            abouttext: 'Rosetta Group',\r\n            aboutlink: 'http://www.rosettagroup.nl',\r\n            stretching: \"fill\",\r\n            repeat: false\r\n        });\r\n        const playlist = [];\r\n        urls.forEach((url) => {\r\n            playlist.push({\r\n                file: url,\r\n                title: url,\r\n                image: this.config.playerSettings.poster\r\n            });\r\n        });\r\n        const promise = new Promise((resolve, reject) => {\r\n            this.player.once(\"ready\", () => {\r\n                this._handlePlayerReady(resolve);\r\n            });\r\n            this.player.load(playlist);\r\n        });\r\n        return promise;\r\n    }\r\n\r\n    _handlePlayerReady(resolve) {\r\n        this.player.once(\"firstFrame\", () => {\r\n            this.player.pause();\r\n            this.eventbus.broadcastForTopic(TimelineEventNames.DURATION, this.player.playerid, [this.getDuration()]);\r\n            resolve(this);\r\n        });\r\n        this.player.on(TimelineEventNames.TIME, this._loopHandler.bind(this, Math.floor));\r\n        this.player.on(TimelineEventNames.SEEKED, this._seekedHandler.bind(this));\r\n        this.player.on(TimelineEventNames.COMPLETE, this._handlePlayerComplete.bind(this));\r\n        setTimeout(()=> {\r\n            this.player.play();\r\n        },10);\r\n    }\r\n\r\n    _handlePlayerComplete() {\r\n        if (!this.loop) {\r\n            this.stop();\r\n            this.eventbus.broadcastForTopic(TimelineEventNames.COMPLETE, this.providerid, [this.player.getPlaylistIndex()]);\r\n        }\r\n    }\r\n\r\n    _seekedHandler() {\r\n        this.eventbus.broadcastForTopic(TimelineEventNames.SEEKED, this.providerid, [this.getPosition(), this.getDuration()]);\r\n    }\r\n\r\n    destroy() {\r\n        this.player.remove();\r\n        this._eventbusListeners.forEach(func => func());\r\n    }\r\n\r\n    _loopHandler(floor, event) {\r\n        const pos = floor(event.position);\r\n        if ((this.loop) && (pos === floor(this.player.getDuration() - 1))) {\r\n            this.seek(0);\r\n        }\r\n    }\r\n\r\n    _timeResetLoopHandler(event) {\r\n        if (this.loop) {\r\n            this.seek(0);\r\n        }\r\n    }\r\n\r\n    _addEventListeners() {\r\n        this._eventbusListeners.push(this.eventbus.on(TimelineEventNames.PLAY_TOGGLE_REQUEST, this.toggleplay.bind(this), this.providerid));\r\n        this._eventbusListeners.push(this.eventbus.on(TimelineEventNames.PLAY_REQUEST, this.play.bind(this), this.providerid));\r\n        this._eventbusListeners.push(this.eventbus.on(TimelineEventNames.STOP_REQUEST, this.stop.bind(this), this.providerid));\r\n        this._eventbusListeners.push(this.eventbus.on(TimelineEventNames.PAUSE_REQUEST, this.pause.bind(this), this.providerid));\r\n        this._eventbusListeners.push(this.eventbus.on(TimelineEventNames.SEEK_REQUEST, this.seek.bind(this), this.providerid));\r\n        this._eventbusListeners.push(this.eventbus.on(TimelineEventNames.RESIZE_REQUEST, this.resize.bind(this), this.providerid));\r\n        this._eventbusListeners.push(this.eventbus.on(TimelineEventNames.CONTAINER_REQUEST, this._container.bind(this), this.providerid));\r\n        this._eventbusListeners.push(this.eventbus.on(TimelineEventNames.DURATION_REQUEST, this.duration.bind(this), this.providerid));\r\n    }\r\n\r\n    _container(resultCallback) {\r\n        let suffix = \"\";\r\n        if (this.player.getProvider().name !== \"html5\") {\r\n            suffix = \"_wrapper\";\r\n        }\r\n        const container = $(`#${this.providerid}${suffix}`);\r\n        resultCallback(container);\r\n    }\r\n\r\n    toggleplay() {\r\n        if (this.paused) {\r\n            this.play()\r\n        } else {\r\n            this.pause();\r\n        }\r\n    }\r\n\r\n    play() {\r\n        this.paused = false;\r\n        this.player.play();\r\n        this.eventbus.broadcastForTopic(TimelineEventNames.PLAY, this.providerid);\r\n    }\r\n\r\n    stop() {\r\n        this.paused = false;\r\n        this.player.stop();\r\n        this.eventbus.broadcastForTopic(TimelineEventNames.STOP, this.providerid);\r\n    }\r\n\r\n    pause() {\r\n        this.paused = true;\r\n        this.player.pause();\r\n        this.eventbus.broadcastForTopic(TimelineEventNames.PAUSE, this.providerid);\r\n    }\r\n\r\n    seek(position) {\r\n        const currentPosition = this.player.getPosition();\r\n        this.player.seek(position);\r\n        this.eventbus.broadcastForTopic(TimelineEventNames.SEEK, this.providerid, [position, currentPosition, this.player.getDuration()]);\r\n    }\r\n\r\n    resize(width, height) {\r\n        this.player.resize(width, height);\r\n        this.eventbus.broadcastForTopic(TimelineEventNames.RESIZE, this.providerid, [width, height]);\r\n    }\r\n\r\n    duration(resultCallback) {\r\n        resultCallback(Math.floor(this.getDuration()));\r\n    }\r\n\r\n    playlistItem(index) {\r\n        this.player.playlistItem(index);\r\n    }\r\n\r\n    once(eventName, callback) {\r\n        this.player.once(eventName, callback);\r\n    }\r\n\r\n    off(eventName, callback) {\r\n        this.player.off(eventName, callback);\r\n    }\r\n\r\n    on(eventName, callback) {\r\n        this.player.on(eventName, callback);\r\n    }\r\n\r\n    getPosition() {\r\n        return this.player.getPosition();\r\n    }\r\n\r\n    getPlaylistIndex() {\r\n        return this.player.getPlaylistIndex();\r\n    }\r\n\r\n    getState() {\r\n        return this.player.getState();\r\n    }\r\n\r\n    getDuration() {\r\n        return this.player.getDuration();\r\n    }\r\n\r\n    getMute() {\r\n        return this.player.getMute();\r\n    }\r\n\r\n    getVolume() {\r\n        return this.player.getVolume();\r\n    }\r\n\r\n    setMute(state) {\r\n        this.player.setMute(state);\r\n    }\r\n\r\n    setVolume(volume) {\r\n        this.player.setVolume(volume);\r\n    }\r\n}\r\n\r\nexport default JwPlayerTimelineProvider;\r\n","import $ from 'jquery';\r\nimport TimelineEventNames from '../timeline-event-names';\r\n\r\nclass RequestAnimationFrameTimelineProvider {\r\n\r\n    constructor(eventbus, config) {\r\n        this.eventbus = eventbus;\r\n        this.config = config;\r\n        this.requestID = null;\r\n        this.last = 0;\r\n        this.current = 0;\r\n        this._updateBound = this._update.bind(this);\r\n        this.loop = false;\r\n        this._eventbusListeners = [];\r\n        this.providerid = `provider${Math.random()*1000}`;\r\n        this._addEventListeners();\r\n        this.playlist = [];\r\n        this.currentPlaylistItem = null;\r\n        this.firstFrame = true;\r\n        this.playing = false;\r\n        this.paused = false;\r\n    }\r\n\r\n    _extractPlaylist(configuration) {\r\n        const playlist = configuration.timelines.filter(timeline => timeline.type === \"animation\").map(timeline => {\r\n            return timeline;\r\n        });\r\n        return playlist;\r\n    }\r\n\r\n    playlistItem(index) {\r\n        if (index < 0 || index > this.playlist.length) {\r\n            return;\r\n        }\r\n        this.currentPlaylistItem = this.playlist[index];\r\n        this.firstFrame = true;\r\n        this.reset();\r\n    }\r\n\r\n    _addEventListeners() {\r\n        this._eventbusListeners.push(this.eventbus.on(TimelineEventNames.PLAY_TOGGLE_REQUEST, this.toggleplay.bind(this), this.providerid));\r\n        this._eventbusListeners.push(this.eventbus.on(TimelineEventNames.PLAY_REQUEST, this.play.bind(this), this.providerid));\r\n        this._eventbusListeners.push(this.eventbus.on(TimelineEventNames.STOP_REQUEST, this.stop.bind(this), this.providerid));\r\n        this._eventbusListeners.push(this.eventbus.on(TimelineEventNames.PAUSE_REQUEST, this.pause.bind(this), this.providerid));\r\n        this._eventbusListeners.push(this.eventbus.on(TimelineEventNames.SEEK_REQUEST, this.seek.bind(this), this.providerid));\r\n        this._eventbusListeners.push(this.eventbus.on(TimelineEventNames.RESIZE_REQUEST, this._resize.bind(this), this.providerid));\r\n        this._eventbusListeners.push(this.eventbus.on(TimelineEventNames.CONTAINER_REQUEST, this._container.bind(this), this.providerid));\r\n        this._eventbusListeners.push(this.eventbus.on(TimelineEventNames.DURATION_REQUEST, this.requestDurationHandler.bind(this), this.providerid));\r\n        this._eventbusListeners.push(this.eventbus.on(TimelineEventNames.PROVIDERID_REQUEST, this.requestProviderIdHandler.bind(this)));\r\n    }\r\n\r\n    _update(now) {\r\n        if (!this.playing) {\r\n            return;\r\n        }\r\n        if(!this.last || now - this.last >= 1000) {\r\n            if (!this.last && this.firstFrame) {\r\n                this.firstFrame = false;\r\n                this.eventbus.broadcastForTopic(TimelineEventNames.FIRSTFRAME, this.providerid);\r\n            }\r\n            this.last = now;\r\n            this.current++;\r\n            if (this.current > this.currentPlaylistItem.duration) {\r\n                if (this.loop) {\r\n                    this._reset();\r\n                } else {\r\n                    this.stop();\r\n                    this.eventbus.broadcastForTopic(TimelineEventNames.COMPLETE, this.providerid);\r\n                    return;\r\n                }\r\n            }\r\n            this.eventbus.broadcastForTopic(TimelineEventNames.TIME, this.providerid, [{position: this.current}]);\r\n            this.eventbus.broadcastForTopic(TimelineEventNames.POSITION_UPDATE, this.providerid, [{position: this.current, duration: this.currentPlaylistItem.duration}]);\r\n        }\r\n        this.requestID = requestAnimationFrame(this._updateBound);\r\n    }\r\n\r\n    _start() {\r\n        if (this.requestID && this.playing) {\r\n            return;\r\n        }\r\n        this.requestID = requestAnimationFrame(this._updateBound)\r\n    }\r\n\r\n    _reset() {\r\n        this._cancelAnimationFrame();\r\n        this.last = 0;\r\n        this.current = 0;\r\n    }\r\n\r\n    _resize() {\r\n        console.error('Not implemented yet');\r\n    }\r\n\r\n    _container(callBack) {\r\n        callBack(this.container);\r\n    }\r\n\r\n    _cancelAnimationFrame() {\r\n        if (this.requestID) {\r\n            cancelAnimationFrame(this.requestID);\r\n            this.requestID =  null;\r\n            this.last = 0;\r\n            this.current = 0;\r\n        }\r\n    }\r\n\r\n    init() {\r\n        this.playlist = this._extractPlaylist(this.config);\r\n        this.currentPlaylistItem = this.playlist[0];\r\n        this.container = $(this.currentPlaylistItem.selector);\r\n        if (!this.container.length) {\r\n            throw new Error(`timeline selector '${selector}' not found`);\r\n        }\r\n        const promise = new Promise((resolve) => {\r\n            resolve();\r\n        });\r\n        return promise;\r\n\r\n    }\r\n\r\n    destroy() {\r\n        this.stop();\r\n        this._eventbusListeners.forEach(func => func());\r\n    }\r\n\r\n    toggleplay() {\r\n        if (!this.playing) {\r\n            this.play();\r\n        } else {\r\n            this.pause();\r\n        }\r\n    }\r\n\r\n    play(){\r\n        this._start();\r\n        this.playing = true;\r\n        this.paused = false;\r\n        this.eventbus.broadcastForTopic(TimelineEventNames.PLAY, this.providerid);\r\n    }\r\n\r\n    stop() {\r\n        this._cancelAnimationFrame();\r\n        this.playing = false;\r\n        this.paused = false;\r\n        this.eventbus.broadcastForTopic(TimelineEventNames.STOP, this.providerid);\r\n    }\r\n\r\n    pause() {\r\n        this.playing = false;\r\n        this.paused = true;\r\n        this.eventbus.broadcastForTopic(TimelineEventNames.PAUSE, this.providerid);\r\n    }\r\n\r\n    seek(position) {\r\n        if (position < 0 || position > this.currentPlaylistItem.duration) {\r\n            return;\r\n        }\r\n        this.eventbus.broadcastForTopic(TimelineEventNames.SEEK, this.providerid);\r\n        this.current = position;\r\n        this.eventbus.broadcastForTopic(TimelineEventNames.SEEKED, this.providerid);\r\n    }\r\n\r\n    getPosition() {\r\n        return this.current;\r\n    }\r\n\r\n    getDuration() {\r\n        return this.currentPlaylistItem.duration;\r\n    }\r\n\r\n    requestDurationHandler(callBack) {\r\n        callBack(this.currentPlaylistItem.duration);\r\n    }\r\n\r\n    requestProviderIdHandler(callBack) {\r\n        callBack(this.providerid);\r\n    }\r\n\r\n    on(eventName, handler) {\r\n        return this.eventbus.on(eventName, handler, this.providerid);\r\n    }\r\n\r\n    once(eventName, handler) {\r\n        return this.eventbus.once(eventName, handler, this.providerid);\r\n    }\r\n}\r\n\r\nexport default RequestAnimationFrameTimelineProvider;\r\n"],"sourceRoot":""}