{"version":3,"sources":["webpack://library/webpack/universalModuleDefinition","webpack://library/webpack/bootstrap","webpack://library/./src/timeline-event-names.js","webpack://library/./src/operation/helper/internalResolve.js","webpack://library/external {\"amd\":\"jquery\",\"global\":\"jQuery\",\"commonjs\":\"jquery\",\"commonjs2\":\"jquery\"}","webpack://library/./src/operation/helper/mergeOperationData.js","webpack://library/./src/operation/helper/deepcopy.js","webpack://library/./src/operation/helper/getElementData.js","webpack://library/./src/index.js","webpack://library/./src/action/index.js","webpack://library/./src/action/action.js","webpack://library/./src/action/endableaction.js","webpack://library/./src/configuration/configuration-resolver.js","webpack://library/./src/operation/helper/getNestedValue.js","webpack://library/./src/language-manager.js","webpack://library/./src/eventbus/eventbus.js","webpack://library/./src/operation/helper/extractOperationDataArgumentValues.js","webpack://library/./src/operation/helper/resolvePropertyValues.js","webpack://library/./src/action/timelineaction.js","webpack://library/./src/operation/helper/getNestedPropertyValue.js","webpack://library/./src/chrono-trigger-engine.js","webpack://library/./src/engine-factory.js","webpack://library/./src/eventbus/index.js","webpack://library/./src/eventbus/actionregistry-eventbus-listener.js","webpack://library/./src/eventbus/request-video-uri-interceptor.js","webpack://library/./src/importer/webpack-resource-importer.js","webpack://library/./src/controllers/index.js","webpack://library/./src/controllers/EventListenerController.js","webpack://library/./src/controllers/LabelController.js","webpack://library/./src/controllers/LottieController.js","webpack://library/external {\"amd\":\"lottie-web\",\"global\":\"lottie\",\"commonjs\":\"lottie-web\",\"commonjs2\":\"lottie-web\"}","webpack://library/./src/controllers/NavigationController.js","webpack://library/./src/controllers/ProgressbarController.js","webpack://library/./src/controllers/RoutingController.js","webpack://library/./src/controllers/SubtitlesController.js","webpack://library/./src/operation/index.js","webpack://library/./src/operation/addClass.js","webpack://library/./src/operation/addControllerToElement.js","webpack://library/./src/operation/helper/attachControllerToElement.js","webpack://library/./src/operation/addOptionList.js","webpack://library/./src/operation/animate.js","webpack://library/./src/operation/animateWithClass.js","webpack://library/./src/operation/broadcastEvent.js","webpack://library/./src/operation/helper/resolveEventArguments.js","webpack://library/./src/operation/helper/removeEventDataFromOperationData.js","webpack://library/./src/operation/clearElement.js","webpack://library/./src/operation/clearOperationData.js","webpack://library/./src/operation/customFunction.js","webpack://library/./src/operation/endAction.js","webpack://library/./src/operation/extendController.js","webpack://library/./src/operation/getControllerFromElement.js","webpack://library/./src/operation/getControllerInstance.js","webpack://library/./src/operation/getElementDimensions.js","webpack://library/./src/operation/helper/modifyDimensions.js","webpack://library/./src/operation/loadJSON.js","webpack://library/./src/operation/removeClass.js","webpack://library/./src/operation/removeControllerFromElement.js","webpack://library/./src/operation/removeElement.js","webpack://library/./src/operation/removePropertiesFromOperationData.js","webpack://library/./src/operation/reparentElement.js","webpack://library/./src/operation/requestAction.js","webpack://library/./src/operation/resizeAction.js","webpack://library/./src/operation/selectElement.js","webpack://library/./src/operation/setElementAttributes.js","webpack://library/./src/operation/setElementContent.js","webpack://library/./src/operation/setOperationData.js","webpack://library/./src/operation/setStyle.js","webpack://library/./src/operation/startAction.js","webpack://library/./src/operation/toggleClass.js","webpack://library/./src/operation/toggleElement.js","webpack://library/./src/operation/wait.js","webpack://library/./src/timelineproviders/index.js","webpack://library/./src/timelineproviders/jwplayer-timeline-provider.js","webpack://library/./src/timelineproviders/request-animation-frame-timeline-provider.js"],"names":["root","factory","exports","module","require","define","amd","undefined","window","__WEBPACK_EXTERNAL_MODULE__2__","__WEBPACK_EXTERNAL_MODULE__28__","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","TimelineEventNames","PLAY_TOGGLE_REQUEST","PLAY_REQUEST","STOP_REQUEST","PAUSE_REQUEST","SEEK_REQUEST","RESIZE_REQUEST","CONTAINER_REQUEST","DURATION_REQUEST","DURATION","TIME","SEEKED","COMPLETE","PLAY","STOP","PAUSE","SEEK","RESIZE","POSITION_UPDATE","TIME_UPDATE","REQUEST_INSTANCE","REQUEST_ACTION","REQUEST_FUNCTION","REQUEST_TIMELINE_URI","BEFORE_REQUEST_TIMELINE_URI","REQUEST_ENGINE_ROOT","REQUEST_CURRENT_TIMELINE_POSITION","REQUEST_TIMELINE_CLEANUP","EXECUTE_TIMELINEACTION","RESIZE_TIMELINEACTION","REQUEST_LABEL_COLLECTION","REQUEST_LABEL_COLLECTIONS","REQUEST_CURRENT_LANGUAGE","LANGUAGE_CHANGE","_mergeOperationData","resolve","operationData","newOperationData","_extends","original","JSON","parse","stringify","getElementData","element","data","getElementControllers","actions","_interopRequireWildcard","_configurationResolver","_interopRequireDefault","_chronoTriggerEngine","_engineFactory","_timelineEventNames","_languageManager","_webpackResourceImporter","_eventbus","_action","_endableaction","_timelineaction","_deepcopy","Action","actionData","eventBus","_classCallCheck","this","startOperations","eventbus","initOperationData","_this","Promise","reject","executeOperation","e","console","error","concat","operations","idx","previousOperationData","_this2","length","operationInfo","mergedOperationData","result","instance","then","resultOperationData","_this3","executeResizeOperation","_this4","resizeInstance","EndableAction","_possibleConstructorReturn","_getPrototypeOf","endOperations","_getNestedPropertyValue","ConfigurationResolver","importer","systemName","actionRegistryListener","configuration","actionsLookup","processConfiguration","resolveOperations","initializeTimelineActions","initializeInitActions","initializeActions","initializeEventActions","config","eventActions","forEach","eventAction","registerAction","eventName","eventTopic","action","initActions","map","initAction","timelines","initializeTimelineAction","timelineConfig","timelineActions","timelineAction","TimelineAction","_this5","timelineOperations","timelineInfo","push","apply","_toConsumableArray","_gatherOperations","holder","importSystemEntry","parentConfig","_this6","constructor","Array","ii","keys","processConfigProperty","startsWith","configProperty","substr","templateKey","jsonKey","json","_typeof","properties","sourceObject","Error","currentInstance","suffix","prop","index","parts","split","LanguageManager","language","labels","_labelLookup","_currentLanguage","_eventbusListeners","_createLabelLookup","_addEventbusListeners","on","_handleRequestLabelCollection","_handleRequestLabelCollections","_handleRequestCurrentLanguage","_handleLanguageChange","resultCallback","labelId","labelIds","label","id","Eventbus","clear","eventHandlers","eventListeners","eventInterceptors","eventHandler","_getEventHandlers","off","eventHandlerDecorator","arguments","handlers","indexOf","splice","args","_callHandlers","eventbusListener","interceptor","_getEventInterceptors","intercept","listener","handleEvent","_getNestedValue","argumentValue","toLowerCase","propNames","shift","_extractOperationDataArgumentValues","copy","extract","extractOperationDataArgumentValues","propertyName","propertyValue","active","duration","start","end","_get","propertyChain","_jquery","ChronoTriggerEngine","timelineProvider","_configuration","_timelineProvider","_timeLineActionsLookup","_createLayoutTemplate","_addInitialisationListeners","_this$_configuration","_currentTimelineUri","uri","_createTimelineLookup","_initializeTimelineProvider","containerSelector","container","layoutTemplate","html","warning","timelineProviderSettings","selector","init","_executeActions","_onTimeHandler","Math","floor","_onSeekHandler","_cleanUpTimeline","_cleanUp","remover","destroy","_handleRequestEngineRoot","_handleRequestTimelineUri","_handleRequestTimelinePosition","_handleTimelineComplete","_handleExecuteTimelineAction","_resizeTimelineAction","_addTimelineAction","timeLineAction","timelineStartPositions","_initializeTimelinePosition","_initializeUriLookup","startMethod","isNaN","Infinity","isFinite","timelineEndPositions","endMethod","lookup","position","methodName","engineRootSelector","previousVideoPosition","stop","loop","once","FIRST_FRAME","pause","broadcastForTopic","playerid","getDuration","_executeStartActions","seek","offset","playlistItem","_executeRelevantActions","_getActiveActions","_getActionsForPosition","allActions","filter","sort","a","b","executionType","_getRelevantTimelineActions","currentActions","getPosition","_getTimelineActionsForUri","resize","some","event","pos","_lastPosition","_executeActionsForPosition","_executeSeekActions","play","executions","exec","newActions","promise","EngineFactory","windowRef","_init","_resizeTimeout","_actionsLookup","_importer","_eventBus","_requestInstanceHandler","_requestActionHandler","_requestFunctionHandler","_resizeHandler","clearTimeout","setTimeout","broadcast","_importSystemEntry","_importSystemEntryWithEventbusDependency","resolver","engine","engineClass","ActionRegistryEventbusListener","registerEventlistener","registerInterceptor","RequestVideoUriInterceptor","process","_actionregistryEventbusListener","_requestVideoUriInterceptor","actionRegistry","eventArgs","slice","controllers","providers","main","_defineProperty","_EventListenerController","_LabelController","_LottieController","_NavigationController","_ProgressbarController","_RoutingController","_SubtitlesController","EventListenerController","actionInstanceInfos","selectedElement","actionOperationData","_this$operationData","actionName","_this$_isStartAction2","_slicedToArray","_isStartAction","isStart","actionInstance","_getElementTagName","_selectEventHandler","_eventHandler","tagName","toUpperCase","target","targetValue","_executeAction","actionInfo","options","opt","selected","LabelController","listeners","currentLanguage","labelData","labelCollection","createTextDataLookup","setLabel","handleLanguageChange","func","code","_lottieWeb","LottieController","anim","serializedData","serializedIEData","animationData","freezePosition","endPosition","renderer","autoplay","viewBox","url","parseFilename","iefallback","setting","values","resultHolder","labelCollections","createAnimation","onComplete","playSegments","serialized","isIE","join","animData","lottie","loadAnimation","timeCompleted","find","attr","infos","document","NavigationController","playerId","navigation","navLookup","navVidIdLookup","ctrlLookup","activeNavigationPoint","labelControllers","eventhandlers","buildNavigationData","handleNavigateVideoUrl","highlightMenu","handleRequestCurrentNavigation","handleVideoComplete","buildHtml","initHistory","navId","getQueryVariable","videoIndex","videoUrlIndex","variableIdx","href","location","hashIndex","query","substring","navigationData","title","handler","ctrl","detach","onpopstate","state","parentElm","ul","addNavElement","append","visible","li","addLabel","addClickHandler","children","mouseup","menuMouseupHandler","navdata","requestedVideoPosition","pushCurrentState","navElm","removeClass","addClass","log","navData","autoNext","next","attach","nav","previous","nextId","roots","ProgressbarController","textElement","detachers","positionUpdateHandler","clickHandler","detacher","perc","css","text","RoutingController","handleBeforeRequestVideoUrl","handlePushHistoryState","handlePopstate","history","pushState","navigationId","isHistoryRequest","item","currentPosition","currentState","replaceState","SubtitlesController","actionLookup","lastFunc","detachTime","onTimeHandler","detachLangChange","languageChangeHandler","internalDetach","detachMethods","f","newLanguage","titleLanguageLookup","controllerData","subtitleData","titles","subtitleTimeLookup","j","jj","subs","lang","setTitle","removeTitle","createActionLookup","_addClass","_addControllerToElement","_addOptionList","_animate","_animateWithClass","_broadcastEvent","_clearElement","_clearOperationData","_customFunction","_endAction","_extendController","_getControllerFromElement","_getControllerInstance","_getElementDimensions","_loadJSON","_removeClass","_removeControllerFromElement","_removeElement","_removePropertiesFromOperationData","_reparentElement","_requestAction","_resizeAction","_selectElement","_setElementAttributes","_setElementContent","_setOperationData","_setStyle","_startAction","_toggleClass","_toggleElement","_wait","className","_attachControllerToElement","_internalResolve","controllerInstance","_getElementData","controller","valueProperty","labelProperty","defaultIndex","defaultValue","optionData","createOption","optionElements","animationEasing","animationProperties","animationDuration","animate","one","_resolveEventArguments","_removeEventDataFromOperationData","eventArguments","empty","mergedData","controllerExtension","controllerName","warn","_modifyDimensions","dimensions","modifier","width","innerWidth","height","innerHeight","ratioModifier","_modifier$split2","prefix","_getModifierSuffix2","endIdx","isPercent","getModifierSuffix","parseInt","widthModifier","heightModifier","ratios","modifyDimensionsByRatio","jsonCache","cache","fetch","response","body","removeElement","remove","propertyNames","newParentSelector","appendTo","_operationData","findElementBySelector","useExistingAsRoot","attributes","attrName","template","_resolvePropertyValues","toggleClass","toggle","milliseconds","_jwplayerTimelineProvider","_requestAnimationFrameTimelineProvider","JwPlayerTimelineProvider","providerid","playerSettings","player","currentLoopHandler","_addEventListeners","timeline","type","urls","_extractUrls","jwp","jwplayer","w","h","setup","file","image","poster","controls","autostart","displaytitle","displaydescription","nextUpDisplay","abouttext","aboutlink","stretching","repeat","playlist","_handlePlayerReady","load","_loopHandler","_seekedHandler","_handlePlayerComplete","getPlaylistIndex","toggleplay","_container","getProvider","paused","callback","getState","getMute","getVolume","setMute","volume","setVolume","RequestAnimationFrameTimelineProvider","requestID","last","current","_updateBound","_update","random","currentPlaylistItem","firstFrame","reset","_resize","requestDurationHandler","now","FIRSTFRAME","_reset","requestAnimationFrame","_cancelAnimationFrame","callBack","cancelAnimationFrame","_extractPlaylist","_start"],"mappings":"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","file":"library.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"jquery\"), require(\"lottie-web\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"library\", [\"jquery\", \"lottie-web\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"library\"] = factory(require(\"jquery\"), require(\"lottie-web\"));\n\telse\n\t\troot[\"library\"] = factory(root[undefined], root[undefined]);\n})(window, function(__WEBPACK_EXTERNAL_MODULE__2__, __WEBPACK_EXTERNAL_MODULE__28__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n","class TimelineEventNames {\r\n    // timeline requests\r\n    static PLAY_TOGGLE_REQUEST = 'timeline-play-toggle-request';\r\n    static PLAY_REQUEST = 'timeline-play-request';\r\n    static STOP_REQUEST = 'timeline-stop-request';\r\n    static PAUSE_REQUEST = 'timeline-pause-request';\r\n    static SEEK_REQUEST = 'timeline-seek-request';\r\n    static RESIZE_REQUEST = 'timeline-resize-request';\r\n    static CONTAINER_REQUEST = 'timeline-container-request';\r\n    static DURATION_REQUEST = 'timeline-duration-request';\r\n\r\n    // timeline announcements\r\n    static DURATION = 'timeline-duration';\r\n    static TIME = 'timeline-time';\r\n    static SEEKED = 'timeline-seeked';\r\n    static COMPLETE = 'timeline-complete';\r\n    static PLAY = 'timeline-play';\r\n    static STOP = 'timeline-stop';\r\n    static PAUSE = 'timeline-pause';\r\n    static SEEK = 'timeline-seek';\r\n    static RESIZE = 'timeline-resize';\r\n    static POSITION_UPDATE = 'timeline-position-update';\r\n    static TIME_UPDATE = 'timeline-time-update';\r\n\r\n    // factory and engine events\r\n    static REQUEST_INSTANCE = 'request-instance';\r\n    static REQUEST_ACTION = 'request-action';\r\n    static REQUEST_FUNCTION = 'request-function';\r\n    static REQUEST_TIMELINE_URI = 'request-timeline-uri';\r\n    static BEFORE_REQUEST_TIMELINE_URI = 'before-request-timeline-uri';\r\n    static REQUEST_ENGINE_ROOT = 'request-engine-root';\r\n    static REQUEST_CURRENT_TIMELINE_POSITION = 'request-current-timeline-position';\r\n    static REQUEST_TIMELINE_CLEANUP = 'request-timeline-cleanup';\r\n    static EXECUTE_TIMELINEACTION = 'execute-timelineaction';\r\n    static RESIZE_TIMELINEACTION = 'resize-timelineaction';\r\n\r\n    //language manager events\r\n    static REQUEST_LABEL_COLLECTION = 'request-label-collection';\r\n    static REQUEST_LABEL_COLLECTIONS = 'request-label-collections';\r\n    static REQUEST_CURRENT_LANGUAGE = 'request-current-language';\r\n    static LANGUAGE_CHANGE = 'language-change';\r\n}\r\n\r\nexport default TimelineEventNames;\r\n","import mergeOperationData from './mergeOperationData';\r\n\r\nfunction internalResolve(resolve, operationData, newOperationData) {\r\n    if (newOperationData) {\r\n        resolve(mergeOperationData(operationData, newOperationData));\r\n    } else {\r\n        resolve(operationData);\r\n    }\r\n}\r\n\r\nexport default internalResolve;\r\n","module.exports = __WEBPACK_EXTERNAL_MODULE__2__;","function mergeOperationData(operationData, newOperationData) {\r\n    return Object.assign(operationData, newOperationData);\r\n}\r\n\r\nexport default mergeOperationData;\r\n","function deepcopy(original) {\r\n    return JSON.parse(JSON.stringify(original));\r\n}\r\n\r\nexport default deepcopy;\r\n","function getElementData(name, element) {\r\n    return element.data(name);\r\n}\r\n\r\nconst getElementControllers = getElementData.bind(null, \"chronoEngineControllers\");\r\n\r\nexport {\r\n    getElementData,\r\n    getElementControllers\r\n}","import * as actions from './action';\r\nexport { default as ConfigurationResolver } from './configuration/configuration-resolver';\r\nexport { default as ChronoTriggerEngine } from './chrono-trigger-engine';\r\nexport { default as EngineFactory } from './engine-factory';\r\nexport { default as TimelineEventNames } from './timeline-event-names';\r\nexport { default as LanguageManager } from './language-manager';\r\nexport { default as WebpackResourceImporter } from './importer/webpack-resource-importer';\r\nexport { default as Eventbus } from './eventbus/eventbus';\r\nexport default actions;","export { default as Action } from './action';\r\nexport { default as EndableAction } from './endableaction';\r\nexport { default as TimelineAction } from './timelineaction';","import deepcopy from '../operation/helper/deepcopy';\r\n\r\nclass Action {\r\n\r\n\tconstructor(actionData, eventBus) {\r\n\t\tthis.name = actionData.name;\r\n\t\tthis.startOperations = actionData.startOperations;\r\n\t\tthis.eventbus = eventBus; \r\n\t}\r\n\r\n\tstart(initOperationData) {\r\n\t\tconst result = new Promise((resolve, reject) => {\r\n\t\t\tthis.executeOperation(this.startOperations, 0, resolve, reject, initOperationData);\r\n\t\t}).catch((e) => {\r\n\t\t\tconsole.error(`Error in action start '${this.name}'`);\r\n\t\t\tthrow e;\r\n\t\t});\r\n\t\treturn result;\r\n\t}\r\n\r\n\texecuteOperation(operations, idx, resolve, reject, previousOperationData) {\r\n\t\tpreviousOperationData = previousOperationData || {};\r\n\r\n\t\tif (idx < operations.length) {\r\n\t\t\tconst operationInfo = operations[idx];\r\n\t\t\tconst copy = (operationInfo.operationData) ? deepcopy(operationInfo.operationData) : {};\r\n\t\t\tconst mergedOperationData = Object.assign(previousOperationData, copy);\r\n\t\t\t\r\n\t\t\tconst result = operationInfo.instance(mergedOperationData, this.eventbus);\r\n\t\t\t\r\n            if (result.then) {\r\n\t\t\t\tresult.then((resultOperationData) => {\r\n\t\t\t\t\tthis.executeOperation(operations, ++idx, resolve, reject, resultOperationData);\r\n\t\t\t\t}).catch((error) => {\r\n\t\t\t\t\treject(error);\r\n\t\t\t\t});\r\n            } else {\r\n                this.executeOperation(operations, ++idx, resolve, reject, result);\r\n            }\r\n\t\t} else {\r\n\t\t\tresolve(previousOperationData);\r\n\t\t}\r\n\t}\r\n\r\n\tresize(operationData) {\r\n\t\tconst idx = 0;\r\n\t\tconst result = new Promise((resolve, reject) => {\r\n\t\t\tthis.executeResizeOperation(this.startOperations, idx, resolve, reject, operationData);\r\n\t\t});\r\n\t\treturn result;\r\n\t}\r\n\r\n\texecuteResizeOperation(operations, idx, resolve, reject, previousOperationData) {\r\n\t\tpreviousOperationData = previousOperationData || {};\r\n\t\t\r\n\t\tif (idx < operations.length) {\r\n\t\t\tconst operationInfo = operations[idx];\r\n\t\t\tif ((operationInfo.resizeInstance)) {\r\n\t\t\t\tconst copy = ((operationInfo.operationData)) ? deepcopy(operationInfo.operationData) : {};\r\n\t\t\t\tconst mergedOperationData = Object.assign(previousOperationData, copy);\r\n\r\n\t\t\t\tconst result = operationInfo.resizeInstance(mergedOperationData);\r\n\t\t\t\tif (result.then){\r\n\t\t\t\t\tresult.then((resultOperationData) => {\r\n\t\t\t\t\t\tthis.executeResizeOperation(operations, ++idx, resolve, reject, resultOperationData);\r\n\t\t\t\t\t}).catch((error) => {\r\n\t\t\t\t\t\treject(error);\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.executeResizeOperation(operations, ++idx, resolve, reject, result);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthis.executeResizeOperation(operations, ++idx, resolve, reject, previousOperationData);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tresolve(previousOperationData);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default Action;\r\n","import Action from './action';\r\n\r\nclass EndableAction extends Action {\r\n\r\n\tconstructor(actionData, eventBus) {\r\n\t\tsuper(actionData, eventBus);\r\n\t\tthis.endOperations = actionData.endOperations;\r\n\t}\r\n\r\n\tend(initOperationData) {\r\n\t\tif ((this.endOperations) && (this.endOperations.length)) {\r\n\t\t\tconst idx = 0;\r\n\t\t\tconst result = new Promise((resolve, reject) => {\r\n\t\t\t\tthis.executeOperation(this.endOperations, idx, resolve, reject, initOperationData);\r\n\t\t\t}).catch((e) => {\r\n\t\t\t\tconsole.error(`Error in action end'${this.name}'`);\r\n\t\t\t\tthrow e;\r\n\t\t\t});\r\n\t\t\treturn result;\r\n\t\t}\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\tresolve(initOperationData);\r\n\t\t});\r\n\t}\r\n\r\n}\r\n\r\nexport default EndableAction;\r\n","import { TimelineAction, EndableAction, Action } from '../action';\r\nimport getNestedPropertyValue from '../operation/helper/getNestedPropertyValue';\r\n\r\nclass ConfigurationResolver {\r\n\r\n    constructor(importer, eventbus) {\r\n        this.importer = importer;\r\n        this.eventbus = eventbus;\r\n    }\r\n\r\n    importSystemEntry(systemName) {\r\n        return this.importer.import(systemName)[systemName];\r\n    }\r\n\r\n    process(actionRegistryListener, configuration) {\r\n        const actionsLookup = {};\r\n        this.processConfiguration(configuration, configuration);\r\n        this.resolveOperations(configuration);\r\n        this.initializeTimelineActions(configuration);\r\n        this.initializeInitActions(configuration, actionsLookup);\r\n        this.initializeActions(configuration, actionsLookup);\r\n        this.initializeEventActions(actionRegistryListener, configuration);\r\n        return actionsLookup;\r\n    }\r\n\r\n    initializeEventActions(actionRegistryListener, config) {\r\n        if ((actionRegistryListener) && (config.eventActions)) {\r\n            config.eventActions.forEach((actionData) => {\r\n                const eventAction = new Action(actionData, this.eventbus);\r\n                actionRegistryListener.registerAction(eventAction, actionData.eventName, actionData.eventTopic);\r\n            });\r\n            delete config.eventActions;\r\n        }\r\n    }\r\n\r\n    initializeActions(config, actionsLookup) {\r\n        if (config.actions) {\r\n            config.actions.forEach((actionData) => {\r\n                const action = new EndableAction(actionData, this.eventbus);\r\n                actionsLookup[actionData.name] = action;\r\n            });\r\n            delete config.actions;\r\n        }\r\n    }\r\n\r\n    initializeInitActions(config, actionsLookup) {\r\n        if (!config.initActions) {\r\n            return;\r\n        }\r\n        config.initActions = config.initActions.map((actionData) => {\r\n            const initAction = new EndableAction(actionData, this.eventbus);\r\n            actionsLookup[actionData.name] = initAction;\r\n            return initAction;\r\n        });\r\n    }\r\n\r\n    initializeTimelineActions(config) {\r\n        if (config.timelines) {\r\n            config.timelines.forEach(this.initializeTimelineAction.bind(this));\r\n        }\r\n    }\r\n\r\n    initializeTimelineAction(timelineConfig) {\r\n        if (!timelineConfig.timelineActions) {\r\n            return;\r\n        }\r\n        timelineConfig.timelineActions = timelineConfig.timelineActions.map((actionData) => {\r\n            const timelineAction = new TimelineAction(actionData, this.eventbus);\r\n            if (!timelineAction.endOperations) {\r\n                timelineAction.endOperations = [];\r\n            }\r\n            return timelineAction;\r\n        });\r\n    }\r\n\r\n    resolveOperations(config) {\r\n        const timelineOperations = [];\r\n        if (config.timelines) {\r\n            config.timelines.forEach((timelineInfo) => {\r\n                timelineOperations.push(...this._gatherOperations(timelineInfo.timelineActions));\r\n            });\r\n        }\r\n\r\n        const systemNameHolders = this._gatherOperations(config.initActions)\r\n                                    .concat(timelineOperations)\r\n                                    .concat(this._gatherOperations(config.actions))\r\n                                    .concat(this._gatherOperations(config.eventActions));\r\n\r\n        systemNameHolders.forEach((holder)=> {\r\n            holder.instance = this.importSystemEntry(holder.systemName);\r\n        });\r\n    }\r\n\r\n    processConfiguration(config, parentConfig) {\r\n        if (config == null) {\r\n            return;\r\n        }\r\n        if (config.constructor === Array) {\r\n            for (let i = 0, ii = config.length; i < ii; i++) {\r\n                this.processConfiguration(config[i], parentConfig);\r\n            }\r\n        } else {\r\n            Object.keys(config).forEach((key) => {\r\n                this.processConfigProperty(key, config, parentConfig);\r\n            });\r\n        }\r\n    }\r\n\r\n    processConfigProperty(key, config, parentConfig) {\r\n        const value = config[key];\r\n        if (typeof value === 'string') {           \r\n            if ((value.startsWith('config:'))) {\r\n                const configProperty = value.substr(7, value.length);\r\n                config[key] = getNestedPropertyValue(configProperty, parentConfig);\r\n            }\r\n            else if ((value.startsWith('template:'))) {\r\n                const templateKey = value.substr(9, value.length);\r\n                config[key] = this.importSystemEntry(templateKey);\r\n            }\r\n            else if ((value.startsWith('json:'))) {\r\n                const jsonKey = value.substr(5, value.length);\r\n                const json = this.importSystemEntry(jsonKey);\r\n                config[key] = json;\r\n            }\r\n        } else if (typeof value === 'object') {\r\n            this.processConfiguration(config[key], parentConfig);\r\n        }\r\n    }\r\n\r\n    _gatherOperations(actions) {\r\n        let result = [];\r\n        if (!actions) {\r\n            return result;\r\n        }\r\n        actions.forEach((action) => {\r\n            if (action.endOperations) {\r\n                result = result.concat(action.startOperations.concat(action.endOperations));\r\n            } else {\r\n                result = result.concat(action.startOperations);\r\n            }\r\n        });\r\n        return result;\r\n    }\r\n\r\n}\r\n\r\nexport default ConfigurationResolver;\r\n","function getNestedValue(properties, sourceObject) {\r\n    if (!properties) {\r\n        throw Error('properties arg cannot be null');\r\n    }\r\n    if (!sourceObject) {\r\n        throw Error('sourceObject arg cannot be null');\r\n    }\r\n    let currentInstance = sourceObject;\r\n    let suffix = null;\r\n    properties.forEach((prop, index) => {\r\n        if (index === properties.length-1) {\r\n            const parts = prop.split('+');\r\n            if (parts.length > 1) {\r\n                prop = parts[0];\r\n                suffix = parts[1];\r\n            }\r\n        }\r\n        currentInstance = currentInstance[prop];\r\n    });\r\n\r\n    return (suffix) ? currentInstance + suffix : currentInstance;\r\n}\r\n\r\nexport default getNestedValue;\r\n","import TimelineEventNames from \"./timeline-event-names\";\r\n\r\nclass LanguageManager {\r\n\r\n    constructor(language, labels, eventbus) {\r\n        if (!language || !language.length) {\r\n            throw new Error('language ctor arg cannot be null or have zero length');\r\n        }\r\n        if (!labels) {\r\n            throw new Error('labels ctor arg cannot be null');\r\n        }\r\n        if (!eventbus) {\r\n            throw new Error('eventbus ctor arg cannot be null');\r\n        }\r\n        this._labelLookup = {};\r\n        this._currentLanguage = language;\r\n        this._eventbusListeners = [];\r\n        this._createLabelLookup(labels);\r\n        this._addEventbusListeners(eventbus);\r\n    }\r\n\r\n    _addEventbusListeners(eventbus) {\r\n        this._eventbusListeners.push(eventbus.on(TimelineEventNames.REQUEST_LABEL_COLLECTION, this._handleRequestLabelCollection.bind(this)));\r\n        this._eventbusListeners.push(eventbus.on(TimelineEventNames.REQUEST_LABEL_COLLECTIONS, this._handleRequestLabelCollections.bind(this)));\r\n        this._eventbusListeners.push(eventbus.on(TimelineEventNames.REQUEST_CURRENT_LANGUAGE, this._handleRequestCurrentLanguage.bind(this)));\r\n        this._eventbusListeners.push(eventbus.on(TimelineEventNames.LANGUAGE_CHANGE, this._handleLanguageChange.bind(this)));\r\n    }\r\n\r\n    _handleRequestCurrentLanguage(resultCallback) {\r\n        resultCallback(this._currentLanguage);\r\n    }\r\n\r\n    _handleRequestLabelCollection(labelId, resultCallback) {\r\n        resultCallback(this._labelLookup[labelId]);\r\n    }\r\n\r\n    _handleRequestLabelCollections(labelIds, resultCallback) {\r\n        const labelCollections = labelIds.map((labelId) => {\r\n            return this._labelLookup[labelId];\r\n        });\r\n        resultCallback(labelCollections);\r\n    }\r\n\r\n    _handleLanguageChange(language) {\r\n        if (language && language.length) {\r\n            this._currentLanguage = language;\r\n        } else {\r\n            console.error('Language cannot be changed to null or empty string');\r\n        }\r\n    }\r\n\r\n    _createLabelLookup(labels) {\r\n        labels.forEach((label) => {\r\n            this._labelLookup[label.id] = label.labels;\r\n        });\r\n    }\r\n}\r\n\r\nexport default LanguageManager;\r\n","class Eventbus {\r\n\r\n\tconstructor() {\r\n\t\tthis.clear();\r\n\t}\r\n\r\n\tclear() {\r\n\t\tthis.eventHandlers = {};\r\n\t\tthis.eventListeners = [];\r\n\t\tthis.eventInterceptors = {};\r\n\t}\r\n\r\n\t_getEventInterceptors(eventName, eventTopic) {\r\n\t\tif ((eventTopic) && (eventTopic.length)) {\r\n\t\t\teventName = `${eventName}:${eventTopic}`;\r\n\t\t}\r\n\t\tif (!this.eventInterceptors[eventName]) {\r\n\t\t\tthis.eventInterceptors[eventName] = [];\r\n\t\t}\r\n\t\treturn this.eventInterceptors[eventName];\r\n\t}\r\n\r\n\t_getEventHandlers(eventName, eventTopic) {\r\n\t\tif ((eventTopic) && (eventTopic.length)) {\r\n\t\t\teventName = `${eventName}:${eventTopic}`;\r\n\t\t}\r\n\t\tif (!this.eventHandlers[eventName]) {\r\n\t\t\tthis.eventHandlers[eventName] = [];\r\n\t\t}\r\n\t\treturn this.eventHandlers[eventName];\r\n\t}\r\n\r\n\ton(eventName, eventHandler, eventTopic) {\r\n\t\tthis._getEventHandlers(eventName, eventTopic).push(eventHandler);\r\n\t\treturn () => {\r\n\t\t\tthis.off(eventName, eventHandler, eventTopic);\r\n\t\t}\r\n\t}\r\n\r\n\tonce(eventName, eventHandler, eventTopic) {\r\n\t\tconst _this = this;\r\n\t\tconst eventHandlerDecorator = function() {\r\n\t\t\teventHandler(...arguments)\r\n\t\t\t_this.off(eventName, eventHandlerDecorator, eventTopic);\r\n\t\t};\r\n\t\tthis.on(eventName, eventHandlerDecorator, eventTopic);\r\n\t}\r\n\r\n\toff(eventName, eventHandler, eventTopic) {\r\n\t\tconst handlers = this._getEventHandlers(eventName, eventTopic);\r\n\t\tif (handlers) {\r\n\t\t\tconst idx = handlers.indexOf(eventHandler);\r\n\t\t\tif (idx > -1) {\r\n\t\t\t\thandlers.splice(idx, 1);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tbroadcast(eventName, args) {\r\n\t\tthis._callHandlers(eventName, null, args);\r\n\t}\r\n\r\n\tbroadcastForTopic(eventName, eventTopic, args) {\r\n\t\tthis._callHandlers(eventName, eventTopic, args);\r\n\t}\r\n\r\n\tregisterEventlistener(eventbusListener) {\r\n\t\tthis.eventListeners.push(eventbusListener);\r\n\t}\r\n\r\n\tregisterInterceptor(eventName, interceptor, eventTopic) {\r\n\t\tconst interceptors = this._getEventInterceptors(eventName, eventTopic);\r\n\t\tinterceptors.push(interceptor);\r\n\t}\r\n\r\n\t_callHandlers(eventName, eventTopic, args=[]) {\r\n\t\tconst interceptors = this._getEventInterceptors(eventName, eventTopic);\r\n\t\tinterceptors.forEach((interceptor) => {\r\n\t\t\targs = interceptor.intercept(args);\r\n\t\t});\r\n\t\tthis.eventListeners.forEach((listener) => {\r\n\t\t\tlistener.handleEvent(eventName, eventTopic, args);\r\n\t\t});\r\n\t\tconst handlers = this._getEventHandlers(eventName, eventTopic);\r\n\t\tif (handlers) {\r\n\t\t\tfor (let i = 0, l = handlers.length; i < l; i++) {\r\n\t\t\t\thandlers[i](...args);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\nexport default Eventbus;\r\n","import getNestedValue from './getNestedValue';\r\n\r\nfunction extractOperationDataArgumentValues(sourceObject, argumentValue) {\r\n    if ((argumentValue) && (argumentValue.toLowerCase) && (argumentValue.toLowerCase().startsWith('operationdata.'))) {\r\n        let propNames = argumentValue.split('.');\r\n        propNames.shift();\r\n        return getNestedValue(propNames, sourceObject);\r\n    }\r\n    return argumentValue;\r\n}\r\n\r\nexport default extractOperationDataArgumentValues;\r\n","import extractOperationDataArgumentValues from './extractOperationDataArgumentValues';\r\nimport deepcopy from './deepcopy';\r\n\r\nfunction resolvePropertyValues(operationData, properties) {\r\n    const copy = deepcopy(properties);\r\n    const extract = extractOperationDataArgumentValues.bind(null, operationData);\r\n    for(let propertyName in properties) {\r\n        const propertyValue = properties[propertyName];\r\n        copy[propertyName] = extract(propertyValue);\r\n    }\r\n    return copy;\r\n}\r\n\r\nexport default resolvePropertyValues\r\n","import EndableAction from './endableaction';\r\n\r\nclass TimelineAction extends EndableAction {\r\n\r\n\tconstructor(actionData, eventBus) {\r\n\t\tsuper(actionData, eventBus);\r\n\t\tthis.active = false;\r\n\t\tthis.duration = actionData.duration;\r\n\t\tthis.duration.start = +this.duration.start;\r\n\t\tthis.duration.end = +this.duration.end;\r\n\t}\r\n\r\n\tstart() {\r\n\t\tif ((!this.active) || (this.duration.end < 0)) {\r\n\t\t\tthis.active = (this.duration.end > -1);\r\n\t\t\treturn super.start();\r\n\t\t}\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\tresolve();\r\n\t\t});\r\n\t}\r\n\r\n\tend(initOperationData) {\r\n\t\tthis.active = false;\r\n\t\treturn super.end(initOperationData);\r\n\t}\r\n\r\n\tresize(operationData) {\r\n\t\tif ((this.active) || (this.duration.end < 0)) {\r\n\t\t\treturn super.resize(operationData);\r\n\t\t}\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\tresolve();\r\n\t\t});\r\n\t}\r\n\r\n}\r\n\r\nexport default TimelineAction;\r\n","import getNestedValue from \"./getNestedValue\";\r\n\r\nfunction getNestedPropertyValue(propertyChain, sourceObject) {\r\n    const properties = propertyChain.split('.');\r\n    return getNestedValue(properties, sourceObject);\r\n}\r\n\r\nexport default getNestedPropertyValue;\r\n","import LanguageManager from './language-manager';\r\nimport $ from 'jquery';\r\nimport TimelineEventNames from './timeline-event-names';\r\n\r\nclass ChronoTriggerEngine {\r\n\r\n    constructor(configuration, eventbus, timelineProvider) {\r\n        this._configuration = configuration;\r\n        this._eventbus = eventbus;\r\n        this._timelineProvider = timelineProvider;\r\n        this._timeLineActionsLookup = {};\r\n        this._eventbusListeners = [];\r\n    }\r\n\r\n    init() {\r\n        this._createLayoutTemplate();\r\n\r\n        this._addInitialisationListeners();\r\n\r\n        const { language, labels, timelines} = this._configuration;\r\n        const { _eventbus } = this;\r\n\r\n        this._languageManager = new LanguageManager(language, labels, _eventbus);\r\n\r\n        this._currentTimelineUri = (timelines && timelines.length) ? timelines[0].uri : null;\r\n\r\n        this._createTimelineLookup();\r\n\r\n        return this._initializeTimelineProvider();\r\n    }\r\n\r\n    _createLayoutTemplate() {\r\n        const { containerSelector } = this._configuration;\r\n        const container = $(containerSelector);\r\n        if (!container || !container.length) {\r\n            throw new Error(`Container selector not found: ${containerSelector}`);\r\n        }\r\n        const { layoutTemplate } = this._configuration;\r\n        if (layoutTemplate && layoutTemplate.length) {\r\n            container.html(layoutTemplate);\r\n        } else {\r\n            console.warning('layoutTemplate is empty, unable to create layout');\r\n        }\r\n    }\r\n\r\n    _initializeTimelineProvider() {\r\n        const { timelineProviderSettings } = this._configuration;\r\n        if (!timelineProviderSettings) {\r\n            return;\r\n        }\r\n\r\n        const playerContainer = $(`#${timelineProviderSettings.selector}`);\r\n\r\n        if (playerContainer.length) {\r\n            return new Promise((resolve) => {\r\n                this._timelineProvider.init().then(() => {\r\n                    this._executeActions((this._configuration.initActions), \"start\").then(() => {\r\n                        this._timelineProvider.on(TimelineEventNames.TIME, this._onTimeHandler.bind(this, Math.floor));\r\n                        this._timelineProvider.on(TimelineEventNames.SEEK, this._onSeekHandler.bind(this, Math.floor));\r\n                        resolve(this._timelineProvider);\r\n                    });\r\n                });\r\n            });\r\n        }\r\n\r\n        return new Promise((resolve)=> {\r\n            resolve();\r\n        });\r\n    }\r\n\r\n    async _cleanUp() {\r\n        await this._cleanUpTimeline();\r\n        await this._executeActions((this._configuration.initActions), 'end');\r\n    }\r\n\r\n    async destroy() {\r\n        await this._cleanUp();\r\n        this._configuration = null;\r\n        this._eventbus = null;\r\n        this._timelineProvider = null;\r\n        this._timeLineActionsLookup = null;\r\n        this._eventbusListeners.forEach(remover => remover());\r\n        if (this._timelineProvider) {\r\n            this._timelineProvider.destroy();\r\n        }\r\n    }\r\n\r\n    _addInitialisationListeners() {\r\n        this._eventbusListeners.push(this._eventbus.on(TimelineEventNames.REQUEST_ENGINE_ROOT, this._handleRequestEngineRoot.bind(this, this._configuration.containerSelector)));\r\n        this._eventbusListeners.push(this._eventbus.on(TimelineEventNames.REQUEST_TIMELINE_URI, this._handleRequestTimelineUri.bind(this)));\r\n        this._eventbusListeners.push(this._eventbus.on(TimelineEventNames.REQUEST_CURRENT_TIMELINE_POSITION, this._handleRequestTimelinePosition.bind(this)));\r\n        this._eventbusListeners.push(this._eventbus.on(TimelineEventNames.REQUEST_TIMELINE_CLEANUP, this._handleTimelineComplete.bind(this)));\r\n        this._eventbusListeners.push(this._eventbus.on(TimelineEventNames.EXECUTE_TIMELINEACTION, this._handleExecuteTimelineAction.bind(this)));\r\n        this._eventbusListeners.push(this._eventbus.on(TimelineEventNames.RESIZE_TIMELINEACTION, this._resizeTimelineAction.bind(this)));\r\n    }\r\n\r\n    _createTimelineLookup() {\r\n        if (!this._configuration.timelines) {\r\n            return;\r\n        }\r\n        this._configuration.timelines.forEach((timelineInfo) => {\r\n            timelineInfo.timelineActions.forEach(this._addTimelineAction.bind(this, timelineInfo.uri));\r\n        });\r\n    }\r\n\r\n    _addTimelineAction(uri, timeLineAction) {\r\n        const start = timeLineAction.duration.start;\r\n        const timelineStartPositions = this._initializeTimelinePosition(this._initializeUriLookup(this._timeLineActionsLookup, uri), start);\r\n        const startMethod = timeLineAction.start.bind(timeLineAction);\r\n        timelineStartPositions.push(startMethod);\r\n\r\n        let end = timeLineAction.duration.end;\r\n        if ((!end) || (isNaN(end))) {\r\n            end = timeLineAction.duration.end = Infinity;\r\n        }\r\n        if (isFinite(end)) {\r\n            const timelineEndPositions = this._initializeTimelinePosition(this._timeLineActionsLookup[uri], end);\r\n            const endMethod = timeLineAction.end.bind(timeLineAction);\r\n            timelineEndPositions.push(endMethod);\r\n        }\r\n    }\r\n\r\n    _initializeUriLookup(lookup, uri) {\r\n        if (!lookup[uri]) {\r\n            lookup[uri] = {};\r\n        }\r\n        return lookup[uri];\r\n    }\r\n\r\n    _initializeTimelinePosition(lookup, position) {\r\n        if (!lookup[position]) {\r\n            lookup[position] = [];\r\n        }\r\n        return lookup[position];\r\n    }\r\n\r\n    _executeActions(actions, methodName, idx=0) {\r\n        if (idx < actions.length) {\r\n            const action = actions[idx];\r\n\r\n            const promise = action[methodName]();\r\n            return promise.then(() => {\r\n                return this._executeActions(actions, methodName, ++idx);\r\n            });\r\n        }\r\n        return new Promise((resolve) => {\r\n            resolve();\r\n        });\r\n    }\r\n\r\n    _handleRequestEngineRoot(engineRootSelector, resultCallback) {\r\n        resultCallback($(engineRootSelector));\r\n    }\r\n\r\n    _handleRequestTimelineUri(index, position, previousVideoPosition) {\r\n        position = position || 0;\r\n        previousVideoPosition = previousVideoPosition || 0;\r\n        this._timelineProvider.stop();\r\n        this._cleanUpTimeline().then(() => {\r\n            const timelineConfig = this._configuration.timelines[index];\r\n            this._currentTimelineUri = timelineConfig.uri;\r\n            this._timelineProvider.loop = timelineConfig.loop;\r\n            if ((!this._timelineProvider.loop) && (position > 0)) {\r\n                this._timelineProvider.once(TimelineEventNames.FIRST_FRAME, () => {\r\n                    this._timelineProvider.pause();\r\n                    this._eventbus.broadcastForTopic(TimelineEventNames.DURATION, this._timelineProvider.playerid, [this.getDuration()]);\r\n                    this._executeStartActions().then(() => {\r\n                        this._timelineProvider.seek(position);\r\n                        this._onSeekHandler(Math.floor, { offset: position });\r\n                    });\r\n                });\r\n            }\r\n            this._timelineProvider.playlistItem(index);\r\n        });\r\n    }\r\n\r\n    _cleanUpTimeline() {\r\n        return this._executeRelevantActions(this._getActiveActions, \"end\");\r\n    }\r\n\r\n    _executeStartActions() {\r\n        return this._executeRelevantActions(this._getActionsForPosition.bind(this, 0), \"start\");\r\n    }\r\n\r\n    _getActionsForPosition(position, allActions) {\r\n        return allActions.filter((action) => {\r\n            return (!action.active) && ((action.duration.start <= position) && (action.duration.end >= position));\r\n        });\r\n    }\r\n\r\n    _getActiveActions(allActions) {\r\n        const actions = allActions.filter((action) => {\r\n            return action.active;\r\n        });\r\n        return actions.sort((a, b) => {\r\n            if (b.duration.start < a.duration.start) {\r\n                return -1;\r\n            } else if (b.duration.start > a.duration.start) {\r\n                return 1;\r\n            } else {\r\n                return 0;\r\n            }\r\n        });\r\n    }\r\n\r\n    _executeRelevantActions(filter, executionType) {\r\n        const timelineActions = this._getRelevantTimelineActions();\r\n        const currentActions = filter.apply(this, [timelineActions]);\r\n        return this._executeActions(currentActions, executionType, 0);\r\n    }\r\n\r\n    _handleRequestTimelinePosition(resultCallback) {\r\n        resultCallback(Math.floor(this._timelineProvider.getPosition()));\r\n    }\r\n\r\n    _handleTimelineComplete() {\r\n        this._cleanUpTimeline();\r\n    }\r\n\r\n    _handleExecuteTimelineAction(uri, index, start) {\r\n        const actions = this._getTimelineActionsForUri(uri);\r\n        const action = (actions) ? actions[index] : null;\r\n        if (action) {\r\n            if (start) {\r\n                action.start();\r\n            } else {\r\n                action.end();\r\n            }\r\n        }\r\n    }\r\n\r\n    _resizeTimelineAction(uri, index) {\r\n        const actions = this._getTimelineActionsForUri(uri);\r\n        const action = (actions) ? actions[index] : null;\r\n        if (action) {\r\n            action.resize();\r\n        }\r\n    }\r\n\r\n    _getRelevantTimelineActions() {\r\n        return this._getTimelineActionsForUri(this._currentTimelineUri);\r\n    }\r\n\r\n    _getTimelineActionsForUri(uri) {\r\n        let timelineActions;\r\n        this._configuration.timelines.some((timelineInfo) => {\r\n            if (timelineInfo.uri === uri) {\r\n                timelineActions = timelineInfo.timelineActions;\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n        return timelineActions;\r\n    }\r\n\r\n    _onTimeHandler(floor, event) {\r\n        if (!isNaN(event.position)) {\r\n            const pos = floor(event.position);\r\n            if (this._lastPosition !== pos) {\r\n                this._executeActionsForPosition(pos);\r\n                this._eventbus.broadcastForTopic(TimelineEventNames.POSITION_UPDATE, this._timelineProvider.playerid, [pos, this._timelineProvider.getDuration()]);\r\n            }\r\n            this._eventbus.broadcastForTopic(TimelineEventNames.TIME_UPDATE, this._timelineProvider.playerid, [event.position, this._timelineProvider.getDuration()]);\r\n        }\r\n    }\r\n\r\n    _onSeekHandler(floor, event) {\r\n        const pos = floor(event.offset);\r\n        if (isNaN(pos)) {\r\n            return;\r\n        }\r\n        this._executeSeekActions(pos).then(() => {\r\n            this._timelineProvider.play();\r\n        });\r\n    }\r\n\r\n    _executeActionsForPosition(position) {\r\n        this._lastPosition = position;\r\n        const actions = this._timeLineActionsLookup[this._currentTimelineUri];\r\n        if (actions) {\r\n            const executions = actions[position];\r\n            if (executions) {\r\n                executions.forEach((exec) => {\r\n                    exec();\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    _executeSeekActions(pos) {\r\n        const timelineActions = this._getRelevantTimelineActions();\r\n        const currentActions = this._getActiveActions(timelineActions);\r\n        const newActions = this._getActionsForPosition(pos, timelineActions);\r\n\r\n        const promise = this._executeActions(currentActions, \"end\", 0);\r\n\r\n        return new Promise((resolve) => {\r\n            promise.then(() => {\r\n                this._executeActions(newActions, \"start\", 0).then(() => {\r\n                    resolve();\r\n                });\r\n            });\r\n        });\r\n    }\r\n}\r\n\r\nexport default ChronoTriggerEngine;\r\n","import { Eventbus, ActionRegistryEventbusListener, RequestVideoUriInterceptor } from './eventbus';\r\nimport $ from 'jquery';\r\nimport TimelineEventNames from './timeline-event-names';\r\nimport ConfigurationResolver from './configuration/configuration-resolver';\r\n\r\nclass EngineFactory {\r\n    \r\n    constructor(importer, windowRef, eventbus) {\r\n        this._init(importer, windowRef, eventbus);\r\n    }\r\n\r\n    _init(importer, windowRef, eventbus) {\r\n        this._resizeTimeout = -1;\r\n        this._actionsLookup = null;\r\n\r\n        this._importer = importer;\r\n\r\n        this._eventBus = eventbus || new Eventbus();\r\n        this._eventBus.on(TimelineEventNames.REQUEST_INSTANCE, this._requestInstanceHandler.bind(this));\r\n        this._eventBus.on(TimelineEventNames.REQUEST_ACTION, this._requestActionHandler.bind(this));\r\n        this._eventBus.on(TimelineEventNames.REQUEST_FUNCTION, this._requestFunctionHandler.bind(this));\r\n        \r\n        $(windowRef).resize(this._resizeHandler.bind(this));\r\n    }\r\n\r\n    destroy() {\r\n        this._eventBus.clear();\r\n        this._eventBus = null;\r\n    }\r\n\r\n    _resizeHandler() {\r\n        if (this._resizeTimeout > -1) {\r\n            clearTimeout(this._resizeTimeout);\r\n        }\r\n        this._resizeTimeout = setTimeout(() => {\r\n            this._eventBus.broadcast(TimelineEventNames.RESIZE);\r\n        }, 200);\r\n    }\r\n\r\n    _importSystemEntryWithEventbusDependency(systemName) {\r\n        const ctor = this._importSystemEntry(systemName);\r\n        return new ctor(this._eventBus);\r\n    }\r\n\r\n    _importSystemEntry(systemName) {\r\n        return this._importer.import(systemName)[systemName];\r\n    }\r\n\r\n    _requestInstanceHandler(systemName, resultCallback) {\r\n        resultCallback(this._importSystemEntryWithEventbusDependency(systemName));\r\n    }\r\n\r\n    _requestFunctionHandler(systemName, resultCallback) {\r\n        resultCallback(this._importSystemEntry(systemName));\r\n    }\r\n\r\n    _requestActionHandler(systemName, resultCallback) {\r\n        const action = this._actionsLookup[systemName];\r\n        if (action) {\r\n            resultCallback(action);\r\n        } else {\r\n            console.error(`Unknown action: ${systemName}`);\r\n            resultCallback(null);\r\n        }\r\n    }\r\n\r\n    createEngine(configuration, resolver) {\r\n        const { systemName } = configuration.engine;\r\n        const engineClass = this._importSystemEntry(systemName);\r\n\r\n        let actionRegistryListener = null;\r\n        if ((configuration.eventActions) && (configuration.eventActions.length)) {\r\n            actionRegistryListener = new ActionRegistryEventbusListener();\r\n            this._eventBus.registerEventlistener(actionRegistryListener);\r\n        }\r\n\r\n        this._eventBus.registerInterceptor(TimelineEventNames.REQUEST_TIMELINE_URI, new RequestVideoUriInterceptor(this._eventBus));\r\n\r\n        resolver = resolver || new ConfigurationResolver(this._importer, this._eventBus);\r\n        this._actionsLookup = resolver.process(actionRegistryListener, configuration);\r\n\r\n        const timelineProviderClass = this._importSystemEntry(configuration.timelineProviderSettings.systemName);\r\n        const timelineProvider = new timelineProviderClass(this._eventBus, configuration);\r\n\r\n        const chronoTriggerEngine = new engineClass(configuration, this._eventBus, timelineProvider);\r\n        return chronoTriggerEngine;\r\n    }\r\n\r\n}\r\n\r\nexport default EngineFactory;\r\n","export { default as Eventbus } from './eventbus';\r\nexport { default as ActionRegistryEventbusListener } from './actionregistry-eventbus-listener';\r\nexport { default as RequestVideoUriInterceptor } from './request-video-uri-interceptor';","class ActionRegistryEventbusListener {\r\n\r\n\tconstructor() {\r\n\t\tthis.actionRegistry = {};\r\n\t}\r\n\r\n\tregisterAction(action, eventName, eventTopic) {\r\n\t\tif ((eventTopic) && (eventTopic.length)) {\r\n\t\t\teventName = `${eventName}:${eventTopic}`;\r\n\t\t}\r\n\t\tif (!this.actionRegistry[eventName]) {\r\n\t\t\tthis.actionRegistry[eventName] = [];\r\n\t\t}\r\n\t\tthis.actionRegistry[eventName].push(action);\r\n\t}\r\n\r\n\thandleEvent(eventName, eventTopic, args) {\r\n\t\tif ((eventTopic) && (eventTopic.length)) {\r\n\t\t\teventName = `${eventName}:${eventTopic}`;\r\n\t\t}\r\n\t\tconst actions = this.actionRegistry[eventName];\r\n\t\tif (actions) {\r\n\t\t\tconst operationData = {\r\n\t\t\t\teventArgs: args\r\n\t\t\t};\r\n\t\t\tactions.forEach((action) => {\r\n\t\t\t\taction.start(operationData);\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default ActionRegistryEventbusListener;\r\n","import TimelineEventNames from \"../timeline-event-names\";\r\n\r\nclass RequestVideoUriInterceptor {\r\n\r\n\tconstructor(eventbus) {\r\n\t\tthis.eventbus = eventbus;\r\n\t}\r\n\r\n\tintercept(args) {\r\n\t\tthis.eventbus.broadcast(TimelineEventNames.BEFORE_REQUEST_TIMELINE_URI, args.slice());\r\n\t\treturn args;\r\n\t}\r\n\r\n}\r\n\r\nexport default RequestVideoUriInterceptor;\r\n","import * as controllers from '../controllers';\r\nimport * as operations from '../operation';\r\nimport * as providers from '../timelineproviders';\r\nimport * as main from '../';\r\n\r\nclass WebpackResourceImporter {\r\n\r\n    getOperationNames() {\r\n        return Object.keys(operations);\r\n    }\r\n\r\n    getControllerNames() {\r\n        return Object.keys(controllers);\r\n    }\r\n\r\n    getProviderNames() {\r\n        return Object.keys(providers);\r\n    }\r\n\r\n    import(name) {\r\n        if (operations[name]) {\r\n            return {\r\n                [name]: operations[name]\r\n            };\r\n        } else if (controllers[name]) {\r\n            return {\r\n                [name]: controllers[name]\r\n            };\r\n        } else if (providers[name]) {\r\n            return {\r\n                [name]: providers[name]\r\n            };\r\n        } else if (main[name]) {\r\n            return {\r\n                [name]: main[name]\r\n            };\r\n        }\r\n        return null;\r\n    }\r\n\r\n}\r\n\r\nexport default WebpackResourceImporter;\r\n","export { default as EventListenerController } from './EventListenerController';\r\nexport { default as LabelController } from './LabelController';\r\nexport { default as LottieController } from './LottieController';\r\nexport { default as NavigationController } from './NavigationController';\r\nexport { default as ProgressbarController } from './ProgressbarController';\r\nexport { default as RoutingController } from './RoutingController';\r\nexport { default as SubtitlesController } from './SubtitlesController';\r\n","import $ from 'jquery';\r\nimport TimelineEventNames from \"../timeline-event-names\";\r\nimport deepcopy from '../operation/helper/deepcopy';\r\n\r\nclass EventListenerController {\r\n\r\n\tconstructor() {\r\n\t\tthis.operationData = null;\r\n\t\tthis.actionInstanceInfos = null;\r\n\t\tthis.name = \"EventListenerController\";\r\n\t}\r\n\r\n\tinit(operationData) {\r\n\t\tthis.operationData = {\r\n\t\t\tselectedElement: operationData.selectedElement,\r\n\t\t\teventName: operationData.eventName,\r\n\t\t\tactions: operationData.actions.slice(),\r\n\t\t\tactionOperationData: operationData.actionOperationData ? deepcopy(operationData.actionOperationData) : undefined\r\n\t\t}\r\n\t}\r\n\r\n\tattach(eventbus) {\r\n\t\tconst { selectedElement, actions, eventName } = this.operationData;\r\n\t\tif (!this.actionInstanceInfos) {\r\n\t\t\tthis.actionInstanceInfos = [];\r\n\t\t\tactions.forEach((actionName) => {\r\n\t\t\t\tconst [isStart, name] = this._isStartAction(actionName);\r\n\t\t\t\tconst resultCallback = (actionInstance) => {\r\n\t\t\t\t\tthis.actionInstanceInfos.push({ start: isStart, action: actionInstance });\r\n\t\t\t\t};\r\n\r\n\t\t\t\teventbus.broadcast(TimelineEventNames.REQUEST_ACTION, [name, resultCallback]);\r\n\t\t\t});\r\n\t\t\tif (this._getElementTagName(selectedElement) === \"SELECT\") {\r\n\t\t\t\tselectedElement.on(eventName, this._selectEventHandler.bind(this));\r\n\t\t\t} else {\r\n\t\t\t\tselectedElement.on(eventName, this._eventHandler.bind(this));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t_getElementTagName(element) {\r\n\t\tconst tagName = (element.length) ? element[0].tagName : element.tagName;\r\n\t\treturn tagName.toUpperCase();\r\n\t}\r\n\r\n\t_isStartAction(actionName) {\r\n\t\tconst prefix = actionName.substr(0, \"end:\".length);\r\n\t\tif (prefix === \"end:\") {\r\n\t\t\treturn [false, actionName.substr(\"end:\".length)];\r\n\t\t} else {\r\n\t\t\treturn [true, actionName];\r\n\t\t}\r\n\t}\r\n\r\n\t_eventHandler(event) {\r\n\t\tconst copy = (this.operationData.actionOperationData) ? deepcopy(this.operationData.actionOperationData) : {};\r\n\t\tif (event.target) {\r\n\t\t\tcopy.targetValue = event.target.value;\r\n\t\t}\r\n\t\tthis._executeAction(this.actionInstanceInfos, copy, 0);\r\n\t}\r\n\r\n\t_executeAction(actions, operationData, idx) {\r\n\t\tif (idx < actions.length) {\r\n\t\t\tconst actionInfo = actions[idx];\r\n\t\t\tconst { action } = actionInfo;\r\n\t\t\tconst method = (actionInfo.start) ? action.start.bind(action) : action.end.bind(action);\r\n\t\t\tmethod(operationData)\r\n\t\t\t\t.then((resultOperationData) => {\r\n\t\t\t\t\treturn this._executeAction(actions, Object.assign(operationData, resultOperationData), ++idx);\r\n\t\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t_selectEventHandler(event) {\r\n\t\tconst options = event.target;\r\n\t\tfor (let i = 0, l = options.length; i < l; i++) {\r\n\t\t\tconst opt = options[i];\r\n\t\t\tif (opt.selected) {\r\n\t\t\t\tconst copy = (this.operationData.actionOperationData) ? deepcopy(this.operationData.actionOperationData) : {};\r\n\t\t\t\tthis._executeAction(this.actionInstanceInfos, Object.assign({ eventArgs: [opt.value] }, copy), 0);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tdetach(eventbus) {\r\n\t\tthis.operationData.selectedElement.off(this.operationData.eventName);\r\n\t}\r\n\r\n}\r\n\r\nexport default EventListenerController;\r\n","import TimelineEventNames from \"../timeline-event-names\";\r\n\r\nclass LabelController {\r\n\r\n\tconstructor() {\r\n\t\tthis.listeners = [];\r\n\t\tthis.currentLanguage = null;\r\n\t\tthis.operationData = null;\r\n\t\tthis.labelData = {};\r\n\t\tthis.name = \"LabelController\";\r\n\t}\r\n\r\n\tinit(operationData) {\r\n\t\tthis.operationData = Object.assign({},operationData);\r\n\t}\r\n\r\n\tattach(eventbus) {\r\n\t\teventbus.broadcast(TimelineEventNames.REQUEST_CURRENT_LANGUAGE, [(language)=> {\r\n\t\t\tthis.currentLanguage = language;\r\n\t\t}]);\r\n\t\teventbus.broadcast(TimelineEventNames.REQUEST_LABEL_COLLECTION, [this.operationData.labelId, (labelCollection)=> {\r\n\t\t\tthis.createTextDataLookup(labelCollection);\r\n\t\t}]);\r\n\t\tthis.setLabel();\r\n\t\tthis.listeners.push(eventbus.on(TimelineEventNames.LANGUAGE_CHANGE, this.handleLanguageChange.bind(this)));\r\n\t}\r\n\r\n\tsetLabel() {\r\n\t\tthis.operationData.selectedElement.html(this.labelData[this.currentLanguage]);\r\n\t}\r\n\r\n\tdetach(eventbus) {\r\n\t\tthis.listeners.forEach((func) => {\r\n\t\t\tfunc();\r\n\t\t});\r\n\t}\r\n\r\n\thandleLanguageChange(code) {\r\n\t\tthis.currentLanguage = code;\r\n\t\tthis.setLabel();\r\n\t}\r\n\r\n\tcreateTextDataLookup(data) {\r\n\t\tdata.forEach((d) => {\r\n\t\t\tthis.labelData[d.code] = d.label;\r\n\t\t});\r\n\t}\r\n}\r\n\r\nexport default LabelController;\r\n","import lottie from 'lottie-web';\r\nimport TimelineEventNames from '../timeline-event-names';\r\n\r\nclass LottieController {\r\n\r\n\tconstructor() {\r\n\t\tthis.name = \"LottieController\";\r\n\t\tthis.currentLanguage = null;\r\n\t\tthis.labelData = {};\r\n\t\tthis.listeners = [];\r\n\t\tthis.anim = null;\r\n\t\tthis.operationData = null;\r\n\t\tthis.serializedData = null;\r\n\t\tthis.serializedIEData = null;\r\n\t\tthis.animationData = null;\r\n\t\tthis.freezePosition = -1;\r\n\t\tthis.endPosition = -1;\r\n\t}\r\n\r\n\tinit(operationData) {\r\n\t\tthis.operationData = {\r\n\t\t\tselectedElement: operationData.selectedElement,\r\n\t\t\trenderer: operationData.renderer,\r\n\t\t\tloop: operationData.loop,\r\n\t\t\tautoplay: operationData.autoplay,\r\n\t\t\tanimationData: operationData.animationData,\r\n\t\t\tjson: operationData.json,\r\n\t\t\tlabelIds: operationData.labelIds,\r\n\t\t\tviewBox: operationData.viewBox\r\n\t\t};\r\n\t\tif (operationData.url.indexOf(\"[\") > -1) {\r\n\t\t\tthis.parseFilename(operationData.url);\r\n\t\t}\r\n\t\tthis.serializedData = this.operationData.json\r\n\t\t\t? JSON.stringify(this.operationData.json)\r\n\t\t\t: JSON.stringify(this.operationData.animationData);\r\n\t\tif (this.operationData.iefallback) {\r\n\t\t\tthis.serializedIEData = JSON.stringify(this.operationData.iefallback);\r\n\t\t}\r\n\t}\r\n\r\n\tparseFilename(name) {\r\n\t\tconst params = name.substr(name.indexOf(\"[\") + 1, name.indexOf(\"]\") - name.indexOf(\"[\") - 1);\r\n\t\tconst settings = params.split(\",\");\r\n\t\tsettings.forEach((setting) => {\r\n\t\t\tconst values = setting.split(\"=\");\r\n\t\t\tif (values[0] === \"freeze\") {\r\n\t\t\t\tthis.freezePosition = +values[1];\r\n\t\t\t} else if (values[0] === \"end\") {\r\n\t\t\t\tthis.endPosition = +values[1];\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tattach(eventbus) {\r\n\t\tconst { labelIds } = this.operationData; \r\n\t\tif ((labelIds) && (labelIds.length)) {\r\n\t\t\tconst resultHolder = {};\r\n\t\t\t\r\n\t\t\teventbus.broadcast(TimelineEventNames.REQUEST_CURRENT_LANGUAGE, [resultHolder]);\r\n\t\t\tthis.currentLanguage = resultHolder.language;\r\n\t\t\tthis.listeners.push(eventbus.on(TimelineEventNames.LANGUAGE_CHANGE, this.handleLanguageChange.bind(this)));\r\n\t\t\teventbus.broadcast(TimelineEventNames.REQUEST_LABEL_COLLECTIONS, [this.operationData.labelIds, resultHolder]);\r\n\t\t\tthis.createTextDataLookup(resultHolder.labelCollections);\r\n\t\t}\r\n\t\tthis.createAnimation();\r\n\t}\r\n\r\n\tdetach(eventbus) {\r\n\t\tthis.listeners.forEach((func) => {\r\n\t\t\tfunc();\r\n\t\t});\r\n\t\tif (this.anim) {\r\n\t\t\tif (this.endPosition > -1) {\r\n\t\t\t\tthis.anim.onComplete = this.destroy.bind(this);\r\n\t\t\t\tthis.anim.playSegments([this.freezePosition, this.endPosition], true);\r\n\t\t\t} else {\r\n\t\t\t\tthis.anim.destroy();\r\n\t\t\t}\r\n\t\t}\r\n  }\r\n    \r\n\tdestroy() {\r\n\t\tif (this.anim) {\r\n\t\t\tthis.anim.destroy();\r\n\t\t\tthis.anim = null;\r\n\t\t}\r\n\t}\r\n\r\n\tcreateAnimation() {\r\n\t\tif (this.anim) {\r\n\t\t\tthis.anim.destroy();\r\n\t\t}\r\n\t\tlet serialized = (this.isIE()) ? this.serializedIEData : this.serializedData;\r\n\r\n\t\tconst { labelIds } = this.operationData;\r\n\t\tif (labelIds && labelIds.length) {\r\n\t\t\tlabelIds.forEach((id) => {\r\n\t\t\t\tserialized = serialized.split(`!!${id}!!`).join(this.labelData[id][this.currentLanguage]);\r\n\t\t\t});\r\n\t\t}\r\n\t\tconst animData = JSON.parse(serialized);\r\n\r\n\t\tconst animationData = {\r\n\t\t\tautoplay: this.operationData.autoplay,\r\n\t\t\tcontainer: this.operationData.selectedElement[0],\r\n\t\t\tloop: this.operationData.loop,\r\n\t\t\trenderer: this.operationData.renderer,\r\n\t\t\tanimationData:animData\r\n\t\t}\r\n\r\n\t\tthis.anim = lottie.loadAnimation(animationData);\r\n\t\tif (this.endPosition < 0) {\r\n\t\t\tthis.endPosition = this.anim.timeCompleted;\r\n\t\t}\r\n\r\n\t\tif (this.freezePosition > -1) {\r\n\t\t\tthis.anim.playSegments([0, this.freezePosition], true);\r\n\t\t}\r\n\t\tif (this.operationData.viewBox) {\r\n\t\t\tthis.operationData.selectedElement.find(\"svg\").attr('viewBox', this.operationData.viewBox);\r\n\t\t}\r\n\t}\r\n\r\n\tcreateTextDataLookup(data) {\r\n\t\tdata.forEach((infos, index) => {\r\n\t\t\tinfos.forEach((d) => {\r\n\t\t\t\tthis.labelData[this.operationData.labelIds[index]][d.code] = d.label;\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\thandleLanguageChange(code) {\r\n\t\tthis.currentLanguage = code;\r\n\t\tthis.createAnimation();\r\n\t}\r\n\r\n\tisIE() {\r\n\t\tconst isIE = false || !!document['documentMode'];\r\n\r\n\t\t// Edge 20+\r\n\t\tconst isEdge = !isIE && !!window['StyleMedia'];\r\n\r\n\t\treturn isEdge || isIE;\r\n\t}\r\n\r\n}\r\n\r\nexport default LottieController;\r\n","module.exports = __WEBPACK_EXTERNAL_MODULE__28__;","import $ from 'jquery';\r\n\r\nclass NavigationController {\r\n\r\n\tconstructor() {\r\n\t\tthis.name = 'NavigationController';\r\n\t\tthis.playerId = null;\r\n\t\tthis.navigation = null;\r\n\t\tthis.navLookup = {};\r\n\t\tthis.navVidIdLookup = {};\r\n\t\tthis.ctrlLookup = {};\r\n\t\tthis.activeNavigationPoint = null;\r\n\t\tthis.labelControllers = null;\r\n\t\tthis.eventhandlers = null;\r\n\t\tthis.eventbus = null;\r\n\t\tthis.container = null;\r\n\t}\r\n\r\n\tinit(operationData) {\r\n\t\tthis.container = operationData.selectedElement;\r\n\t\tthis.playerId = operationData.playerId;\r\n\t\tthis.navigation = this.buildNavigationData(operationData.json);\r\n\t}\r\n\r\n\tattach(eventbus) {\r\n\t\tthis.eventhandlers = [];\r\n\t\tthis.labelControllers = [];\r\n\t\tthis.eventhandlers.push(eventbus.on('navigate-to-video-url', this.handleNavigateVideoUrl.bind(this)));\r\n\t\tthis.eventhandlers.push(eventbus.on('highlight-navigation', this.highlightMenu.bind(this)));\r\n\t\tthis.eventhandlers.push(eventbus.on('request-current-navigation', this.handleRequestCurrentNavigation.bind(this)));\r\n\t\tthis.eventhandlers.push(eventbus.on('video-complete', this.handleVideoComplete.bind(this), this.playerId));\r\n\t\tthis.eventbus = eventbus;\r\n\r\n        this.buildHtml(this.container, this.navigation);\r\n        this.initHistory.bind(this);\r\n\t}\r\n\r\n\tinitHistory() {\r\n\t\tthis.activeNavigationPoint = this.navVidIdLookup[0];\r\n\t\tconst navId = this.getQueryVariable(0);\r\n\t\tlet videoIndex = 0;\r\n\t\tif (navId) {\r\n\t\t\tconst nav = this.navLookup[navId];\r\n\t\t\tvideoIndex = nav.videoUrlIndex;\r\n\t\t}\r\n\t\tthis.highlightMenu(videoIndex);\r\n\t}\r\n\r\n\tgetQueryVariable(variableIdx) {\r\n\t\tconst href = window.location.href;\r\n\t\tconst hashIndex = href.indexOf('#');\r\n\t\tif (hashIndex > -1) {\r\n\t\t\tconst query = href.substring(hashIndex + 2);\r\n\t\t\tif (query) {\r\n\t\t\t\tconst vars = query.split('/');\r\n\t\t\t\treturn vars[variableIdx];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\thandleRequestCurrentNavigation(resultCallback) {\r\n\t\tresultCallback({\r\n\t\t\tnavigationData: this.activeNavigationPoint,\r\n\t\t\ttitle: this.ctrlLookup[this.activeNavigationPoint.labelId].labelData[this.ctrlLookup[this.activeNavigationPoint.labelId].currentLanguage]\r\n\t\t});\r\n\t}\r\n\r\n\t detach(eventbus) {\r\n\t\tif (this.eventhandlers) {\r\n\t\t\tthis.eventhandlers.forEach((handler) => {\r\n\t\t\t\thandler();\r\n\t\t\t});\r\n\t\t}\r\n\t\tthis.labelControllers.forEach((ctrl) => {\r\n\t\t\tctrl.detach(eventbus);\r\n\t\t});\r\n\t\tthis.labelControllers.length = 0;\r\n\t\tthis.eventbus = null;\r\n\t\tthis.container = null;\r\n\t\twindow.onpopstate = null;\r\n\t}\r\n\r\n\tpushCurrentState(position = -1) {\r\n\t\tconst state = {\r\n\t\t\tnavigationData: this.activeNavigationPoint,\r\n\t\t\ttitle: this.ctrlLookup[this.activeNavigationPoint.labelId].labelData[this.ctrlLookup[this.activeNavigationPoint\r\n\t\t\t\t.labelId].currentLanguage]\r\n\t\t};\r\n\t\tif (position > -1) {\r\n\t\t\tstate.position = position;\r\n\t\t}\r\n\t\tthis.eventbus.broadcast('push-history-state',[state]);\r\n\t}\r\n\r\n\tbuildHtml(parentElm, data) {\r\n\t\tconst ul = $('<ul/>');\r\n\t\tdata.forEach(this.addNavElement.bind(this, ul));\r\n\t\tparentElm.append(ul);\r\n\t}\r\n\r\n\taddNavElement(parentElm, data) {\r\n\t\tif (data.visible) {\r\n\t\t\tconst li = $('<li/>');\r\n\t\t\tconst a = $(`<a href='javascript:;' id='nav_${data.videoUrlIndex}'/>`);\r\n\t\t\tli.append(a);\r\n\t\t\tthis.addLabel(a, data.labelId);\r\n\t\t\tthis.addClickHandler(a, data.videoUrlIndex);\r\n\t\t\tif (data.children) {\r\n\t\t\t\tconst ul = $('<ul/>');\r\n\t\t\t\tdata.children.forEach(this.addNavElement.bind(this, ul));\r\n\t\t\t\tli.append(ul);\r\n\t\t\t}\r\n\t\t\tparentElm.append(li);\r\n\t\t}\r\n\t}\r\n\r\n\taddClickHandler(parentElm, videoIndex) {\r\n\t\tparentElm.mouseup(this.menuMouseupHandler.bind(this, videoIndex));\r\n\t}\r\n\r\n\tmenuMouseupHandler(videoIndex) {\r\n\t\tconst navdata = this.navVidIdLookup[videoIndex];\r\n\t\tif (navdata) {\r\n\t\t\tthis.eventbus.broadcast('request-video-url', [navdata.videoUrlIndex]);\r\n\t\t\tthis.handleNavigateVideoUrl(navdata.videoUrlIndex);\r\n\t\t}\r\n\t}\r\n\r\n\thandleNavigateVideoUrl(index, requestedVideoPosition) {\r\n        requestedVideoPosition = (requestedVideoPosition) ? requestedVideoPosition : 0;\r\n\t\tthis.highlightMenu(index);\r\n\t\tthis.eventbus.broadcast('request-video-url', [index, requestedVideoPosition]);\r\n\t\tthis.activeNavigationPoint = this.navVidIdLookup[index];\r\n\t\tthis.pushCurrentState(requestedVideoPosition);\r\n\t}\r\n\r\n\thighlightMenu(index) {\r\n\t\tconst navElm = $(`#nav_${index}`);\r\n\t\tif (navElm.length) {\r\n\t\t\t$('.current-menu-item').removeClass('current-menu-item');\r\n\t\t\tnavElm.addClass('current-menu-item');\r\n\t\t}\r\n\t}\r\n\r\n\thandleVideoComplete(index) {\r\n\t\tconsole.log('Navigation controller received video complete');\r\n\t\tconst navData = this.navVidIdLookup[index];\r\n\t\tif (navData.autoNext) {\r\n\t\t\tconsole.log('NavigationController.handleVideoComplete - request-video-url: ' + navData.next.videoUrlIndex);\r\n\t\t\tthis.eventbus.broadcast('request-video-url', [navData.next.videoUrlIndex]);\r\n\t\t} else {\r\n\t\t\tconsole.log('handleVideoComplete - request-video-cleanup');\r\n\t\t\tthis.eventbus.broadcast('request-video-cleanup');\r\n\t\t}\r\n\t}\r\n\r\n\taddLabel(parentElm, labelId) {\r\n\t\tconst data = {\r\n\t\t\t\tselectedElement: parentElm,\r\n\t\t\t\tlabelId: labelId\r\n\t\t\t};\r\n\t\tconst resultCallback = (instance)=> {\r\n            instance.init(data);\r\n            instance.attach(this.eventbus);\r\n            this.labelControllers.push(instance);\r\n            this.ctrlLookup[labelId] = instance;\r\n\t\t};\r\n\t\tthis.eventbus.broadcast('request-instance', ['LabelController', resultCallback]);\r\n\t}\r\n\r\n\tbuildNavigationData(data) {\r\n\t\tconst result = [];\r\n\t\tdata.navigationData.forEach((nav, index) => {\r\n\t\t\tthis.navLookup[nav.id] = nav;\r\n\t\t\tthis.navVidIdLookup[nav.videoUrlIndex] = nav;\r\n\t\t\tnav.previous = data.navigationData[index - 1];\r\n\t\t});\r\n\r\n\t\tdata.navigationData.forEach((nav, index) => {\r\n\t\t\tif (nav.nextId) {\r\n\t\t\t\tnav.next = this.navLookup[nav.nextId];\r\n\t\t\t\tdelete nav.nextId;\r\n\t\t\t} else {\r\n\t\t\t\tnav.next = data.navigationData[index + 1];\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tdata.roots.forEach((id) => {\r\n\t\t\tconst nav = this.navLookup[id];\r\n\t\t\tif (nav.children) {\r\n\t\t\t\tnav.children = nav.children.map((id) => {\r\n\t\t\t\t\treturn this.navLookup[id];\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tresult.push(nav);\r\n\t\t});\r\n\t\treturn result;\r\n\t}\r\n}\r\n\r\nexport default NavigationController;\r\n","import TimelineEventNames from \"../timeline-event-names\";\r\n\r\nclass ProgressbarController {\r\n\r\n\tconstructor() {\r\n\t\tthis.selectedElement = null;\r\n\t\tthis.textElement = null;\r\n\t\tthis.detachers = [];\r\n\t\tthis.name = \"ProgressbarController\";\r\n\t}\r\n\r\n\tinit(operationData) {\r\n\t\tthis.selectedElement = operationData.selectedElement;\r\n\t\tthis.playerId = operationData.playerId;\r\n\t\tthis.textElement = operationData.textElement;\r\n\t}\r\n\r\n\tattach(eventbus) {\r\n\t\tthis.detachers.push(eventbus.on(TimelineEventNames.POSITION_UPDATE, this.positionUpdateHandler.bind(this), this.playerId));\r\n\t\tconst clickHandler = this.clickHandler.bind(this);\r\n\t\tthis.selectedElement.on(\"click\", clickHandler);\r\n\t\tthis.detachers.push(()=> this.selectedElement.off(\"click\"), clickHandler);\r\n\t}\r\n\r\n\tdetach(eventbus) {\r\n\t\tthis.detacher.forEach((func)=> {\r\n\t\t\tfunc();\r\n\t\t});\r\n\t}\r\n\r\n\tpositionUpdateHandler(position, duration) {\r\n\t\tlet perc = (100 / duration) * position;\r\n\t\tif (this.selectedElement) {\r\n\t\t\tthis.selectedElement.css(\"width\", `${perc}%`);\r\n\t\t}\r\n\t\tperc = Math.floor(perc);\r\n\t\tif (this.textElement) {\r\n\t\t\tthis.textElement.text(`${perc}%`);\r\n\t\t}\r\n\t}\r\n\r\n\tclickHandler() {\r\n\r\n\t}\r\n}\r\n\r\nexport default ProgressbarController;\r\n","class RoutingController {\r\n\r\n\tconstructor() {\r\n\t\tthis.navLookup = {};\r\n\t\tthis.navVidIdLookup = {};\r\n\t\tthis.playerId = null;\r\n\t\tthis.navigation = null;\r\n\t\tthis.eventhandlers = [];\r\n\t\tthis.eventbus = null;\r\n\t\tthis.name = \"RoutingController\";\r\n\t}\r\n\r\n\tinit(operationData) {\r\n\t\tthis.navigation = this.buildNavigationData(operationData.json);\r\n\t\tthis.playerId = operationData.playerId;\r\n\t}\r\n\r\n\tattach(eventbus) {\r\n\t\tthis.eventhandlers.push(eventbus.on(\"before-request-video-url\", this.handleBeforeRequestVideoUrl.bind(this)));\r\n\t\tthis.eventhandlers.push(eventbus.on(\"push-history-state\", this.handlePushHistoryState.bind(this)));\r\n\t\tthis.eventbus = eventbus;\r\n\t\twindow.onpopstate = this.handlePopstate.bind(this);\r\n\r\n\t\tconst navId = this.getQueryVariable(0);\r\n\t\tif (navId) {\r\n\t\t\tconst nav = this.navLookup[navId];\r\n\t\t\tlet pos = this.getQueryVariable(1);\r\n\t\t\tpos = (pos) ? +pos : 0;\r\n\t\t\tthis.eventbus.broadcast(\"request-video-url\", [nav.videoUrlIndex, pos, true]);\r\n\t\t} else {\r\n\t\t\twindow.history.pushState({ navigationId: this.navigation[0].id },\r\n\t\t\t\t\"\",\r\n\t\t\t\t`#/${this.navigation[0].id}`);\r\n\t\t}\r\n\t}\r\n\r\n\thandlePopstate(event) {\r\n\t\tconst navigationId = (event.state) ? event.state.navigationId : this.navigation[0].id;\r\n\t\tconst position = (event.state) ? event.state.position : 0;\r\n\t\tconst nav = this.navLookup[navigationId];\r\n\t\tthis.eventbus.broadcast(\"highlight-navigation\", [nav.videoUrlIndex]);\r\n\t\tthis.eventbus.broadcast(\"request-video-url\", [nav.videoUrlIndex, position, true]);\r\n\t}\r\n\r\n\tdetach(eventbus) {\r\n\t\tif (this.eventhandlers) {\r\n\t\t\tthis.eventhandlers.forEach((handler) => {\r\n\t\t\t\thandler();\r\n\t\t\t});\r\n\t\t}\r\n\t\tthis.eventbus = null;\r\n\t}\r\n\r\n\thandleBeforeRequestVideoUrl(index, requestedVideoPosition, isHistoryRequest) {\r\n        requestedVideoPosition = (requestedVideoPosition) ? requestedVideoPosition : 0;\r\n        isHistoryRequest = (isHistoryRequest !== undefined) ? isHistoryRequest : false;\r\n\t\tif (!isHistoryRequest) {\r\n            const resultCallback = (item)=> {\r\n                this.pushState(item);\r\n            };\r\n\t\t\tthis.eventbus.broadcast(\"request-current-navigation\", [resultCallback]);\r\n\t\t}\r\n\t}\r\n\r\n\tgetQueryVariable(variableIdx) {\r\n\t\tconst href = window.location.href;\r\n\t\tconst hashIndex = href.indexOf(\"#\");\r\n\t\tif (hashIndex > -1) {\r\n\t\t\tconst query = href.substring(hashIndex + 2);\r\n\t\t\tif (query) {\r\n\t\t\t\tconst vars = query.split(\"/\");\r\n\t\t\t\treturn vars[variableIdx];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\thandlePushHistoryState(state) {\r\n\t\tthis.pushState(state);\r\n\t}\r\n\r\n\tpushState(state) {\r\n\t\tif ((state) && (state.navigationData) && (state.navigationData.visible)) {\r\n\t\t\tlet currentPosition = (state.position !== undefined) ? state.position : -1;\r\n\t\t\tif (currentPosition < 0) {\r\n\t\t\t\tconst resultCallback = (position)=> {\r\n                    currentPosition = (position > 3) ? (position - 3) : 0;\r\n                };\r\n\t\t\t\tthis.eventbus.broadcast(\"request-current-video-position\", [resultCallback]);\r\n\t\t\t}\r\n\r\n\t\t\tconst currentState = window.history.state;\r\n\t\t\tif ((currentState) && (currentState.navigationId !== state.navigationData.id)) {\r\n\t\t\t\twindow.history.pushState({ navigationId: state.navigationData.id, position: currentPosition },\r\n\t\t\t\t\tstate.title,\r\n\t\t\t\t\t`#/${state.navigationData.id}/${currentPosition}`);\r\n\t\t\t} else if ((currentState) && (currentState.navigationId === state.navigationData.id)) {\r\n\t\t\t\twindow.history.replaceState({ navigationId: currentState.navigationId, position: currentPosition },\r\n\t\t\t\t\tstate.title,\r\n\t\t\t\t\t`#/${currentState.navigationId}/${currentPosition}`);\r\n\t\t\t} else {\r\n\t\t\t\twindow.history.pushState({ navigationId: state.navigationData.id, position: currentPosition },\r\n\t\t\t\t\tstate.title,\r\n\t\t\t\t\t`#/${state.navigationData.id}/${currentPosition}`);\r\n\t\t\t}\r\n\t\t\twindow.document.title = state.title;\r\n\t\t}\r\n\t}\r\n\r\n\tbuildNavigationData(data) {\r\n\t\tconst result = [];\r\n\t\tdata.navigationData.forEach((nav, index) => {\r\n\t\t\tthis.navLookup[nav.id] = nav;\r\n\t\t\tthis.navVidIdLookup[nav.videoUrlIndex] = nav;\r\n\t\t\tnav.previous = data.navigationData[index - 1];\r\n\t\t});\r\n\r\n\t\tdata.navigationData.forEach((nav, index) => {\r\n\t\t\tif (nav.nextId) {\r\n\t\t\t\tnav.next = this.navLookup[nav.nextId];\r\n\t\t\t\tdelete nav.nextId;\r\n\t\t\t} else {\r\n\t\t\t\tnav.next = data.navigationData[index + 1];\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tdata.roots.forEach((id) => {\r\n\t\t\tconst nav = this.navLookup[id];\r\n\t\t\tif (nav.children) {\r\n\t\t\t\tnav.children = nav.children.map((id) => {\r\n\t\t\t\t\treturn this.navLookup[id];\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tresult.push(nav);\r\n\t\t});\r\n\t\treturn result;\r\n\t}\r\n\r\n}\r\n\r\nexport default RoutingController;\r\n","class SubtitlesController {\r\n\r\n\tconstructor() {\r\n\t\tthis.actionLookup = null;\r\n\t\tthis.currentLanguage = null;\r\n\t\tthis.lastFunc = null;\r\n\t\tthis.name = \"SubtitlesController\";\r\n\t}\r\n\r\n\tattach(eventbus) {\r\n\t\tconst detachTime = eventbus.on(\"time\", this.onTimeHandler.bind(this));\r\n\t\tconst detachLangChange = eventbus.on(\"language-change\", this.languageChangeHandler.bind(this));\r\n\t\tthis.internalDetach = this.internalDetach.bind(this, [detachTime, detachLangChange]);\r\n\t}\r\n\r\n\tdetach(eventbus) {\r\n\t\tthis.internalDetach();\r\n\t}\r\n\r\n\tinternalDetach(detachMethods) {\r\n\t\tif (detachMethods) {\r\n\t\t\tdetachMethods.forEach((f) => {\r\n\t\t\t\tf();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tlanguageChangeHandler(newLanguage) {\r\n\t\tthis.currentLanguage = newLanguage;\r\n\t\tif (this.lastFunc) {\r\n\t\t\tthis.lastFunc();\r\n\t\t}\r\n\t}\r\n\r\n\tremoveTitle(container) {\r\n\t\tcontainer.text(\"\");\r\n\t\tthis.lastFunc = null;\r\n\t}\r\n\r\n\tonTimeHandler(position) {\r\n\t\tconst func = this.actionLookup[position];\r\n\t\tif (func) {\r\n\t\t\tfunc();\r\n\t\t\tthis.lastFunc = func;\r\n\t\t}\r\n\t}\r\n\r\n\tsetTitle(container, titleLanguageLookup) {\r\n\t\tcontainer.text(titleLanguageLookup[this.currentLanguage]);\r\n\t}\r\n\r\n\tcreateActionLookup(controllerData, container) {\r\n\t\tconst subtitleData = controllerData.subtitleData;\r\n\t\tconst titles = subtitleData[0].titles;\r\n\t\tconst subtitleTimeLookup = {};\r\n\t\tfor (let i = 0, ii = titles.length; i < ii; i++) {\r\n\t\t\tconst titleLanguageLookup = {};\r\n\t\t\tfor (let j = 0, jj = subtitleData.length; j < jj; j++) {\r\n\t\t\t\tconst subs = subtitleData[j];\r\n\t\t\t\ttitleLanguageLookup[subs.lang] = subs.titles[i].text;\r\n\t\t\t}\r\n\t\t\tsubtitleTimeLookup[titles[i].duration.start] = this.setTitle.bind(this, container, titleLanguageLookup);\r\n\t\t\tsubtitleTimeLookup[titles[i].duration.end] = this.removeTitle;\r\n\t\t}\r\n\t\treturn subtitleTimeLookup;\r\n\t}\r\n\r\n\tinit(controllerData) {\r\n\t\tconst container = controllerData.selectedElement;\r\n\t\tthis.removeTitle = this.removeTitle.bind(this, container);\r\n\t\tthis.currentLanguage = controllerData.language;\r\n\t\tthis.actionLookup = this.createActionLookup(controllerData, container);\r\n\t}\r\n}\r\n\r\nexport default SubtitlesController;\r\n","export { default as addClass } from './addClass';\r\nexport { default as addControllerToElement } from './addControllerToElement';\r\nexport { default as addOptionList } from './addOptionList';\r\nexport { default as animate } from './animate';\r\nexport { default as animateWithClass } from './animateWithClass';\r\nexport { default as broadcastEvent } from './broadcastEvent';\r\nexport { default as clearElement } from './clearElement';\r\nexport { default as clearOperationData } from './clearOperationData';\r\nexport { default as customFunction } from './customFunction';\r\nexport { default as endAction } from './endAction';\r\nexport { default as extendController } from './extendController';\r\nexport { default as getControllerFromElement } from './getControllerFromElement';\r\nexport { default as getControllerInstance } from './getControllerInstance';\r\nexport { default as getElementDimensions } from './getElementDimensions';\r\nexport { default as loadJSON } from './loadJSON';\r\nexport { default as removeClass } from './removeClass';\r\nexport { default as removeControllerFromElement } from './removeControllerFromElement';\r\nexport { default as removeElement } from './removeElement';\r\nexport { default as removePropertiesFromOperationData } from './removePropertiesFromOperationData';\r\nexport { default as reparentElement } from './reparentElement';\r\nexport { default as requestAction } from './requestAction';\r\nexport { default as resizeAction } from './resizeAction';\r\nexport { default as selectElement } from './selectElement';\r\nexport { default as setElementAttributes } from './setElementAttributes';\r\nexport { default as setElementContent } from './setElementContent';\r\nexport { default as setOperationData } from './setOperationData';\r\nexport { default as setStyle } from './setStyle';\r\nexport { default as startAction } from './startAction';\r\nexport { default as toggleClass } from './toggleClass';\r\nexport { default as toggleElement } from './toggleElement';\r\nexport { default as wait } from './wait';\r\n","function addClass(operationData, eventBus) {\r\n    const {selectedElement, className} = operationData;\r\n    selectedElement.addClass(className);\r\n    return operationData;\r\n}\r\n\r\nexport default addClass;\r\n","import attachControllerToElement from './helper/attachControllerToElement';\r\nimport internalResolve from './helper/internalResolve';\r\n\r\nfunction addControllerToElement(operationData, eventBus) {\r\n    const {selectedElement, controllerInstance} = operationData;\r\n    \r\n    attachControllerToElement(selectedElement, controllerInstance);\r\n    \r\n    controllerInstance.init(operationData);\r\n\r\n    const promise = controllerInstance.attach(eventBus);\r\n\r\n    if (promise) {\r\n        return new Promise((resolve, reject)=> {\r\n            promise.then((newOperationData) => {\r\n                internalResolve(resolve, operationData, newOperationData);\r\n            }, reject);\r\n        })\r\n    } else {\r\n        return operationData;\r\n    }\r\n}\r\n\r\nexport default addControllerToElement;\r\n","import { getElementControllers } from './getElementData';\r\n\r\nfunction attachControllerToElement(element, controller) {\r\n    if (!element.data('chronoEngineControllers')) {\r\n        element.data('chronoEngineControllers', []);\r\n    }\r\n    const controllers = getElementControllers(element);\r\n    controllers.push(controller);\r\n}\r\n\r\nexport default attachControllerToElement;\r\n","function createOptionElementText(valueProperty, labelProperty, defaultIndex, defaultValue, data, index) {\r\n    let selected = '';\r\n    if (defaultValue) {\r\n        selected = (data[valueProperty] === defaultValue) ? ' selected' : '';\r\n    } else if (defaultIndex) {\r\n        selected = (index === defaultIndex) ? ' selected' : '';\r\n    }\r\n    return `<option value='${data[valueProperty]}'${selected}>${data[labelProperty]}</option>`;\r\n}\r\n\r\nfunction addOptionList(operationData, eventBus) {\r\n    const { valueProperty, labelProperty, defaultIndex, defaultValue, optionData, selectedElement } = operationData;\r\n\r\n    const createOption = createOptionElementText.bind(null, valueProperty, labelProperty, defaultIndex, defaultValue);\r\n\r\n    const optionElements = optionData.map(createOption);\r\n\r\n    selectedElement.html(optionElements);\r\n\r\n    return operationData;\r\n}\r\n\r\nexport default addOptionList;\r\n","import internalResolve from './helper/internalResolve';\r\n\r\nfunction animate(operationData, eventBus) {\r\n    const {animationEasing, selectedElement, animationProperties, animationDuration} = operationData;\r\n    const promise = new Promise((resolve, reject)=> {\r\n        try{\r\n            if (animationEasing) {\r\n                selectedElement.animate(animationProperties,\r\n                    animationDuration,\r\n                    animationEasing,\r\n                    () => {\r\n                        internalResolve(resolve, {}, operationData);\r\n                    });\r\n            } else {\r\n                selectedElement.animate(animationProperties,\r\n                    animationDuration,\r\n                    () => {\r\n                        internalResolve(resolve, {}, operationData);\r\n                    });\r\n            }\r\n        } catch(e){\r\n            reject(e);\r\n        }\r\n    });\r\n    return promise;\r\n}\r\n\r\nexport default animate;\r\n","import internalResolve from './helper/internalResolve';\r\n\r\nfunction animateWithClass(operationData, eventBus) {\r\n    let {selectedElement, className, removeClass } = operationData;\r\n    removeClass = (removeClass !== undefined) ? removeClass : true;\r\n\r\n    const promise = new Promise((resolve, reject)=> {\r\n        try{\r\n            selectedElement.one(\"webkitAnimationEnd oanimationend oAnimationEnd msAnimationEnd animationEnd\",\r\n            () => {\r\n                if (removeClass) {\r\n                    selectedElement.removeClass(className);\r\n                }\r\n                internalResolve(resolve, {}, operationData);\r\n            });\r\n        } catch(e){\r\n            reject(e);\r\n        }\r\n    });\r\n\r\n    selectedElement.addClass(className);\r\n\r\n    return promise;\r\n}\r\n\r\nexport default animateWithClass;\r\n","import resolveEventArguments from './helper/resolveEventArguments';\r\nimport removeEventDataFromOperationData from './helper/removeEventDataFromOperationData';\r\n\r\nfunction broadcastEvent(operationData, eventBus) {\r\n    const {eventArgs, eventTopic, eventName} = operationData;\r\n\r\n    const eventArguments = resolveEventArguments(operationData, eventArgs);\r\n    \r\n    if (eventTopic) {\r\n        eventBus.broadcastForTopic(eventName, eventTopic, eventArguments);\r\n    } else {\r\n        eventBus.broadcast(eventName, eventArguments);\r\n    }\r\n\r\n    removeEventDataFromOperationData(operationData);\r\n}\r\n\r\nexport default broadcastEvent;\r\n","import extractOperationDataArgumentValues from './extractOperationDataArgumentValues';\r\n\r\nfunction resolveEventArguments(operationData, eventArgs) {\r\n    if (!eventArgs) {\r\n        return;\r\n    }\r\n    const extract = extractOperationDataArgumentValues.bind(null, operationData);\r\n    return eventArgs.map(extract);\r\n}\r\n\r\nexport default resolveEventArguments;\r\n","function removeEventDataFromOperationData(operationData) {\r\n    delete operationData.eventName;\r\n    delete operationData.eventTopic;\r\n    delete operationData.eventArgs;\r\n}\r\n\r\nexport default removeEventDataFromOperationData;\r\n","function clearElement(operationData, eventBus) {\r\n    const {selectedElement} = operationData;\r\n    selectedElement.empty();\r\n    return operationData;\r\n}\r\n\r\nexport default clearElement;\r\n","function clearOperationData(operationData, eventBus) {\r\n    return {};\r\n}\r\n\r\nexport default clearOperationData;\r\n","import internalResolve from './helper/internalResolve';\r\nimport TimelineEventNames from '../timeline-event-names';\r\n\r\nfunction customFunction(operationData, eventBus) {\r\n    const {systemName} = operationData;\r\n    return new Promise((resolve, reject) => {\r\n        const resultCallback = (func)=> {\r\n            const promise = func(operationData, eventBus);\r\n            if (promise) {\r\n                promise.then(() => {\r\n                    internalResolve(resolve, {}, operationData);\r\n                }, reject);\r\n            } else {\r\n                internalResolve(resolve, {}, operationData);\r\n            }\r\n        };\r\n        eventBus.broadcast(TimelineEventNames.REQUEST_FUNCTION, [systemName, resultCallback]);\r\n    });\r\n}\r\n\r\nexport default customFunction;\r\n","import mergeOperationData from './helper/mergeOperationData';\r\nimport internalResolve from './helper/internalResolve';\r\n\r\nfunction endAction(operationData, eventBus) {\r\n    const {actionInstance, actionOperationData} = operationData;\r\n    delete operationData.actionOperationData;\r\n    return new Promise((resolve, reject)=> {\r\n        const mergedData = mergeOperationData(operationData, actionOperationData);\r\n        actionInstance.end(mergedData).then(() => {\r\n            internalResolve(resolve, operationData);\r\n        }, reject);\r\n    });\r\n}\r\n\r\nexport default endAction;\r\n","function extendController(operationData, eventBus) {\r\n    const { controllerInstance, controllerExtension } = operationData;\r\n    \r\n    operationData.controllerInstance = Object.assign(controllerInstance, controllerExtension);\r\n    \r\n    return operationData;\r\n}\r\n\r\nexport default extendController;\r\n","import { getElementControllers } from './helper/getElementData';\r\n\r\nfunction getControllerFromElement(operationData, eventBus) {\r\n    const {selectedElement, controllerName} = operationData;\r\n    const controllers = getElementControllers(selectedElement);\r\n    let controller = null;\r\n    controllers.some((ctrl) => {\r\n        if (ctrl.name === controllerName) {\r\n            controller = ctrl;\r\n            return true;\r\n        }\r\n        return false;\r\n    });\r\n    if (!controller) {\r\n        console.warn(`controller for name '${controllerName}' was not found on the given element`);\r\n    }\r\n    operationData.controllerInstance = controller;\r\n    return operationData;\r\n}\r\n\r\nexport default getControllerFromElement;\r\n","import TimelineEventNames from '../timeline-event-names';\r\n\r\nfunction getControllerInstance(operationData, eventBus) {\r\n    const {systemName} = operationData;\r\n    let {propertyName} = operationData;\r\n    \r\n    propertyName = propertyName || \"controllerInstance\";\r\n    const resultCallback = (instance)=> {\r\n        operationData[propertyName] = instance;\r\n    }\r\n    eventBus.broadcast(TimelineEventNames.REQUEST_INSTANCE, [systemName, resultCallback]);\r\n    return operationData;\r\n}\r\n\r\nexport default getControllerInstance;\r\n","import modifyDimensions from './helper/modifyDimensions';\r\n\r\nfunction getElementDimensions(operationData, eventBus) {\r\n    let {selectedElement, dimensions, modifier} = operationData;\r\n    dimensions = dimensions || {};\r\n    dimensions.width = selectedElement.innerWidth();\r\n    dimensions.height = selectedElement.innerHeight();\r\n    if (dimensions.height === 0) {\r\n        dimensions.height = dimensions.width;\r\n    }\r\n    if (modifier) {\r\n        modifyDimensions(dimensions, modifier);\r\n    }\r\n    operationData.dimensions = dimensions;\r\n    return operationData;\r\n}\r\n\r\nexport default getElementDimensions;\r\n","function modifyDimensionsByRatio(ratioModifier, dimensions) {\r\n    //h[ar=8-1]\r\n    let prefix = ratioModifier.substr(0, 1);\r\n    let ratio = ratioModifier.substr(ratioModifier.indexOf('[') + 1, ratioModifier.indexOf(']') - ratioModifier.indexOf('[') - 1);\r\n    let ratios = ratio.split('=')[1].split('-');\r\n    if (prefix === 'h') {\r\n        dimensions.height = (dimensions.width / +ratios[0]) * +ratios[1];\r\n    } else if (prefix === 'w') {\r\n        dimensions.width = (dimensions.height / +ratios[1]) * +ratios[0];\r\n    }\r\n}\r\n\r\nfunction getModifierSuffix(modifier) {\r\n    let endIdx = 1;\r\n    let suffix = modifier.substr(modifier.length - 1, 1);\r\n    if ((suffix !== 'h') && (suffix !== 'w') && (suffix !== '%')) {\r\n        suffix = null;\r\n    }\r\n    const isPercent = (suffix === '%');\r\n    if (isPercent) {\r\n        endIdx = 2;\r\n        suffix = modifier.substr(modifier.length - endIdx, 1);\r\n        if ((suffix !== 'h') && (suffix !== 'w')) {\r\n            suffix = null;\r\n            endIdx = 1;\r\n        }\r\n    }\r\n    return [suffix, endIdx, isPercent];\r\n}\r\n\r\nfunction _modifyDimensions(dimensions, prefix, suffix, widthModifier, heightModifier) {\r\n    switch (prefix) {\r\n        case '+':\r\n            switch (suffix) {\r\n                case 'h':\r\n                    dimensions.height += heightModifier;\r\n                    break;\r\n                case 'w':\r\n                    dimensions.width += widthModifier;\r\n                    break;\r\n                default:\r\n                    dimensions.height += heightModifier;\r\n                    dimensions.width += widthModifier;\r\n            }\r\n            break;\r\n        case '-':\r\n            switch (suffix) {\r\n                case 'h':\r\n                    dimensions.height -= heightModifier;\r\n                    break;\r\n                case 'w':\r\n                    dimensions.width -= widthModifier;\r\n                    break;\r\n                default:\r\n                    dimensions.height -= heightModifier;\r\n                    dimensions.width -= widthModifier;\r\n            }\r\n            break;\r\n        case '/':\r\n            switch (suffix) {\r\n                case 'h':\r\n                    dimensions.height /= heightModifier;\r\n                    break;\r\n                case 'w':\r\n                    dimensions.width /= widthModifier;\r\n                    break;\r\n                default:\r\n                    dimensions.height /= heightModifier;\r\n                    dimensions.width /= widthModifier;\r\n            }\r\n            break;\r\n        case '*':\r\n            switch (suffix) {\r\n                case 'h':\r\n                    dimensions.height *= heightModifier;\r\n                    break;\r\n                case 'w':\r\n                    dimensions.width *= widthModifier;\r\n                    break;\r\n                default:\r\n                    dimensions.height *= heightModifier;\r\n                    dimensions.width *= widthModifier;\r\n            }\r\n            break;\r\n        default:\r\n            console.error(`Unknown operator found: ${prefix}`);\r\n    }\r\n    return dimensions;\r\n}\r\n\r\nfunction modifyDimensions(dimensions, modifier) {\r\n    let ratioModifier = null;\r\n    if (modifier.indexOf('|') > -1) {\r\n        [modifier, ratioModifier] = modifier.split('|');\r\n    }\r\n\r\n    const prefix = modifier.substr(0, 1);\r\n    let [suffix, endIdx, isPercent] = getModifierSuffix(modifier);\r\n\r\n    const value = parseInt((suffix !== null) ? modifier.substr(1, modifier.length - endIdx - 1) : modifier.substr(1, modifier.length), 10);\r\n\r\n    let widthModifier = value;\r\n    let heightModifier = value;\r\n    if (isPercent) {\r\n        widthModifier = (dimensions.width / 100) * value;\r\n        heightModifier = (dimensions.height / 100) * value;\r\n    }\r\n\r\n    dimensions = _modifyDimensions(dimensions, prefix, suffix, widthModifier, heightModifier);\r\n\r\n    if (ratioModifier) {\r\n        modifyDimensionsByRatio(ratioModifier, dimensions)\r\n    }\r\n}\r\n\r\nexport default modifyDimensions;","function loadJSON(jsonCache, operationData, eventBus) {\r\n    const {url, cache} = operationData;\r\n\r\n    let { propertyName } = operationData;\r\n    propertyName = propertyName || \"json\";\r\n\r\n    if (cache && jsonCache[url]) {\r\n        operationData[propertyName] = jsonCache[url];\r\n        return operationData;\r\n    }\r\n\r\n\r\n    return new Promise((resolve, reject)=> {\r\n        fetch(url)\r\n        .then((response)=> {\r\n            jsonCache[url] = operationData[propertyName] = response.body;\r\n            resolve(operationData);\r\n        })\r\n        .catch(reject);\r\n    });\r\n}\r\n\r\nexport default loadJSON.bind(null, {});\r\n","function removeClass(operationData, eventBus) {\r\n    const {selectedElement, className} = operationData;\r\n    selectedElement.removeClass(className);\r\n    return operationData;\r\n}\r\n\r\nexport default removeClass;\r\n","import {getElementControllers} from './helper/getElementData';\r\n\r\nfunction removeControllerFromElement(operationData, eventBus) {\r\n    const {selectedElement, controllerName} = operationData;\r\n\r\n    const controllers = getElementControllers(selectedElement);\r\n    if (controllers) {\r\n        let controller = null;\r\n        controllers.some((ctrl) => {\r\n            if (ctrl.name === controllerName) {\r\n                controller = ctrl;\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n        if (controller) {\r\n            const idx = controllers.indexOf(controller);\r\n            if (idx > -1) {\r\n                controllers.splice(idx, 1);\r\n            }\r\n            controller.detach(eventBus);\r\n        }\r\n    }\r\n    return operationData;\r\n}\r\n\r\nexport default removeControllerFromElement;\r\n","export function removeElement(operationData, eventBus) {\r\n    operationData.selectedElement.remove();\r\n    return operationData;\r\n}\r\n\r\nexport default removeElement;\r\n","function removePropertiesFromOperationData(operationData, eventBus) {\r\n    const {\r\n        propertyNames\r\n    } = operationData;\r\n\r\n    propertyNames.forEach(name => {\r\n        delete operationData[name];\r\n    });\r\n    delete operationData.propertyNames;\r\n    return operationData;\r\n}\r\n\r\nexport default removePropertiesFromOperationData;","function reparentElement(operationData, eventBus) {\r\n    const {selectedElement, newParentSelector} = operationData;\r\n    selectedElement.remove().appendTo(newParentSelector);\r\n}\r\n\r\nexport default reparentElement;\r\n","import TimelineEventNames from '../timeline-event-names';\r\n\r\nfunction requestAction(operationData, eventBus) {\r\n        const { actionName } = operationData;\r\n\r\n        const resultCallback = (action) => {\r\n            operationData.actionInstance = action;\r\n        };\r\n        eventBus.broadcast(TimelineEventNames.REQUEST_ACTION, [actionName, resultCallback]);\r\n        return operationData;\r\n}\r\n\r\nexport default requestAction;\r\n","import mergeOperationData from './helper/mergeOperationData';\r\n\r\nfunction resizeAction(operationData, eventBus) {\r\n    const {actionInstance, actionOperationData} = operationData;\r\n    operationData = mergeOperationData(operationData, actionOperationData);\r\n    if (actionInstance.resize) {\r\n        return actionInstance.resize(operationData);\r\n    }\r\n    return operationData;\r\n}\r\n\r\nexport default resizeAction;\r\n","import TimelineEventNames from '../timeline-event-names';\r\n\r\nfunction findElementBySelector(root, selector, operationData, propertyName) {\r\n    const element = root.find(selector);\r\n    if (!element.length) {\r\n        console.warn(`selector '${selector}' wasn't found!`);\r\n    }\r\n    operationData[propertyName] = element;\r\n    if (operationData.hasOwnProperty(\"propertyName\")) {\r\n        delete operationData.propertyName;\r\n    }\r\n}\r\n\r\nfunction selectElement(operationData, eventBus) {\r\n    let {selector, propertyName, useExistingAsRoot} = operationData;\r\n\r\n    if (!selector) {\r\n        throw new Error(\"selector is undefined!\");\r\n    }\r\n    propertyName = (propertyName) ? propertyName : \"selectedElement\";\r\n\r\n    if (useExistingAsRoot && operationData[propertyName]) {\r\n        const currentRoot = operationData[propertyName];\r\n        findElementBySelector(currentRoot, selector, operationData, propertyName);\r\n        return operationData;\r\n    }\r\n\r\n    const rootCallback = (root)=> {\r\n        findElementBySelector(root, selector, operationData, propertyName);\r\n    };\r\n    eventBus.broadcast(TimelineEventNames.REQUEST_ENGINE_ROOT, [rootCallback]);\r\n    return operationData;\r\n}\r\n\r\nexport default selectElement;\r\n","function setElementAttributes(operationData, eventBus) {\r\n    const {attributes, selectedElement} = operationData;\r\n    for (let attrName in attributes) {\r\n        if (attributes.hasOwnProperty(attrName)) {\r\n            selectedElement.attr(attrName, attributes[attrName]);\r\n        }\r\n    }\r\n    return operationData;\r\n}\r\n\r\nexport default setElementAttributes;\r\n","function setElementContent(operationData, eventBus) {\r\n    const {append, selectedElement, template} = operationData;\r\n    if (!append) {\r\n        selectedElement.html(template);\r\n    } else {\r\n        selectedElement.append(template);\r\n    }\r\n    return operationData;\r\n}\r\n\r\nexport default setElementContent;\r\n","import resolvePropertyValues from './helper/resolvePropertyValues';\r\n\r\nfunction setOperationData(operationData, eventBus) {\r\n    const properties = resolvePropertyValues(operationData, operationData.properties);\r\n    operationData = Object.assign(operationData, properties);\r\n    delete operationData.properties;\r\n    return operationData;\r\n}\r\n\r\nexport default setOperationData;\r\n","import resolvePropertyValues from './helper/resolvePropertyValues';\r\n\r\nfunction setStyle(operationData, eventBus) {\r\n    const properties = resolvePropertyValues(operationData, operationData.properties);\r\n    operationData.selectedElement.css(properties);\r\n    return operationData;\r\n}\r\n\r\nexport default setStyle;\r\n","import mergeOperationData from './helper/mergeOperationData';\r\nimport internalResolve from './helper/internalResolve';\r\n\r\nfunction startAction(operationData, eventBus) {\r\n    const {actionInstance, actionOperationData} = operationData;\r\n    return new Promise((resolve, reject)=> {\r\n        operationData = mergeOperationData(operationData, actionOperationData);\r\n        actionInstance.start(operationData).then(() => {\r\n            internalResolve(resolve, operationData);\r\n        }, reject);\r\n    });\r\n}\r\n\r\nexport default startAction;\r\n","function toggleClass(operationData, eventBus) {\r\n    const {selectedElement, className} = operationData;\r\n    selectedElement.toggleClass(className);\r\n    return operationData;\r\n}\r\n\r\nexport default toggleClass;\r\n","function toggleElement(operationData, eventBus) {\r\n    operationData.selectedElement.toggle();\r\n    return operationData;\r\n}\r\n\r\nexport default toggleElement;\r\n","import internalResolve from './helper/internalResolve';\r\n\r\nfunction wait(operationData, eventBus) {\r\n    const { milliseconds } = operationData;\r\n    return new Promise((resolve) => {\r\n        setTimeout(() => {\r\n            internalResolve(resolve, operationData);\r\n        }, milliseconds);\r\n    });\r\n}\r\n\r\nexport default wait;\r\n","export { default as JwPlayerTimelineProvider } from './jwplayer-timeline-provider';\r\n// export { default as MediaElementTimelineProvider} from './mediaelement-timeline-provider';\r\nexport { default as RequestAnimationFrameTimelineProvider } from './request-animation-frame-timeline-provider';\r\n","import $ from 'jquery';\r\nimport TimelineEventNames from '../timeline-event-names';\r\n\r\nclass JwPlayerTimelineProvider {\r\n\r\n   constructor(eventbus, config) {\r\n        this.eventbus = eventbus;\r\n        this.config = config;\r\n        this.providerid = config.playerSettings.selector;\r\n        this.loop = false;\r\n        this.player = null;\r\n        this.currentLoopHandler = null;\r\n        this._eventbusListeners = [];\r\n        this._addEventListeners();\r\n    }\r\n\r\n    _extractUrls(configuration) {\r\n        const urls = configuration.timelines.filter(timeline => timeline.type === \"video\").map(timeline => {\r\n            return timeline.uri;\r\n        });\r\n        return urls;\r\n    }\r\n\r\n    init(selector) {\r\n        const urls = this._extractUrls(this.config);\r\n        const jwp = window.jwplayer;\r\n        const p = $(`#${selector}`);\r\n        if (!p.length) {\r\n            throw new Error(`videoplayer selector '${selector}' not found`);\r\n        }\r\n        let w = p.innerWidth();\r\n        let h = p.innerHeight();\r\n        if (w === 0) {\r\n            w = 100;\r\n        }\r\n        if (h === 0) {\r\n            h = 300;\r\n        }\r\n\r\n        this.player = jwp(this.config.playerSettings.selector);\r\n        this.player.setup({\r\n            file: urls[0],\r\n            image: this.config.playerSettings.poster,\r\n            height: h,\r\n            width: w,\r\n            controls: true,\r\n            autostart: false,\r\n            displaytitle: false,\r\n            displaydescription: false,\r\n            nextUpDisplay: false,\r\n            abouttext: 'Rosetta Group',\r\n            aboutlink: 'http://www.rosettagroup.nl',\r\n            stretching: \"fill\",\r\n            repeat: false\r\n        });\r\n        const playlist = [];\r\n        urls.forEach((url) => {\r\n            playlist.push({\r\n                file: url,\r\n                title: url,\r\n                image: this.config.playerSettings.poster\r\n            });\r\n        });\r\n        const promise = new Promise((resolve, reject) => {\r\n            this.player.once(\"ready\", () => {\r\n                this._handlePlayerReady(resolve);\r\n            });\r\n            this.player.load(playlist);\r\n        });\r\n        return promise;\r\n    }\r\n\r\n    _handlePlayerReady(resolve) {\r\n        this.player.once(\"firstFrame\", () => {\r\n            this.player.pause();\r\n            this.eventbus.broadcastForTopic(TimelineEventNames.DURATION, this.player.playerid, [this.getDuration()]);\r\n            resolve(this);\r\n        });\r\n        this.player.on(TimelineEventNames.TIME, this._loopHandler.bind(this, Math.floor));\r\n        this.player.on(TimelineEventNames.SEEKED, this._seekedHandler.bind(this));\r\n        this.player.on(TimelineEventNames.COMPLETE, this._handlePlayerComplete.bind(this));\r\n        setTimeout(()=> {\r\n            this.player.play();\r\n        },10);\r\n    }\r\n\r\n    _handlePlayerComplete() {\r\n        if (!this.loop) {\r\n            this.stop();\r\n            this.eventbus.broadcastForTopic(TimelineEventNames.COMPLETE, this.providerid, [this.player.getPlaylistIndex()]);\r\n        }\r\n    }\r\n\r\n    _seekedHandler() {\r\n        this.eventbus.broadcastForTopic(TimelineEventNames.SEEKED, this.providerid, [this.getPosition(), this.getDuration()]);\r\n    }\r\n\r\n    destroy() {\r\n        this.player.remove();\r\n        this._eventbusListeners.forEach(func => func());\r\n    }\r\n\r\n    _loopHandler(floor, event) {\r\n        const pos = floor(event.position);\r\n        if ((this.loop) && (pos === floor(this.player.getDuration() - 1))) {\r\n            this.seek(0);\r\n        }\r\n    }\r\n\r\n    _timeResetLoopHandler(event) {\r\n        if (this.loop) {\r\n            this.seek(0);\r\n        }\r\n    }\r\n\r\n    _addEventListeners() {\r\n        this._eventbusListeners.push(this.eventbus.on(TimelineEventNames.PLAY_TOGGLE_REQUEST, this.toggleplay.bind(this), this.providerid));\r\n        this._eventbusListeners.push(this.eventbus.on(TimelineEventNames.PLAY_REQUEST, this.play.bind(this), this.providerid));\r\n        this._eventbusListeners.push(this.eventbus.on(TimelineEventNames.STOP_REQUEST, this.stop.bind(this), this.providerid));\r\n        this._eventbusListeners.push(this.eventbus.on(TimelineEventNames.PAUSE_REQUEST, this.pause.bind(this), this.providerid));\r\n        this._eventbusListeners.push(this.eventbus.on(TimelineEventNames.SEEK_REQUEST, this.seek.bind(this), this.providerid));\r\n        this._eventbusListeners.push(this.eventbus.on(TimelineEventNames.RESIZE_REQUEST, this.resize.bind(this), this.providerid));\r\n        this._eventbusListeners.push(this.eventbus.on(TimelineEventNames.CONTAINER_REQUEST, this._container.bind(this), this.providerid));\r\n        this._eventbusListeners.push(this.eventbus.on(TimelineEventNames.DURATION_REQUEST, this.duration.bind(this), this.providerid));\r\n    }\r\n\r\n    _container(resultCallback) {\r\n        let suffix = \"\";\r\n        if (this.player.getProvider().name !== \"html5\") {\r\n            suffix = \"_wrapper\";\r\n        }\r\n        const container = $(`#${this.providerid}${suffix}`);\r\n        resultCallback(container);\r\n    }\r\n\r\n    toggleplay() {\r\n        if (this.paused) {\r\n            this.play()\r\n        } else {\r\n            this.pause();\r\n        }\r\n    }\r\n\r\n    play() {\r\n        this.paused = false;\r\n        this.player.play();\r\n        this.eventbus.broadcastForTopic(TimelineEventNames.PLAY, this.providerid);\r\n    }\r\n\r\n    stop() {\r\n        this.paused = false;\r\n        this.player.stop();\r\n        this.eventbus.broadcastForTopic(TimelineEventNames.STOP, this.providerid);\r\n    }\r\n\r\n    pause() {\r\n        this.paused = true;\r\n        this.player.pause();\r\n        this.eventbus.broadcastForTopic(TimelineEventNames.PAUSE, this.providerid);\r\n    }\r\n\r\n    seek(position) {\r\n        const currentPosition = this.player.getPosition();\r\n        this.player.seek(position);\r\n        this.eventbus.broadcastForTopic(TimelineEventNames.SEEK, this.providerid, [position, currentPosition, this.player.getDuration()]);\r\n    }\r\n\r\n    resize(width, height) {\r\n        this.player.resize(width, height);\r\n        this.eventbus.broadcastForTopic(TimelineEventNames.RESIZE, this.providerid, [width, height]);\r\n    }\r\n\r\n    duration(resultCallback) {\r\n        resultCallback(Math.floor(this.getDuration()));\r\n    }\r\n\r\n    playlistItem(index) {\r\n        this.player.playlistItem(index);\r\n    }\r\n\r\n    once(eventName, callback) {\r\n        this.player.once(eventName, callback);\r\n    }\r\n\r\n    off(eventName, callback) {\r\n        this.player.off(eventName, callback);\r\n    }\r\n\r\n    on(eventName, callback) {\r\n        this.player.on(eventName, callback);\r\n    }\r\n\r\n    getPosition() {\r\n        return this.player.getPosition();\r\n    }\r\n\r\n    getPlaylistIndex() {\r\n        return this.player.getPlaylistIndex();\r\n    }\r\n\r\n    getState() {\r\n        return this.player.getState();\r\n    }\r\n\r\n    getDuration() {\r\n        return this.player.getDuration();\r\n    }\r\n\r\n    getMute() {\r\n        return this.player.getMute();\r\n    }\r\n\r\n    getVolume() {\r\n        return this.player.getVolume();\r\n    }\r\n\r\n    setMute(state) {\r\n        this.player.setMute(state);\r\n    }\r\n\r\n    setVolume(volume) {\r\n        this.player.setVolume(volume);\r\n    }\r\n}\r\n\r\nexport default JwPlayerTimelineProvider;\r\n","import $ from 'jquery';\r\nimport TimelineEventNames from '../timeline-event-names';\r\n\r\nclass RequestAnimationFrameTimelineProvider {\r\n\r\n    constructor(eventbus, config) {\r\n        this.eventbus = eventbus;\r\n        this.config = config;\r\n        this.requestID = null;\r\n        this.last = 0;\r\n        this.current = 0;\r\n        this._updateBound = this._update.bind(this);\r\n        this.loop = false;\r\n        this._eventbusListeners = [];\r\n        this.providerid = `provider${Math.random()*1000}`;\r\n        this._addEventListeners();\r\n        this.playlist = [];\r\n        this.currentPlaylistItem = null;\r\n        this.firstFrame = true;\r\n        this.paused = true;\r\n    }\r\n\r\n    _extractPlaylist(configuration) {\r\n        const playlist = configuration.timelines.filter(timeline => timeline.type === \"animation\").map(timeline => {\r\n            return timeline;\r\n        });\r\n        return playlist;\r\n    }\r\n\r\n    playlistItem(index) {\r\n        if (index < 0 || index > this.playlist.length) {\r\n            return;\r\n        }\r\n        this.currentPlaylistItem = this.playlist[index];\r\n        this.firstFrame = true;\r\n        this.reset();\r\n    }\r\n\r\n    _addEventListeners() {\r\n        this._eventbusListeners.push(this.eventbus.on(TimelineEventNames.PLAY_TOGGLE_REQUEST, this.toggleplay.bind(this), this.providerid));\r\n        this._eventbusListeners.push(this.eventbus.on(TimelineEventNames.PLAY_REQUEST, this.play.bind(this), this.providerid));\r\n        this._eventbusListeners.push(this.eventbus.on(TimelineEventNames.STOP_REQUEST, this.stop.bind(this), this.providerid));\r\n        this._eventbusListeners.push(this.eventbus.on(TimelineEventNames.PAUSE_REQUEST, this.pause.bind(this), this.providerid));\r\n        this._eventbusListeners.push(this.eventbus.on(TimelineEventNames.SEEK_REQUEST, this.seek.bind(this), this.providerid));\r\n        this._eventbusListeners.push(this.eventbus.on(TimelineEventNames.RESIZE_REQUEST, this._resize.bind(this), this.providerid));\r\n        this._eventbusListeners.push(this.eventbus.on(TimelineEventNames.CONTAINER_REQUEST, this._container.bind(this), this.providerid));\r\n        this._eventbusListeners.push(this.eventbus.on(TimelineEventNames.DURATION_REQUEST, this.requestDurationHandler.bind(this), this.providerid));\r\n    }\r\n\r\n    _update(now) {\r\n        if (!this.paused) {\r\n            return;\r\n        }\r\n        if(!this.last || now - this.last >= 1000) {\r\n            if (!this.last && this.firstFrame) {\r\n                this.firstFrame = false;\r\n                this.eventbus.broadcastForTopic(TimelineEventNames.FIRSTFRAME, this.providerid);\r\n            }\r\n            this.last = now;\r\n            this.current++;\r\n            if (this.current > this.currentPlaylistItem.duration) {\r\n                if (this.loop) {\r\n                    this._reset();\r\n                } else {\r\n                    this.stop();\r\n                    this.eventbus.broadcastForTopic(TimelineEventNames.COMPLETE, this.providerid);\r\n                    return;\r\n                }\r\n            }\r\n            this.eventbus.broadcastForTopic(TimelineEventNames.TIME, this.providerid, this.current);\r\n        }\r\n        this.requestID = requestAnimationFrame(this._updateBound);\r\n    }\r\n\r\n    _start() {\r\n        if (this.requestID) {\r\n            return;\r\n        }\r\n        this.requestID = requestAnimationFrame(this._updateBound)\r\n    }\r\n\r\n    _reset() {\r\n        this._cancelAnimationFrame();\r\n        this.last = 0;\r\n        this.current = 0;\r\n    }\r\n\r\n    _resize() {\r\n        console.error('Not implemented yet');\r\n    }\r\n\r\n    _container(callBack) {\r\n        callBack(this.container);\r\n    }\r\n\r\n    _cancelAnimationFrame() {\r\n        if (this.requestID) {\r\n            cancelAnimationFrame(this.requestID);\r\n            this.requestID =  null;\r\n        }\r\n    }\r\n\r\n    init() {\r\n        this.playlist = this._extractPlaylist(this.config);\r\n        this.currentPlaylistItem = this.playlist[0];\r\n        this.container = $(this.currentPlaylistItem.selector);\r\n        if (!this.container.length) {\r\n            throw new Error(`timeline selector '${selector}' not found`);\r\n        }\r\n        const promise = new Promise((resolve) => {\r\n            resolve();\r\n        });\r\n        return promise;\r\n\r\n    }\r\n\r\n    destroy() {\r\n        this.stop();\r\n        this._eventbusListeners.forEach(func => func());\r\n    }\r\n\r\n    toggleplay() {\r\n        if (this.paused) {\r\n            this.play();\r\n        } else {\r\n            this.pause();\r\n        }\r\n    }\r\n\r\n    play(){\r\n        this.paused = false;\r\n        this._start();\r\n        this.eventbus.broadcastForTopic(TimelineEventNames.PLAY, this.providerid);\r\n    }\r\n\r\n    stop() {\r\n        this.paused = false;\r\n        this._cancelAnimationFrame();\r\n        this.eventbus.broadcastForTopic(TimelineEventNames.STOP, this.providerid);\r\n    }\r\n\r\n    pause() {\r\n        this.paused = true;\r\n        this.eventbus.broadcastForTopic(TimelineEventNames.PAUSE, this.providerid);\r\n    }\r\n\r\n    seek(position) {\r\n        if (position < 0 || position > this.currentPlaylistItem.duration) {\r\n            return;\r\n        }\r\n        this.eventbus.broadcastForTopic(TimelineEventNames.SEEK, this.providerid);\r\n        this.current = position;\r\n        this.eventbus.broadcastForTopic(TimelineEventNames.SEEKED, this.providerid);\r\n    }\r\n\r\n    requestDurationHandler(callBack) {\r\n        callBack(this.currentPlaylistItem.duration);\r\n    }\r\n\r\n    on(eventName, handler) {\r\n        return this.eventbus.on(eventName, handler, this.providerid);\r\n    }\r\n\r\n    once(eventName, handler) {\r\n        return this.eventbus.once(eventName, handler, this.providerid);\r\n    }\r\n}\r\n\r\nexport default RequestAnimationFrameTimelineProvider;\r\n"],"sourceRoot":""}